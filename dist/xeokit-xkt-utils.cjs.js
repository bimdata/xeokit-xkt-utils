"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const FloatArrayType=Float64Array,tempMat1=new FloatArrayType(16),tempMat2=new FloatArrayType(16),tempVec4=new FloatArrayType(4),math={MIN_DOUBLE:-Number.MAX_SAFE_INTEGER,MAX_DOUBLE:Number.MAX_SAFE_INTEGER,DEGTORAD:.0174532925,RADTODEG:57.295779513,vec2:e=>new FloatArrayType(e||2),vec3:e=>new FloatArrayType(e||3),vec4:e=>new FloatArrayType(e||4),mat3:e=>new FloatArrayType(e||9),mat3ToMat4:(e,t=new FloatArrayType(16))=>(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=0,t[4]=e[3],t[5]=e[4],t[6]=e[5],t[7]=0,t[8]=e[6],t[9]=e[7],t[10]=e[8],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t),mat4:e=>new FloatArrayType(e||16),mat4ToMat3(e,t){},createUUID:(()=>{const e=[];for(let t=0;t<256;t++)e[t]=(t<16?"0":"")+t.toString(16);return()=>{const t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return`${e[255&t]+e[t>>8&255]+e[t>>16&255]+e[t>>24&255]}-${e[255&n]}${e[n>>8&255]}-${e[n>>16&15|64]}${e[n>>24&255]}-${e[63&r|128]}${e[r>>8&255]}-${e[r>>16&255]}${e[r>>24&255]}${e[255&i]}${e[i>>8&255]}${e[i>>16&255]}${e[i>>24&255]}`}})(),clamp:(e,t,n)=>Math.max(t,Math.min(n,e)),fmod(e,t){if(e<t)return console.error("math.fmod : Attempting to find modulus within negative range - would be infinite loop - ignoring"),e;for(;t<=e;)e-=t;return e},negateVec4:(e,t)=>(t||(t=e),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t),addVec4:(e,t,n)=>(n||(n=e),n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n),addVec4Scalar:(e,t,n)=>(n||(n=e),n[0]=e[0]+t,n[1]=e[1]+t,n[2]=e[2]+t,n[3]=e[3]+t,n),addVec3:(e,t,n)=>(n||(n=e),n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n),addVec3Scalar:(e,t,n)=>(n||(n=e),n[0]=e[0]+t,n[1]=e[1]+t,n[2]=e[2]+t,n),subVec4:(e,t,n)=>(n||(n=e),n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n),subVec3:(e,t,n)=>(n||(n=e),n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n),subVec2:(e,t,n)=>(n||(n=e),n[0]=e[0]-t[0],n[1]=e[1]-t[1],n),subVec4Scalar:(e,t,n)=>(n||(n=e),n[0]=e[0]-t,n[1]=e[1]-t,n[2]=e[2]-t,n[3]=e[3]-t,n),subScalarVec4:(e,t,n)=>(n||(n=e),n[0]=t-e[0],n[1]=t-e[1],n[2]=t-e[2],n[3]=t-e[3],n),mulVec4:(e,t,n)=>(n||(n=e),n[0]=e[0]*t[0],n[1]=e[1]*t[1],n[2]=e[2]*t[2],n[3]=e[3]*t[3],n),mulVec4Scalar:(e,t,n)=>(n||(n=e),n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n),mulVec3Scalar:(e,t,n)=>(n||(n=e),n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n),mulVec2Scalar:(e,t,n)=>(n||(n=e),n[0]=e[0]*t,n[1]=e[1]*t,n),divVec3:(e,t,n)=>(n||(n=e),n[0]=e[0]/t[0],n[1]=e[1]/t[1],n[2]=e[2]/t[2],n),divVec4:(e,t,n)=>(n||(n=e),n[0]=e[0]/t[0],n[1]=e[1]/t[1],n[2]=e[2]/t[2],n[3]=e[3]/t[3],n),divScalarVec3:(e,t,n)=>(n||(n=t),n[0]=e/t[0],n[1]=e/t[1],n[2]=e/t[2],n),divVec3Scalar:(e,t,n)=>(n||(n=e),n[0]=e[0]/t,n[1]=e[1]/t,n[2]=e[2]/t,n),divVec4Scalar:(e,t,n)=>(n||(n=e),n[0]=e[0]/t,n[1]=e[1]/t,n[2]=e[2]/t,n[3]=e[3]/t,n),divScalarVec4:(e,t,n)=>(n||(n=t),n[0]=e/t[0],n[1]=e/t[1],n[2]=e/t[2],n[3]=e/t[3],n),dotVec4:(e,t)=>e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3],cross3Vec4(e,t){const n=e[0],r=e[1],i=e[2],a=t[0],o=t[1],s=t[2];return[r*s-i*o,i*a-n*s,n*o-r*a,0]},cross3Vec3(e,t,n){n||(n=e);const r=e[0],i=e[1],a=e[2],o=t[0],s=t[1],l=t[2];return n[0]=i*l-a*s,n[1]=a*o-r*l,n[2]=r*s-i*o,n},sqLenVec4:e=>math.dotVec4(e,e),lenVec4:e=>Math.sqrt(math.sqLenVec4(e)),dotVec3:(e,t)=>e[0]*t[0]+e[1]*t[1]+e[2]*t[2],dotVec2:(e,t)=>e[0]*t[0]+e[1]*t[1],sqLenVec3:e=>math.dotVec3(e,e),sqLenVec2:e=>math.dotVec2(e,e),lenVec3:e=>Math.sqrt(math.sqLenVec3(e)),distVec3:(()=>{const e=new FloatArrayType(3);return(t,n)=>math.lenVec3(math.subVec3(t,n,e))})(),lenVec2:e=>Math.sqrt(math.sqLenVec2(e)),distVec2:(()=>{const e=new FloatArrayType(2);return(t,n)=>math.lenVec2(math.subVec2(t,n,e))})(),rcpVec3:(e,t)=>math.divScalarVec3(1,e,t),normalizeVec4(e,t){const n=1/math.lenVec4(e);return math.mulVec4Scalar(e,n,t)},normalizeVec3(e,t){const n=1/math.lenVec3(e);return math.mulVec3Scalar(e,n,t)},normalizeVec2(e,t){const n=1/math.lenVec2(e);return math.mulVec2Scalar(e,n,t)},angleVec3(e,t){let n=math.dotVec3(e,t)/Math.sqrt(math.sqLenVec3(e)*math.sqLenVec3(t));return n=n<-1?-1:n>1?1:n,Math.acos(n)},vec3FromMat4Scale:(()=>{const e=new FloatArrayType(3);return(t,n)=>(e[0]=t[0],e[1]=t[1],e[2]=t[2],n[0]=math.lenVec3(e),e[0]=t[4],e[1]=t[5],e[2]=t[6],n[1]=math.lenVec3(e),e[0]=t[8],e[1]=t[9],e[2]=t[10],n[2]=math.lenVec3(e),n)})(),vecToArray:(()=>{function e(e){return Math.round(1e5*e)/1e5}return t=>{for(let n=0,r=(t=Array.prototype.slice.call(t)).length;n<r;n++)t[n]=e(t[n]);return t}})(),xyzArrayToObject:e=>({x:e[0],y:e[1],z:e[2]}),xyzObjectToArray:(e,t)=>((t=t||new FloatArrayType(3))[0]=e.x,t[1]=e.y,t[2]=e.z,t),dupMat4:e=>e.slice(0,16),mat4To3:e=>[e[0],e[1],e[2],e[4],e[5],e[6],e[8],e[9],e[10]],m4s:e=>[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],setMat4ToZeroes:()=>math.m4s(0),setMat4ToOnes:()=>math.m4s(1),diagonalMat4v:e=>new FloatArrayType([e[0],0,0,0,0,e[1],0,0,0,0,e[2],0,0,0,0,e[3]]),diagonalMat4c:(e,t,n,r)=>math.diagonalMat4v([e,t,n,r]),diagonalMat4s:e=>math.diagonalMat4c(e,e,e,e),identityMat4:(e=new FloatArrayType(16))=>(e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e),identityMat3:(e=new FloatArrayType(9))=>(e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e),isIdentityMat4:e=>1===e[0]&&0===e[1]&&0===e[2]&&0===e[3]&&0===e[4]&&1===e[5]&&0===e[6]&&0===e[7]&&0===e[8]&&0===e[9]&&1===e[10]&&0===e[11]&&0===e[12]&&0===e[13]&&0===e[14]&&1===e[15],negateMat4:(e,t)=>(t||(t=e),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=-e[7],t[8]=-e[8],t[9]=-e[9],t[10]=-e[10],t[11]=-e[11],t[12]=-e[12],t[13]=-e[13],t[14]=-e[14],t[15]=-e[15],t),addMat4:(e,t,n)=>(n||(n=e),n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n[4]=e[4]+t[4],n[5]=e[5]+t[5],n[6]=e[6]+t[6],n[7]=e[7]+t[7],n[8]=e[8]+t[8],n[9]=e[9]+t[9],n[10]=e[10]+t[10],n[11]=e[11]+t[11],n[12]=e[12]+t[12],n[13]=e[13]+t[13],n[14]=e[14]+t[14],n[15]=e[15]+t[15],n),addMat4Scalar:(e,t,n)=>(n||(n=e),n[0]=e[0]+t,n[1]=e[1]+t,n[2]=e[2]+t,n[3]=e[3]+t,n[4]=e[4]+t,n[5]=e[5]+t,n[6]=e[6]+t,n[7]=e[7]+t,n[8]=e[8]+t,n[9]=e[9]+t,n[10]=e[10]+t,n[11]=e[11]+t,n[12]=e[12]+t,n[13]=e[13]+t,n[14]=e[14]+t,n[15]=e[15]+t,n),addScalarMat4:(e,t,n)=>math.addMat4Scalar(t,e,n),subMat4:(e,t,n)=>(n||(n=e),n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n[4]=e[4]-t[4],n[5]=e[5]-t[5],n[6]=e[6]-t[6],n[7]=e[7]-t[7],n[8]=e[8]-t[8],n[9]=e[9]-t[9],n[10]=e[10]-t[10],n[11]=e[11]-t[11],n[12]=e[12]-t[12],n[13]=e[13]-t[13],n[14]=e[14]-t[14],n[15]=e[15]-t[15],n),subMat4Scalar:(e,t,n)=>(n||(n=e),n[0]=e[0]-t,n[1]=e[1]-t,n[2]=e[2]-t,n[3]=e[3]-t,n[4]=e[4]-t,n[5]=e[5]-t,n[6]=e[6]-t,n[7]=e[7]-t,n[8]=e[8]-t,n[9]=e[9]-t,n[10]=e[10]-t,n[11]=e[11]-t,n[12]=e[12]-t,n[13]=e[13]-t,n[14]=e[14]-t,n[15]=e[15]-t,n),subScalarMat4:(e,t,n)=>(n||(n=t),n[0]=e-t[0],n[1]=e-t[1],n[2]=e-t[2],n[3]=e-t[3],n[4]=e-t[4],n[5]=e-t[5],n[6]=e-t[6],n[7]=e-t[7],n[8]=e-t[8],n[9]=e-t[9],n[10]=e-t[10],n[11]=e-t[11],n[12]=e-t[12],n[13]=e-t[13],n[14]=e-t[14],n[15]=e-t[15],n),mulMat4(e,t,n){n||(n=e);const r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],l=e[5],h=e[6],c=e[7],d=e[8],u=e[9],f=e[10],m=e[11],p=e[12],_=e[13],g=e[14],y=e[15],w=t[0],b=t[1],v=t[2],M=t[3],A=t[4],k=t[5],x=t[6],T=t[7],B=t[8],E=t[9],z=t[10],I=t[11],P=t[12],S=t[13],V=t[14],G=t[15];return n[0]=w*r+b*s+v*d+M*p,n[1]=w*i+b*l+v*u+M*_,n[2]=w*a+b*h+v*f+M*g,n[3]=w*o+b*c+v*m+M*y,n[4]=A*r+k*s+x*d+T*p,n[5]=A*i+k*l+x*u+T*_,n[6]=A*a+k*h+x*f+T*g,n[7]=A*o+k*c+x*m+T*y,n[8]=B*r+E*s+z*d+I*p,n[9]=B*i+E*l+z*u+I*_,n[10]=B*a+E*h+z*f+I*g,n[11]=B*o+E*c+z*m+I*y,n[12]=P*r+S*s+V*d+G*p,n[13]=P*i+S*l+V*u+G*_,n[14]=P*a+S*h+V*f+G*g,n[15]=P*o+S*c+V*m+G*y,n},mulMat3(e,t,n){n||(n=new FloatArrayType(9));const r=e[0],i=e[3],a=e[6],o=e[1],s=e[4],l=e[7],h=e[2],c=e[5],d=e[8],u=t[0],f=t[3],m=t[6],p=t[1],_=t[4],g=t[7],y=t[2],w=t[5],b=t[8];return n[0]=r*u+i*p+a*y,n[3]=r*f+i*_+a*w,n[6]=r*m+i*g+a*b,n[1]=o*u+s*p+l*y,n[4]=o*f+s*_+l*w,n[7]=o*m+s*g+l*b,n[2]=h*u+c*p+d*y,n[5]=h*f+c*_+d*w,n[8]=h*m+c*g+d*b,n},mulMat4Scalar:(e,t,n)=>(n||(n=e),n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n[4]=e[4]*t,n[5]=e[5]*t,n[6]=e[6]*t,n[7]=e[7]*t,n[8]=e[8]*t,n[9]=e[9]*t,n[10]=e[10]*t,n[11]=e[11]*t,n[12]=e[12]*t,n[13]=e[13]*t,n[14]=e[14]*t,n[15]=e[15]*t,n),mulMat4v4(e,t,n=math.vec4()){const r=t[0],i=t[1],a=t[2],o=t[3];return n[0]=e[0]*r+e[4]*i+e[8]*a+e[12]*o,n[1]=e[1]*r+e[5]*i+e[9]*a+e[13]*o,n[2]=e[2]*r+e[6]*i+e[10]*a+e[14]*o,n[3]=e[3]*r+e[7]*i+e[11]*a+e[15]*o,n},transposeMat4(e,t){const n=e[4],r=e[14],i=e[8],a=e[13],o=e[12],s=e[9];if(!t||e===t){const t=e[1],l=e[2],h=e[3],c=e[6],d=e[7],u=e[11];return e[1]=n,e[2]=i,e[3]=o,e[4]=t,e[6]=s,e[7]=a,e[8]=l,e[9]=c,e[11]=r,e[12]=h,e[13]=d,e[14]=u,e}return t[0]=e[0],t[1]=n,t[2]=i,t[3]=o,t[4]=e[1],t[5]=e[5],t[6]=s,t[7]=a,t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=r,t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15],t},transposeMat3(e,t){if(t===e){const n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},determinantMat4(e){const t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],l=e[7],h=e[8],c=e[9],d=e[10],u=e[11],f=e[12],m=e[13],p=e[14],_=e[15];return f*c*s*i-h*m*s*i-f*o*d*i+a*m*d*i+h*o*p*i-a*c*p*i-f*c*r*l+h*m*r*l+f*n*d*l-t*m*d*l-h*n*p*l+t*c*p*l+f*o*r*u-a*m*r*u-f*n*s*u+t*m*s*u+a*n*p*u-t*o*p*u-h*o*r*_+a*c*r*_+h*n*s*_-t*c*s*_-a*n*d*_+t*o*d*_},inverseMat4(e,t){t||(t=e);const n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],h=e[7],c=e[8],d=e[9],u=e[10],f=e[11],m=e[12],p=e[13],_=e[14],g=e[15],y=n*s-r*o,w=n*l-i*o,b=n*h-a*o,v=r*l-i*s,M=r*h-a*s,A=i*h-a*l,k=c*p-d*m,x=c*_-u*m,T=c*g-f*m,B=d*_-u*p,E=d*g-f*p,z=u*g-f*_,I=1/(y*z-w*E+b*B+v*T-M*x+A*k);return t[0]=(s*z-l*E+h*B)*I,t[1]=(-r*z+i*E-a*B)*I,t[2]=(p*A-_*M+g*v)*I,t[3]=(-d*A+u*M-f*v)*I,t[4]=(-o*z+l*T-h*x)*I,t[5]=(n*z-i*T+a*x)*I,t[6]=(-m*A+_*b-g*w)*I,t[7]=(c*A-u*b+f*w)*I,t[8]=(o*E-s*T+h*k)*I,t[9]=(-n*E+r*T-a*k)*I,t[10]=(m*M-p*b+g*y)*I,t[11]=(-c*M+d*b-f*y)*I,t[12]=(-o*B+s*x-l*k)*I,t[13]=(n*B-r*x+i*k)*I,t[14]=(-m*v+p*w-_*y)*I,t[15]=(c*v-d*w+u*y)*I,t},traceMat4:e=>e[0]+e[5]+e[10]+e[15],translationMat4v(e,t){const n=t||math.identityMat4();return n[12]=e[0],n[13]=e[1],n[14]=e[2],n},translationMat3v(e,t){const n=t||math.identityMat3();return n[6]=e[0],n[7]=e[1],n},translationMat4c:(()=>{const e=new FloatArrayType(3);return(t,n,r,i)=>(e[0]=t,e[1]=n,e[2]=r,math.translationMat4v(e,i))})(),translationMat4s:(e,t)=>math.translationMat4c(e,e,e,t),translateMat4v:(e,t)=>math.translateMat4c(e[0],e[1],e[2],t),OLDtranslateMat4c(e,t,n,r){const i=r[12];r[0]+=i*e,r[4]+=i*t,r[8]+=i*n;const a=r[13];r[1]+=a*e,r[5]+=a*t,r[9]+=a*n;const o=r[14];r[2]+=o*e,r[6]+=o*t,r[10]+=o*n;const s=r[15];return r[3]+=s*e,r[7]+=s*t,r[11]+=s*n,r},translateMat4c(e,t,n,r){const i=r[3];r[0]+=i*e,r[1]+=i*t,r[2]+=i*n;const a=r[7];r[4]+=a*e,r[5]+=a*t,r[6]+=a*n;const o=r[11];r[8]+=o*e,r[9]+=o*t,r[10]+=o*n;const s=r[15];return r[12]+=s*e,r[13]+=s*t,r[14]+=s*n,r},rotationMat4v(e,t,n){const r=math.normalizeVec4([t[0],t[1],t[2],0],[]),i=Math.sin(e),a=Math.cos(e),o=1-a,s=r[0],l=r[1],h=r[2];let c,d,u,f,m,p;return c=s*l,d=l*h,u=h*s,f=s*i,m=l*i,p=h*i,(n=n||math.mat4())[0]=o*s*s+a,n[1]=o*c+p,n[2]=o*u-m,n[3]=0,n[4]=o*c-p,n[5]=o*l*l+a,n[6]=o*d+f,n[7]=0,n[8]=o*u+m,n[9]=o*d-f,n[10]=o*h*h+a,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},rotationMat4c:(e,t,n,r,i)=>math.rotationMat4v(e,[t,n,r],i),scalingMat4v:(e,t=math.identityMat4())=>(t[0]=e[0],t[5]=e[1],t[10]=e[2],t),scalingMat3v:(e,t=math.identityMat3())=>(t[0]=e[0],t[4]=e[1],t),scalingMat4c:(()=>{const e=new FloatArrayType(3);return(t,n,r,i)=>(e[0]=t,e[1]=n,e[2]=r,math.scalingMat4v(e,i))})(),scaleMat4c:(e,t,n,r)=>(r[0]*=e,r[4]*=t,r[8]*=n,r[1]*=e,r[5]*=t,r[9]*=n,r[2]*=e,r[6]*=t,r[10]*=n,r[3]*=e,r[7]*=t,r[11]*=n,r),scaleMat4v(e,t){const n=e[0],r=e[1],i=e[2];return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,t},scalingMat4s:e=>math.scalingMat4c(e,e,e),rotationTranslationMat4(e,t,n=math.mat4()){const r=e[0],i=e[1],a=e[2],o=e[3],s=r+r,l=i+i,h=a+a,c=r*s,d=r*l,u=r*h,f=i*l,m=i*h,p=a*h,_=o*s,g=o*l,y=o*h;return n[0]=1-(f+p),n[1]=d+y,n[2]=u-g,n[3]=0,n[4]=d-y,n[5]=1-(c+p),n[6]=m+_,n[7]=0,n[8]=u+g,n[9]=m-_,n[10]=1-(c+f),n[11]=0,n[12]=t[0],n[13]=t[1],n[14]=t[2],n[15]=1,n},mat4ToEuler(e,t,n=math.vec4()){const r=math.clamp,i=e[0],a=e[4],o=e[8],s=e[1],l=e[5],h=e[9],c=e[2],d=e[6],u=e[10];return"XYZ"===t?(n[1]=Math.asin(r(o,-1,1)),Math.abs(o)<.99999?(n[0]=Math.atan2(-h,u),n[2]=Math.atan2(-a,i)):(n[0]=Math.atan2(d,l),n[2]=0)):"YXZ"===t?(n[0]=Math.asin(-r(h,-1,1)),Math.abs(h)<.99999?(n[1]=Math.atan2(o,u),n[2]=Math.atan2(s,l)):(n[1]=Math.atan2(-c,i),n[2]=0)):"ZXY"===t?(n[0]=Math.asin(r(d,-1,1)),Math.abs(d)<.99999?(n[1]=Math.atan2(-c,u),n[2]=Math.atan2(-a,l)):(n[1]=0,n[2]=Math.atan2(s,i))):"ZYX"===t?(n[1]=Math.asin(-r(c,-1,1)),Math.abs(c)<.99999?(n[0]=Math.atan2(d,u),n[2]=Math.atan2(s,i)):(n[0]=0,n[2]=Math.atan2(-a,l))):"YZX"===t?(n[2]=Math.asin(r(s,-1,1)),Math.abs(s)<.99999?(n[0]=Math.atan2(-h,l),n[1]=Math.atan2(-c,i)):(n[0]=0,n[1]=Math.atan2(o,u))):"XZY"===t&&(n[2]=Math.asin(-r(a,-1,1)),Math.abs(a)<.99999?(n[0]=Math.atan2(d,l),n[1]=Math.atan2(o,i)):(n[0]=Math.atan2(-h,u),n[1]=0)),n},composeMat4:(e,t,n,r=math.mat4())=>(math.quaternionToRotationMat4(t,r),math.scaleMat4v(n,r),math.translateMat4v(e,r),r),decomposeMat4:(()=>{const e=new FloatArrayType(3),t=new FloatArrayType(16);return function(n,r,i,a){e[0]=n[0],e[1]=n[1],e[2]=n[2];let o=math.lenVec3(e);e[0]=n[4],e[1]=n[5],e[2]=n[6];const s=math.lenVec3(e);e[8]=n[8],e[9]=n[9],e[10]=n[10];const l=math.lenVec3(e);math.determinantMat4(n)<0&&(o=-o),r[0]=n[12],r[1]=n[13],r[2]=n[14],t.set(n);const h=1/o,c=1/s,d=1/l;return t[0]*=h,t[1]*=h,t[2]*=h,t[4]*=c,t[5]*=c,t[6]*=c,t[8]*=d,t[9]*=d,t[10]*=d,math.mat4ToQuaternion(t,i),a[0]=o,a[1]=s,a[2]=l,this}})(),lookAtMat4v(e,t,n,r){r||(r=math.mat4());const i=e[0],a=e[1],o=e[2],s=n[0],l=n[1],h=n[2],c=t[0],d=t[1],u=t[2];if(i===c&&a===d&&o===u)return math.identityMat4();let f,m,p,_,g,y,w,b,v,M;return f=i-c,m=a-d,p=o-u,_=l*(p*=M=1/Math.sqrt(f*f+m*m+p*p))-h*(m*=M),g=h*(f*=M)-s*p,y=s*m-l*f,(M=Math.sqrt(_*_+g*g+y*y))?(_*=M=1/M,g*=M,y*=M):(_=0,g=0,y=0),w=m*y-p*g,b=p*_-f*y,v=f*g-m*_,(M=Math.sqrt(w*w+b*b+v*v))?(w*=M=1/M,b*=M,v*=M):(w=0,b=0,v=0),r[0]=_,r[1]=w,r[2]=f,r[3]=0,r[4]=g,r[5]=b,r[6]=m,r[7]=0,r[8]=y,r[9]=v,r[10]=p,r[11]=0,r[12]=-(_*i+g*a+y*o),r[13]=-(w*i+b*a+v*o),r[14]=-(f*i+m*a+p*o),r[15]=1,r},lookAtMat4c:(e,t,n,r,i,a,o,s,l)=>math.lookAtMat4v([e,t,n],[r,i,a],[o,s,l],[]),orthoMat4c(e,t,n,r,i,a,o){o||(o=math.mat4());const s=t-e,l=r-n,h=a-i;return o[0]=2/s,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2/l,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=-2/h,o[11]=0,o[12]=-(e+t)/s,o[13]=-(r+n)/l,o[14]=-(a+i)/h,o[15]=1,o},frustumMat4v(e,t,n){n||(n=math.mat4());const r=[e[0],e[1],e[2],0],i=[t[0],t[1],t[2],0];math.addVec4(i,r,tempMat1),math.subVec4(i,r,tempMat2);const a=2*r[2],o=tempMat2[0],s=tempMat2[1],l=tempMat2[2];return n[0]=a/o,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=a/s,n[6]=0,n[7]=0,n[8]=tempMat1[0]/o,n[9]=tempMat1[1]/s,n[10]=-tempMat1[2]/l,n[11]=-1,n[12]=0,n[13]=0,n[14]=-a*i[2]/l,n[15]=0,n},frustumMat4(e,t,n,r,i,a,o){o||(o=math.mat4());const s=t-e,l=r-n,h=a-i;return o[0]=2*i/s,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2*i/l,o[6]=0,o[7]=0,o[8]=(t+e)/s,o[9]=(r+n)/l,o[10]=-(a+i)/h,o[11]=-1,o[12]=0,o[13]=0,o[14]=-a*i*2/h,o[15]=0,o},perspectiveMat4(e,t,n,r,i){const a=[],o=[];return a[2]=n,o[2]=r,o[1]=a[2]*Math.tan(e/2),a[1]=-o[1],o[0]=o[1]*t,a[0]=-o[0],math.frustumMat4v(a,o,i)},transformPoint3(e,t,n=math.vec3()){const r=t[0],i=t[1],a=t[2];return n[0]=e[0]*r+e[4]*i+e[8]*a+e[12],n[1]=e[1]*r+e[5]*i+e[9]*a+e[13],n[2]=e[2]*r+e[6]*i+e[10]*a+e[14],n},transformPoint4:(e,t,n=math.vec4())=>(n[0]=e[0]*t[0]+e[4]*t[1]+e[8]*t[2]+e[12]*t[3],n[1]=e[1]*t[0]+e[5]*t[1]+e[9]*t[2]+e[13]*t[3],n[2]=e[2]*t[0]+e[6]*t[1]+e[10]*t[2]+e[14]*t[3],n[3]=e[3]*t[0]+e[7]*t[1]+e[11]*t[2]+e[15]*t[3],n),transformPoints3(e,t,n){const r=n||[],i=t.length;let a,o,s,l;const h=e[0],c=e[1],d=e[2],u=e[3],f=e[4],m=e[5],p=e[6],_=e[7],g=e[8],y=e[9],w=e[10],b=e[11],v=e[12],M=e[13],A=e[14],k=e[15];let x;for(let e=0;e<i;++e)a=(l=t[e])[0],o=l[1],s=l[2],(x=r[e]||(r[e]=[0,0,0]))[0]=h*a+f*o+g*s+v,x[1]=c*a+m*o+y*s+M,x[2]=d*a+p*o+w*s+A,x[3]=u*a+_*o+b*s+k;return r.length=i,r},transformPositions3(e,t,n=t){let r;const i=t.length;let a,o,s;const l=e[0],h=e[1],c=e[2],d=e[3],u=e[4],f=e[5],m=e[6],p=e[7],_=e[8],g=e[9],y=e[10],w=e[11],b=e[12],v=e[13],M=e[14],A=e[15];for(r=0;r<i;r+=3)a=t[r+0],o=t[r+1],s=t[r+2],n[r+0]=l*a+u*o+_*s+b,n[r+1]=h*a+f*o+g*s+v,n[r+2]=c*a+m*o+y*s+M,n[r+3]=d*a+p*o+w*s+A;return n},transformPositions4(e,t,n=t){let r;const i=t.length;let a,o,s;const l=e[0],h=e[1],c=e[2],d=e[3],u=e[4],f=e[5],m=e[6],p=e[7],_=e[8],g=e[9],y=e[10],w=e[11],b=e[12],v=e[13],M=e[14],A=e[15];for(r=0;r<i;r+=4)a=t[r+0],o=t[r+1],s=t[r+2],n[r+0]=l*a+u*o+_*s+b,n[r+1]=h*a+f*o+g*s+v,n[r+2]=c*a+m*o+y*s+M,n[r+3]=d*a+p*o+w*s+A;return n},transformVec3(e,t,n){const r=t[0],i=t[1],a=t[2];return(n=n||this.vec3())[0]=e[0]*r+e[4]*i+e[8]*a,n[1]=e[1]*r+e[5]*i+e[9]*a,n[2]=e[2]*r+e[6]*i+e[10]*a,n},transformVec4(e,t,n){const r=t[0],i=t[1],a=t[2],o=t[3];return(n=n||math.vec4())[0]=e[0]*r+e[4]*i+e[8]*a+e[12]*o,n[1]=e[1]*r+e[5]*i+e[9]*a+e[13]*o,n[2]=e[2]*r+e[6]*i+e[10]*a+e[14]*o,n[3]=e[3]*r+e[7]*i+e[11]*a+e[15]*o,n},rotateVec3X(e,t,n,r){const i=[],a=[];return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],a[0]=i[0],a[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),a[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),r[0]=a[0]+t[0],r[1]=a[1]+t[1],r[2]=a[2]+t[2],r},rotateVec3Y(e,t,n,r){const i=[],a=[];return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],a[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),a[1]=i[1],a[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),r[0]=a[0]+t[0],r[1]=a[1]+t[1],r[2]=a[2]+t[2],r},rotateVec3Z(e,t,n,r){const i=[],a=[];return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],a[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),a[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),a[2]=i[2],r[0]=a[0]+t[0],r[1]=a[1]+t[1],r[2]=a[2]+t[2],r},projectVec4(e,t){const n=1/e[3];return(t=t||math.vec2())[0]=v[0]*n,t[1]=v[1]*n,t},unprojectVec3:(()=>{const e=new FloatArrayType(16),t=new FloatArrayType(16),n=new FloatArrayType(16);return function(r,i,a,o){return this.transformVec3(this.mulMat4(this.inverseMat4(i,e),this.inverseMat4(a,t),n),r,o)}})(),lerpVec3(e,t,n,r,i,a){const o=a||math.vec3(),s=(e-t)/(n-t);return o[0]=r[0]+s*(i[0]-r[0]),o[1]=r[1]+s*(i[1]-r[1]),o[2]=r[2]+s*(i[2]-r[2]),o},flatten(e){const t=[];let n,r,i,a,o;for(n=0,r=e.length;n<r;n++)for(i=0,a=(o=e[n]).length;i<a;i++)t.push(o[i]);return t},identityQuaternion:(e=math.vec4())=>(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e),eulerToQuaternion(e,t,n=math.vec4()){const r=e[0]*math.DEGTORAD/2,i=e[1]*math.DEGTORAD/2,a=e[2]*math.DEGTORAD/2,o=Math.cos(r),s=Math.cos(i),l=Math.cos(a),h=Math.sin(r),c=Math.sin(i),d=Math.sin(a);return"XYZ"===t?(n[0]=h*s*l+o*c*d,n[1]=o*c*l-h*s*d,n[2]=o*s*d+h*c*l,n[3]=o*s*l-h*c*d):"YXZ"===t?(n[0]=h*s*l+o*c*d,n[1]=o*c*l-h*s*d,n[2]=o*s*d-h*c*l,n[3]=o*s*l+h*c*d):"ZXY"===t?(n[0]=h*s*l-o*c*d,n[1]=o*c*l+h*s*d,n[2]=o*s*d+h*c*l,n[3]=o*s*l-h*c*d):"ZYX"===t?(n[0]=h*s*l-o*c*d,n[1]=o*c*l+h*s*d,n[2]=o*s*d-h*c*l,n[3]=o*s*l+h*c*d):"YZX"===t?(n[0]=h*s*l+o*c*d,n[1]=o*c*l+h*s*d,n[2]=o*s*d-h*c*l,n[3]=o*s*l-h*c*d):"XZY"===t&&(n[0]=h*s*l-o*c*d,n[1]=o*c*l-h*s*d,n[2]=o*s*d+h*c*l,n[3]=o*s*l+h*c*d),n},mat4ToQuaternion(e,t=math.vec4()){const n=e[0],r=e[4],i=e[8],a=e[1],o=e[5],s=e[9],l=e[2],h=e[6],c=e[10];let d;const u=n+o+c;return u>0?(d=.5/Math.sqrt(u+1),t[3]=.25/d,t[0]=(h-s)*d,t[1]=(i-l)*d,t[2]=(a-r)*d):n>o&&n>c?(d=2*Math.sqrt(1+n-o-c),t[3]=(h-s)/d,t[0]=.25*d,t[1]=(r+a)/d,t[2]=(i+l)/d):o>c?(d=2*Math.sqrt(1+o-n-c),t[3]=(i-l)/d,t[0]=(r+a)/d,t[1]=.25*d,t[2]=(s+h)/d):(d=2*Math.sqrt(1+c-n-o),t[3]=(a-r)/d,t[0]=(i+l)/d,t[1]=(s+h)/d,t[2]=.25*d),t},vec3PairToQuaternion(e,t,n=math.vec4()){const r=Math.sqrt(math.dotVec3(e,e)*math.dotVec3(t,t));let i=r+math.dotVec3(e,t);return i<1e-8*r?(i=0,Math.abs(e[0])>Math.abs(e[2])?(n[0]=-e[1],n[1]=e[0],n[2]=0):(n[0]=0,n[1]=-e[2],n[2]=e[1])):math.cross3Vec3(e,t,n),n[3]=i,math.normalizeQuaternion(n)},angleAxisToQuaternion(e,t=math.vec4()){const n=e[3]/2,r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t},quaternionToEuler:(()=>{const e=new FloatArrayType(16);return(t,n,r)=>(r=r||math.vec3(),math.quaternionToRotationMat4(t,e),math.mat4ToEuler(e,n,r),r)})(),mulQuaternions(e,t,n=math.vec4()){const r=e[0],i=e[1],a=e[2],o=e[3],s=t[0],l=t[1],h=t[2],c=t[3];return n[0]=o*s+r*c+i*h-a*l,n[1]=o*l+i*c+a*s-r*h,n[2]=o*h+a*c+r*l-i*s,n[3]=o*c-r*s-i*l-a*h,n},vec3ApplyQuaternion(e,t,n=math.vec3()){const r=t[0],i=t[1],a=t[2],o=e[0],s=e[1],l=e[2],h=e[3],c=h*r+s*a-l*i,d=h*i+l*r-o*a,u=h*a+o*i-s*r,f=-o*r-s*i-l*a;return n[0]=c*h+f*-o+d*-l-u*-s,n[1]=d*h+f*-s+u*-o-c*-l,n[2]=u*h+f*-l+c*-s-d*-o,n},quaternionToMat4(e,t){t=math.identityMat4(t);const n=e[0],r=e[1],i=e[2],a=e[3],o=2*n,s=2*r,l=2*i,h=o*a,c=s*a,d=l*a,u=o*n,f=s*n,m=l*n,p=s*r,_=l*r,g=l*i;return t[0]=1-(p+g),t[1]=f+d,t[2]=m-c,t[4]=f-d,t[5]=1-(u+g),t[6]=_+h,t[8]=m+c,t[9]=_-h,t[10]=1-(u+p),t},quaternionToRotationMat4(e,t){const n=e[0],r=e[1],i=e[2],a=e[3],o=n+n,s=r+r,l=i+i,h=n*o,c=n*s,d=n*l,u=r*s,f=r*l,m=i*l,p=a*o,_=a*s,g=a*l;return t[0]=1-(u+m),t[4]=c-g,t[8]=d+_,t[1]=c+g,t[5]=1-(h+m),t[9]=f-p,t[2]=d-_,t[6]=f+p,t[10]=1-(h+u),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},normalizeQuaternion(e,t=e){const n=math.lenVec4([e[0],e[1],e[2],e[3]]);return t[0]=e[0]/n,t[1]=e[1]/n,t[2]=e[2]/n,t[3]=e[3]/n,t},conjugateQuaternion:(e,t=e)=>(t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t),inverseQuaternion:(e,t)=>math.normalizeQuaternion(math.conjugateQuaternion(e,t)),quaternionToAngleAxis(e,t=math.vec4()){const n=(e=math.normalizeQuaternion(e,tempVec4))[3],r=2*Math.acos(n),i=Math.sqrt(1-n*n);return i<.001?(t[0]=e[0],t[1]=e[1],t[2]=e[2]):(t[0]=e[0]/i,t[1]=e[1]/i,t[2]=e[2]/i),t[3]=r,t},AABB3:e=>new FloatArrayType(e||6),AABB2:e=>new FloatArrayType(e||4),OBB3:e=>new FloatArrayType(e||32),OBB2:e=>new FloatArrayType(e||16),Sphere3:(e,t,n,r)=>new FloatArrayType([e,t,n,r]),transformOBB3(e,t,n=t){let r;const i=t.length;let a,o,s;const l=e[0],h=e[1],c=e[2],d=e[3],u=e[4],f=e[5],m=e[6],p=e[7],_=e[8],g=e[9],y=e[10],w=e[11],b=e[12],v=e[13],M=e[14],A=e[15];for(r=0;r<i;r+=4)a=t[r+0],o=t[r+1],s=t[r+2],n[r+0]=l*a+u*o+_*s+b,n[r+1]=h*a+f*o+g*s+v,n[r+2]=c*a+m*o+y*s+M,n[r+3]=d*a+p*o+w*s+A;return n},containsAABB3:function(e,t){return e[0]<=t[0]&&t[3]<=e[3]&&e[1]<=t[1]&&t[4]<=e[4]&&e[2]<=t[2]&&t[5]<=e[5]},getAABB3Diag:(()=>{const e=new FloatArrayType(3),t=new FloatArrayType(3),n=new FloatArrayType(3);return r=>(e[0]=r[0],e[1]=r[1],e[2]=r[2],t[0]=r[3],t[1]=r[4],t[2]=r[5],math.subVec3(t,e,n),Math.abs(math.lenVec3(n)))})(),getAABB3DiagPoint:(()=>{const e=new FloatArrayType(3),t=new FloatArrayType(3),n=new FloatArrayType(3);return(r,i)=>{e[0]=r[0],e[1]=r[1],e[2]=r[2],t[0]=r[3],t[1]=r[4],t[2]=r[5];const a=math.subVec3(t,e,n),o=i[0]-r[0],s=r[3]-i[0],l=i[1]-r[1],h=r[4]-i[1],c=i[2]-r[2],d=r[5]-i[2];return a[0]+=o>s?o:s,a[1]+=l>h?l:h,a[2]+=c>d?c:d,Math.abs(math.lenVec3(a))}})(),getAABB3Center(e,t){const n=t||math.vec3();return n[0]=(e[0]+e[3])/2,n[1]=(e[1]+e[4])/2,n[2]=(e[2]+e[5])/2,n},getAABB2Center(e,t){const n=t||math.vec2();return n[0]=(e[2]+e[0])/2,n[1]=(e[3]+e[1])/2,n},collapseAABB3:(e=math.AABB3())=>(e[0]=math.MAX_DOUBLE,e[1]=math.MAX_DOUBLE,e[2]=math.MAX_DOUBLE,e[3]=-math.MAX_DOUBLE,e[4]=-math.MAX_DOUBLE,e[5]=-math.MAX_DOUBLE,e),AABB3ToOBB3:(e,t=math.OBB3())=>(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=1,t[4]=e[3],t[5]=e[1],t[6]=e[2],t[7]=1,t[8]=e[3],t[9]=e[4],t[10]=e[2],t[11]=1,t[12]=e[0],t[13]=e[4],t[14]=e[2],t[15]=1,t[16]=e[0],t[17]=e[1],t[18]=e[5],t[19]=1,t[20]=e[3],t[21]=e[1],t[22]=e[5],t[23]=1,t[24]=e[3],t[25]=e[4],t[26]=e[5],t[27]=1,t[28]=e[0],t[29]=e[4],t[30]=e[5],t[31]=1,t),positions3ToAABB3:(()=>{const e=new FloatArrayType(3);return(t,n,r)=>{n=n||math.AABB3();let i,a,o,s=math.MAX_DOUBLE,l=math.MAX_DOUBLE,h=math.MAX_DOUBLE,c=-math.MAX_DOUBLE,d=-math.MAX_DOUBLE,u=-math.MAX_DOUBLE;for(let n=0,f=t.length;n<f;n+=3)r?(e[0]=t[n+0],e[1]=t[n+1],e[2]=t[n+2],math.decompressPosition(e,r,e),i=e[0],a=e[1],o=e[2]):(i=t[n+0],a=t[n+1],o=t[n+2]),i<s&&(s=i),a<l&&(l=a),o<h&&(h=o),i>c&&(c=i),a>d&&(d=a),o>u&&(u=o);return n[0]=s,n[1]=l,n[2]=h,n[3]=c,n[4]=d,n[5]=u,n}})(),OBB3ToAABB3(e,t=math.AABB3()){let n,r,i,a=math.MAX_DOUBLE,o=math.MAX_DOUBLE,s=math.MAX_DOUBLE,l=-math.MAX_DOUBLE,h=-math.MAX_DOUBLE,c=-math.MAX_DOUBLE;for(let t=0,d=e.length;t<d;t+=4)n=e[t+0],r=e[t+1],i=e[t+2],n<a&&(a=n),r<o&&(o=r),i<s&&(s=i),n>l&&(l=n),r>h&&(h=r),i>c&&(c=i);return t[0]=a,t[1]=o,t[2]=s,t[3]=l,t[4]=h,t[5]=c,t},points3ToAABB3(e,t=math.AABB3()){let n,r,i,a=math.MAX_DOUBLE,o=math.MAX_DOUBLE,s=math.MAX_DOUBLE,l=-math.MAX_DOUBLE,h=-math.MAX_DOUBLE,c=-math.MAX_DOUBLE;for(let t=0,d=e.length;t<d;t++)n=e[t][0],r=e[t][1],i=e[t][2],n<a&&(a=n),r<o&&(o=r),i<s&&(s=i),n>l&&(l=n),r>h&&(h=r),i>c&&(c=i);return t[0]=a,t[1]=o,t[2]=s,t[3]=l,t[4]=h,t[5]=c,t},points3ToSphere3:(()=>{const e=new FloatArrayType(3);return(t,n)=>{n=n||math.vec4();let r,i=0,a=0,o=0;const s=t.length;for(r=0;r<s;r++)i+=t[r][0],a+=t[r][1],o+=t[r][2];n[0]=i/s,n[1]=a/s,n[2]=o/s;let l,h=0;for(r=0;r<s;r++)(l=Math.abs(math.lenVec3(math.subVec3(t[r],n,e))))>h&&(h=l);return n[3]=h,n}})(),positions3ToSphere3:(()=>{const e=new FloatArrayType(3),t=new FloatArrayType(3);return(n,r)=>{r=r||math.vec4();let i,a=0,o=0,s=0;const l=n.length;let h=0;for(i=0;i<l;i+=3)a+=n[i],o+=n[i+1],s+=n[i+2];const c=l/3;let d;for(r[0]=a/c,r[1]=o/c,r[2]=s/c,i=0;i<l;i+=3)e[0]=n[i],e[1]=n[i+1],e[2]=n[i+2],(d=Math.abs(math.lenVec3(math.subVec3(e,r,t))))>h&&(h=d);return r[3]=h,r}})(),OBB3ToSphere3:(()=>{const e=new FloatArrayType(3),t=new FloatArrayType(3);return(n,r)=>{r=r||math.vec4();let i,a=0,o=0,s=0;const l=n.length,h=l/4;for(i=0;i<l;i+=4)a+=n[i+0],o+=n[i+1],s+=n[i+2];r[0]=a/h,r[1]=o/h,r[2]=s/h;let c,d=0;for(i=0;i<l;i+=4)e[0]=n[i+0],e[1]=n[i+1],e[2]=n[i+2],(c=Math.abs(math.lenVec3(math.subVec3(e,r,t))))>d&&(d=c);return r[3]=d,r}})(),getSphere3Center:(e,t=math.vec3())=>(t[0]=e[0],t[1]=e[1],t[2]=e[2],t),expandAABB3:(e,t)=>(e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]>t[2]&&(e[2]=t[2]),e[3]<t[3]&&(e[3]=t[3]),e[4]<t[4]&&(e[4]=t[4]),e[5]<t[5]&&(e[5]=t[5]),e),expandAABB3Point3:(e,t)=>(e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]>t[2]&&(e[2]=t[2]),e[3]<t[0]&&(e[3]=t[0]),e[4]<t[1]&&(e[4]=t[1]),e[5]<t[2]&&(e[5]=t[2]),e)};var quantizePositions=function(e,t,n,r){const i=n[0],a=n[1],o=n[2],s=65535/(n[3]-i),l=65535/(n[4]-a),h=65535/(n[5]-o);let c;for(c=0;c<t;c+=3)r[c+0]=Math.floor((e[c+0]-i)*s),r[c+1]=Math.floor((e[c+1]-a)*l),r[c+2]=Math.floor((e[c+2]-o)*h)},createPositionsDecodeMatrix=function(){const e=math.mat4(),t=math.mat4();return function(n,r){r=r||math.mat4();const i=n[0],a=n[1],o=n[2],s=n[3]-i,l=n[4]-a,h=n[5]-o;return math.identityMat4(e),math.translationMat4v(n,e),math.identityMat4(t),math.scalingMat4v([s/65535,l/65535,h/65535],t),math.mulMat4(e,t,r),r}}();function transformAndOctEncodeNormals(e,t,n,r,i){let a,o,s,l,h,c,d=math.vec3(),u=math.vec3();for(c=0;c<n;c+=3)d[0]=t[c],d[1]=t[c+1],d[2]=t[c+2],math.transformVec3(e,d,u),math.normalizeVec3(u,u),s=a=octEncodeVec3(u,0,"floor","floor"),l=h=dot(u,0,o=octDecodeVec2(a)),(l=dot(u,0,o=octDecodeVec2(a=octEncodeVec3(u,0,"ceil","floor"))))>h&&(s=a,h=l),(l=dot(u,0,o=octDecodeVec2(a=octEncodeVec3(u,0,"floor","ceil"))))>h&&(s=a,h=l),(l=dot(u,0,o=octDecodeVec2(a=octEncodeVec3(u,0,"ceil","ceil"))))>h&&(s=a,h=l),r[i+c+0]=s[0],r[i+c+1]=s[1],r[i+c+2]=0;return i+=n}function octEncodeNormals(e,t,n,r){let i,a,o,s,l;for(let h=0;h<t;h+=3)o=i=octEncodeVec3(e,h,"floor","floor"),s=l=dot(e,h,a=octDecodeVec2(i)),(s=dot(e,h,a=octDecodeVec2(i=octEncodeVec3(e,h,"ceil","floor"))))>l&&(o=i,l=s),(s=dot(e,h,a=octDecodeVec2(i=octEncodeVec3(e,h,"floor","ceil"))))>l&&(o=i,l=s),(s=dot(e,h,a=octDecodeVec2(i=octEncodeVec3(e,h,"ceil","ceil"))))>l&&(o=i,l=s),n[r+h+0]=o[0],n[r+h+1]=o[1],n[r+h+2]=0;return r+=t}function octEncodeVec3(e,t,n,r){let i=e[t]/(Math.abs(e[t])+Math.abs(e[t+1])+Math.abs(e[t+2])),a=e[t+1]/(Math.abs(e[t])+Math.abs(e[t+1])+Math.abs(e[t+2]));if(e[t+2]<0){let e=(1-Math.abs(a))*(i>=0?1:-1),t=(1-Math.abs(i))*(a>=0?1:-1);i=e,a=t}return new Int8Array([Math[n](127.5*i+(i<0?-1:0)),Math[r](127.5*a+(a<0?-1:0))])}function octDecodeVec2(e){let t=e[0],n=e[1];t/=t<0?127:128,n/=n<0?127:128;const r=1-Math.abs(t)-Math.abs(n);r<0&&(t=(1-Math.abs(n))*(t>=0?1:-1),n=(1-Math.abs(t))*(n>=0?1:-1));const i=Math.sqrt(t*t+n*n+r*r);return[t/i,n/i,r/i]}function dot(e,t,n){return e[t]*n[0]+e[t+1]*n[1]+e[t+2]*n[2]}const geometryCompression={quantizePositions:quantizePositions,createPositionsDecodeMatrix:createPositionsDecodeMatrix,transformAndOctEncodeNormals:transformAndOctEncodeNormals,octEncodeNormals:octEncodeNormals},buildEdgeIndices=function(){const e=[],t=[],n=[],r=[],i=[];let a=0;const o=new Uint16Array(3),s=new Uint16Array(3),l=new Uint16Array(3),h=math.vec3(),c=math.vec3(),d=math.vec3(),u=math.vec3(),f=math.vec3(),m=math.vec3(),p=math.vec3();return function(_,g,y,w){!function(i,a){const o={};let s,l,h,c;const d=Math.pow(10,4);let u,f,m=0;for(u=0,f=i.length;u<f;u+=3)s=i[u],l=i[u+1],h=i[u+2],void 0===o[c=Math.round(s*d)+"_"+Math.round(l*d)+"_"+Math.round(h*d)]&&(o[c]=m/3,e[m++]=s,e[m++]=l,e[m++]=h),t[u/3]=o[c];for(u=0,f=a.length;u<f;u++)r[u]=t[a[u]],n[r[u]]=a[u]}(_,g),function(t,n){a=0;for(let _=0,g=t;_<g;_+=3){const t=3*r[_],g=3*r[_+1],y=3*r[_+2];n?(o[0]=e[t],o[1]=e[t+1],o[2]=e[t+2],s[0]=e[g],s[1]=e[g+1],s[2]=e[g+2],l[0]=e[y],l[1]=e[y+1],l[2]=e[y+2],math.decompressPosition(o,n,h),math.decompressPosition(s,n,c),math.decompressPosition(l,n,d)):(h[0]=e[t],h[1]=e[t+1],h[2]=e[t+2],c[0]=e[g],c[1]=e[g+1],c[2]=e[g+2],d[0]=e[y],d[1]=e[y+1],d[2]=e[y+2]),math.subVec3(d,c,u),math.subVec3(h,c,f),math.cross3Vec3(u,f,m),math.normalizeVec3(m,p);const w=i[a]||(i[a]={normal:math.vec3()});w.normal[0]=p[0],w.normal[1]=p[1],w.normal[2]=p[2],a++}}(g.length,y);const b=[],v=Math.cos(math.DEGTORAD*w),M={};let A,k,x,T,B,E,z,I,P,S,V,G=!1;for(let e=0,t=g.length;e<t;e+=3){const t=e/3;for(let n=0;n<3;n++)A=r[e+n],k=r[e+(n+1)%3],void 0===M[B=(x=Math.min(A,k))+","+(T=Math.max(A,k))]?M[B]={index1:x,index2:T,face1:t,face2:void 0}:M[B].face2=t}for(B in M)void 0!==(E=M[B]).face2&&(z=i[E.face1].normal,I=i[E.face2].normal,(P=math.dotVec3(z,I))>v)||(S=n[E.index1],V=n[E.index2],(!G&&S>65535||V>65535)&&(G=!0),b.push(S),b.push(V));return G?new Uint32Array(b):new Uint16Array(b)}}(),isTriangleMeshSolid=(e,t)=>{let n=0;const r={},i=[],a={};for(let a=0,o=e.length;a<o;a++){const o=e[a],s=t[3*o]+","+t[3*o+1]+","+t[3*o+2];let l=r[s];void 0===l&&(l=n++),i[a]=l,r[s]=l}for(let e=0,t=i.length;e<t;e+=3){const t=i[e],n=i[e+1],r=i[e+2];let o=t,s=n,l=r;t>n&&t>r?n>r?(o=t,s=n,l=r):(o=t,s=r,l=n):n>t&&n>r?t>r?(o=n,s=t,l=r):(o=n,s=r,l=t):r>t&&r>n&&(t>n?(o=r,s=t,l=n):(o=r,s=n,l=t));let h=o+"-"+s,c=a[h];if(a[h]=void 0===c?1:c+1,c=a[h=s+"-"+l],a[h]=void 0===c?1:c+1,o>l){const e=l;l=o,o=e}c=a[h=l+"-"+o],a[h]=void 0===c?1:c+1}for(let e in a)if(2!==a[e])return!1;return!0};class XKTMesh{constructor(e){this.meshId=e.meshId,this.meshIndex=e.meshIndex,this.matrix=e.matrix,this.geometry=e.geometry,this.color=e.color||new Uint8Array(3),this.metallic=null!==e.metallic&&void 0!==e.metallic?e.metallic:0,this.roughness=null!==e.roughness&&void 0!==e.roughness?e.roughness:1,this.opacity=void 0!==e.opacity&&null!==e.opacity?e.opacity:1,this.entity=null}}class XKTGeometry{constructor(e){this.geometryId=e.geometryId,this.primitiveType=e.primitiveType,this.geometryIndex=e.geometryIndex,this.numInstances=0,this.positions=e.positions,this.positionsQuantized=new Uint16Array(e.positions.length),this.normals=e.normals,this.normalsOctEncoded=null,this.colorsCompressed=e.colorsCompressed,this.indices=e.indices,this.edgeIndices=e.edgeIndices,this.solid=!1}get reused(){return this.numInstances>1}}class XKTEntity{constructor(e,t){this.entityId=e,this.entityIndex=0,this.meshes=t,this.aabb=math.AABB3(),this.hasReusedGeometries=!1}}class XKTTile{constructor(e,t){this.aabb=e,this.entities=t}}class KDNode{constructor(e){this.aabb=e,this.entities=null,this.left=null,this.right=null}}const tempVec4a=math.vec4([0,0,0,1]),tempVec4b=math.vec4([0,0,0,1]),tempMat4=math.mat4(),tempMat4b=math.mat4(),MIN_TILE_DIAG=1e4,kdTreeDimLength=new Float64Array(3);class XKTModel{constructor(e={}){this.edgeThreshold=e.edgeThreshold||10,this.reusedGeometriesDecodeMatrix=new Float64Array(16),this.geometries={},this.geometriesList=[],this.meshes={},this.meshesList=[],this.entities={},this.entitiesList=[],this.tilesList=[],this.finalized=!1}createGeometry(e){if(!e)throw"Parameters expected: params";if(null===e.geometryId||void 0===e.geometryId)throw"Parameter expected: params.geometryId";if(!e.primitiveType)throw"Parameter expected: params.primitiveType";if(!e.positions)throw"Parameter expected: params.positions";const t="triangles"===e.primitiveType,n="points"===e.primitiveType,r="lines"===e.primitiveType;if(!t&&!n&&!r)throw"Unsupported value for params.primitiveType: "+e.primitiveType+"' - supported values are 'triangles', 'points' and 'lines'";if(t){if(!e.normals)throw"Parameter expected for 'triangles' primitive: params.normals";if(!e.indices)throw"Parameter expected for 'triangles' primitive: params.indices"}if(n&&!e.colors&&!e.colorsCompressed)throw"Parameter expected for 'points' primitive: params.colors or params.colorsCompressed";if(r&&!e.indices)throw"Parameter expected for 'lines' primitive: params.indices";if(this.finalized)return void console.error("XKTModel has been finalized, can't add more geometries");if(this.geometries[e.geometryId])return void console.error("XKTGeometry already exists with this ID: "+e.geometryId);const i=e.geometryId,a=e.primitiveType,o=new Float64Array(e.positions),s={geometryId:i,geometryIndex:this.geometriesList.length,primitiveType:a,positions:o};if(t&&(s.normals=new Float64Array(e.normals),s.indices=e.indices,s.edgeIndices=buildEdgeIndices(o,e.indices,null,e.edgeThreshold||this.edgeThreshold||10)),n)if(e.colorsCompressed)s.colorsCompressed=new Uint8Array(e.colorsCompressed);else{const t=e.colors,n=new Uint8Array(t.length);for(let e=0,r=t.length;e<r;e++)n[e]=Math.floor(255*t[e]);s.colorsCompressed=n}r&&(s.indices=e.indices);const l=new XKTGeometry(s);return this.geometries[i]=l,this.geometriesList.push(l),l}createMesh(e){if(null===e.meshId||void 0===e.meshId)throw"Parameter expected: params.meshId";if(null===e.geometryId||void 0===e.geometryId)throw"Parameter expected: params.geometryId";if(this.finalized)throw"XKTModel has been finalized, can't add more meshes";if(this.meshes[e.meshId])return void console.error("XKTMesh already exists with this ID: "+e.meshId);const t=this.geometries[e.geometryId];if(!t)return void console.error("XKTGeometry not found: "+e.geometryId);t.numInstances++;let n=e.matrix;if(!n){const t=e.position,r=e.scale,i=e.rotation;if(t||r||i){n=math.identityMat4();const e=math.eulerToQuaternion(i||[0,0,0],"XYZ",math.identityQuaternion());math.composeMat4(t||[0,0,0],e,r||[1,1,1],n)}else n=math.identityMat4()}const r=this.meshesList.length,i=new XKTMesh({meshId:e.meshId,meshIndex:r,matrix:n,geometry:t,color:e.color,metallic:e.metallic,roughness:e.roughness,opacity:e.opacity});return this.meshes[i.meshId]=i,this.meshesList.push(i),i}createEntity(e){if(!e)throw"Parameters expected: params";if(null===e.entityId||void 0===e.entityId)throw"Parameter expected: params.entityId";if(!e.meshIds)throw"Parameter expected: params.meshIds";if(this.finalized)return void console.error("XKTModel has been finalized, can't add more entities");if(this.entities[e.entityId])return void console.error("XKTEntity already exists with this ID: "+e.entityId);const t=e.entityId,n=e.meshIds,r=[];for(let e=0,t=n.length;e<t;e++){const t=n[e],i=this.meshes[t];i?i.entity?console.error("XKTMesh "+t+" already used by XKTEntity "+i.entity.entityId):r.push(i):console.error("XKTMesh found: "+t)}const i=new XKTEntity(t,r);for(let e=0,t=r.length;e<t;e++){r[e].entity=i}return this.entities[t]=i,this.entitiesList.push(i),i}finalize(){if(this.finalized)return void console.log("XKTModel already finalized");this._bakeSingleUseGeometryPositions(),this._bakeAndOctEncodeNormals(),this._createEntityAABBs();const e=this._createKDTree();this._createTilesFromKDTree(e),this._createReusedGeometriesDecodeMatrix(),this._flagSolidGeometries(),this.finalized=!0}_bakeSingleUseGeometryPositions(){for(let e=0,t=this.meshesList.length;e<t;e++){const t=this.meshesList[e],n=t.geometry;if(1===n.numInstances){const e=t.matrix;if(e&&!math.isIdentityMat4(e)){const t=n.positions;for(let n=0,r=t.length;n<r;n+=3)tempVec4a[0]=t[n+0],tempVec4a[1]=t[n+1],tempVec4a[2]=t[n+2],tempVec4a[3]=1,math.transformPoint4(e,tempVec4a,tempVec4b),t[n+0]=tempVec4b[0],t[n+1]=tempVec4b[1],t[n+2]=tempVec4b[2]}}}}_bakeAndOctEncodeNormals(){for(let e=0,t=this.meshesList.length;e<t;e++){const t=this.meshesList[e],n=t.geometry;if(n.normals&&!n.normalsOctEncoded)if(n.normalsOctEncoded=new Int8Array(n.normals.length),n.numInstances>1)geometryCompression.octEncodeNormals(n.normals,n.normals.length,n.normalsOctEncoded,0);else{const e=math.inverseMat4(math.transposeMat4(t.matrix,tempMat4),tempMat4b);geometryCompression.transformAndOctEncodeNormals(e,n.normals,n.normals.length,n.normalsOctEncoded,0)}}}_createEntityAABBs(){for(let e=0,t=this.entitiesList.length;e<t;e++){const t=this.entitiesList[e],n=t.aabb,r=t.meshes;math.collapseAABB3(n);for(let e=0,t=r.length;e<t;e++){const t=r[e],i=t.geometry,a=t.matrix;if(i.numInstances>1){const e=i.positions;for(let t=0,r=e.length;t<r;t+=3)tempVec4a[0]=e[t+0],tempVec4a[1]=e[t+1],tempVec4a[2]=e[t+2],tempVec4a[3]=1,math.transformPoint4(a,tempVec4a,tempVec4b),math.expandAABB3Point3(n,tempVec4b)}else{const e=i.positions;for(let t=0,r=e.length;t<r;t+=3)tempVec4a[0]=e[t+0],tempVec4a[1]=e[t+1],tempVec4a[2]=e[t+2],math.expandAABB3Point3(n,tempVec4a)}}}}_createKDTree(){const e=math.collapseAABB3();for(let t=0,n=this.entitiesList.length;t<n;t++){const n=this.entitiesList[t];math.expandAABB3(e,n.aabb)}const t=new KDNode(e);for(let e=0,n=this.entitiesList.length;e<n;e++){const n=this.entitiesList[e];this._insertEntityIntoKDTree(t,n)}return t}_insertEntityIntoKDTree(e,t){const n=e.aabb,r=t.aabb;if(math.getAABB3Diag(n)<MIN_TILE_DIAG)return e.entities=e.entities||[],e.entities.push(t),void math.expandAABB3(n,r);if(e.left&&math.containsAABB3(e.left.aabb,r))return void this._insertEntityIntoKDTree(e.left,t);if(e.right&&math.containsAABB3(e.right.aabb,r))return void this._insertEntityIntoKDTree(e.right,t);kdTreeDimLength[0]=n[3]-n[0],kdTreeDimLength[1]=n[4]-n[1],kdTreeDimLength[2]=n[5]-n[2];let i=0;if(kdTreeDimLength[1]>kdTreeDimLength[i]&&(i=1),kdTreeDimLength[2]>kdTreeDimLength[i]&&(i=2),!e.left){const a=n.slice();if(a[i+3]=(n[i]+n[i+3])/2,e.left=new KDNode(a),math.containsAABB3(a,r))return void this._insertEntityIntoKDTree(e.left,t)}if(!e.right){const a=n.slice();if(a[i]=(n[i]+n[i+3])/2,e.right=new KDNode(a),math.containsAABB3(a,r))return void this._insertEntityIntoKDTree(e.right,t)}e.entities=e.entities||[],e.entities.push(t),math.expandAABB3(n,r)}_createTilesFromKDTree(e){this._createTilesFromKDNode(e)}_createTilesFromKDNode(e){e.entities&&e.entities.length>0&&this._createTileFromEntities(e.entities),e.left&&this._createTilesFromKDNode(e.left),e.right&&this._createTilesFromKDNode(e.right)}_createTileFromEntities(e){const t=math.AABB3();math.collapseAABB3(t);for(let n=0;n<e.length;n++){const r=e[n];math.expandAABB3(t,r.aabb)}const n=math.getAABB3Center(t),r=math.mulVec3Scalar(n,-1,math.vec3()),i=math.AABB3();i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],i[3]=t[3]-n[0],i[4]=t[4]-n[1],i[5]=t[5]-n[2];for(let t=0;t<e.length;t++){const a=e[t],o=a.meshes;for(let e=0,t=o.length;e<t;e++){const t=o[e],a=t.geometry;if(a.reused)math.translateMat4v(r,t.matrix);else{const e=a.positions;for(let t=0,r=e.length;t<r;t+=3)e[t+0]-=n[0],e[t+1]-=n[1],e[t+2]-=n[2];geometryCompression.quantizePositions(e,e.length,i,a.positionsQuantized)}}a.entityIndex=this.entitiesList.length,this.entitiesList.push(a)}const a=new XKTTile(t,e);this.tilesList.push(a)}_createReusedGeometriesDecodeMatrix(){const e=math.vec3(),t=math.collapseAABB3(math.AABB3());let n=0;for(let r=0,i=this.geometriesList.length;r<i;r++){const i=this.geometriesList[r];if(i.reused){const r=i.positions;for(let n=0,i=r.length;n<i;n+=3)e[0]=r[n],e[1]=r[n+1],e[2]=r[n+2],math.expandAABB3Point3(t,e);n++}}if(n>0){geometryCompression.createPositionsDecodeMatrix(t,this.reusedGeometriesDecodeMatrix);for(let e=0,n=this.geometriesList.length;e<n;e++){const n=this.geometriesList[e];n.reused&&geometryCompression.quantizePositions(n.positions,n.positions.length,t,n.positionsQuantized)}}else math.identityMat4(this.reusedGeometriesDecodeMatrix)}_flagSolidGeometries(){for(let e=0,t=this.geometriesList.length;e<t;e++){const t=this.geometriesList[e];"triangles"===t.primitiveType&&(t.solid=isTriangleMeshSolid(t.indices,t.positionsQuantized))}}}function validateXKTArrayBuffer(e,t){const n=new DataView(e),r=new Uint8Array(e),i=(n.getUint32(0,!0),n.getUint32(4,!0)),a=[];let o=4*(i+2);for(let e=0;e<i;e++){const t=n.getUint32(4*(e+2),!0);a.push(r.subarray(o,o+t)),o+=t}return validateData(inflate(extract(a)),t)}function extract(e){return{positions:e[0],normals:e[1],colors:e[2],indices:e[3],edgeIndices:e[4],matrices:e[5],reusedGeometriesDecodeMatrix:e[6],eachGeometryPrimitiveType:e[7],eachGeometryPositionsPortion:e[8],eachGeometryNormalsPortion:e[9],eachGeometryColorsPortion:e[10],eachGeometryIndicesPortion:e[11],eachGeometryEdgeIndicesPortion:e[12],eachMeshGeometriesPortion:e[13],eachMeshMatricesPortion:e[14],eachMeshColorAndOpacity:e[15],eachEntityId:e[16],eachEntityMeshesPortion:e[17],eachTileAABB:e[18],eachTileEntitiesPortion:e[19]}}function inflate(e){return{positions:new Uint16Array(pako.inflate(e.positions).buffer),normals:new Int8Array(pako.inflate(e.normals).buffer),colors:new Uint8Array(pako.inflate(e.colors).buffer),indices:new Uint32Array(pako.inflate(e.indices).buffer),edgeIndices:new Uint32Array(pako.inflate(e.edgeIndices).buffer),matrices:new Float32Array(pako.inflate(e.matrices).buffer),reusedGeometriesDecodeMatrix:new Float32Array(pako.inflate(e.reusedGeometriesDecodeMatrix).buffer),eachGeometryPrimitiveType:new Uint8Array(pako.inflate(e.eachGeometryPrimitiveType).buffer),eachGeometryPositionsPortion:new Uint32Array(pako.inflate(e.eachGeometryPositionsPortion).buffer),eachGeometryNormalsPortion:new Uint32Array(pako.inflate(e.eachGeometryNormalsPortion).buffer),eachGeometryColorsPortion:new Uint32Array(pako.inflate(e.eachGeometryColorsPortion).buffer),eachGeometryIndicesPortion:new Uint32Array(pako.inflate(e.eachGeometryIndicesPortion).buffer),eachGeometryEdgeIndicesPortion:new Uint32Array(pako.inflate(e.eachGeometryEdgeIndicesPortion).buffer),eachMeshGeometriesPortion:new Uint32Array(pako.inflate(e.eachMeshGeometriesPortion).buffer),eachMeshMatricesPortion:new Uint32Array(pako.inflate(e.eachMeshMatricesPortion).buffer),eachMeshColorAndOpacity:new Uint8Array(pako.inflate(e.eachMeshColorAndOpacity).buffer),eachEntityId:pako.inflate(e.eachEntityId,{to:"string"}),eachEntityMeshesPortion:new Uint32Array(pako.inflate(e.eachEntityMeshesPortion).buffer),eachTileAABB:new Float64Array(pako.inflate(e.eachTileAABB).buffer),eachTileEntitiesPortion:new Uint32Array(pako.inflate(e.eachTileEntitiesPortion).buffer)}}const decompressColor=function(){const e=new Float32Array(3);return function(t){return e[0]=t[0]/255,e[1]=t[1]/255,e[2]=t[2]/255,e}}();function validateData(e,t){const n=e.positions,r=e.normals,i=e.colors,a=e.indices,o=e.edgeIndices,s=e.matrices,l=(e.reusedGeometriesDecodeMatrix,e.eachGeometryPrimitiveType),h=e.eachGeometryPositionsPortion,c=e.eachGeometryNormalsPortion,d=e.eachGeometryColorsPortion,u=e.eachGeometryIndicesPortion,f=e.eachGeometryEdgeIndicesPortion,m=e.eachMeshGeometriesPortion,p=e.eachMeshColorAndOpacity,_=e.eachMeshMatricesPortion,g=JSON.parse(e.eachEntityId),y=e.eachEntityMeshesPortion,w=e.eachTileAABB,b=e.eachTileEntitiesPortion,v=h.length,M=m.length,A=g.length,k=b.length;if(k!==t.tilesList.length)return console.error("Unexpected number of tiles; found "+k+", but expected "+t.tilesList.length),!1;const x=new Uint32Array(v);for(let e=0;e<M;e++){const t=m[e];void 0!==x[t]?x[t]++:x[t]=1}for(let e=0;e<M;e++){const n=m[e],r=t.geometriesList[n];if(!r)return console.error("xktModel.geometriesList[geometryIndex] not found"),!1;if(r.numInstances!==x[n])return console.error("xktGeometry.numInstances !== geometryReuseCounts[geometryIndex]"),!1}for(let e=0;e<v;e++){const n=t.geometriesList[e];if(!n)return console.error("xktModel.geometriesList[geometryIndex] not found"),!1;switch(l[e]){case 0:case 1:if("triangles"!==n.primitiveType)return console.error("eachGeometryPrimitiveType[geometryIndex] unexpected value"),!1;break;case 2:if("points"!==n.primitiveType)return console.error("eachGeometryPrimitiveType[geometryIndex] unexpected value"),!1;break;case 3:if("lines"!==n.primitiveType)return console.error("eachGeometryPrimitiveType[geometryIndex] unexpected value"),!1;break;default:return console.error("eachGeometryPrimitiveType[geometryIndex] unexpected value"),!1}}for(let e=0;e<k;e++){const M=e===k-1,T=b[e],B=M?A:b[e+1],E=6*e,z=w.subarray(E,E+6),I=t.tilesList[e];if(!I)return console.error("xktModel.tilesList[tileIndex] not found"),!1;if(!compareArrays(z,I.aabb))return console.error("compareArrays(tileAABB, xktTile.aabb) === false"),!1;if(B-T!==I.entities.length)return console.error("Unexpected number of entities in tile"),!1;for(let e=T;e<B;e++){const w=g[e],b=e===A-1,M=y[e],k=b?m.length:y[e+1],T=t.entitiesList[e];if(!T)return console.error("xktModel.entitiesList[tileEntityIndex] not found"),!1;if(w!==T.entityId)return console.error("entityId !== xktEntity.entityId"),!1;for(let e=M;e<k;e++){const g=_[e],y=s.slice(g,g+16),w=decompressColor(p.subarray(4*e,4*e+3)),b=p[4*e+3]/255,M=m[e],A=x[M],k=A>1,T=M===v-1,B=l[M],E=t.meshesList[e],z=t.geometriesList[M];if(!E)return console.error("xktModel.meshesList[meshIndex] not found"),!1;if(!z)return console.error("xktModel.geometriesList[geometryIndex] not found"),!1;if(k&&!compareArrays(y,E.matrix))return console.error("compareArrays(meshMatrix, xktMesh.matrix) === false"),!1;if(E.color&&!compareArrays(w,E.color))return console.error("compareArrays(color, xktMesh.color) === false"),!1;if(b!==E.opacity)return console.error("opacity !== xktMesh.opacity"),!1;if(E.geometry!==z)return console.error("xktMesh.geometry !== xktGeometry"),!1;let I,P,S,V,G;switch(B){case 0:case 1:I=n.subarray(h[M],T?n.length:h[M+1]),P=r.subarray(c[M],T?r.length:c[M+1]),V=a.subarray(u[M],T?a.length:u[M+1]),G=o.subarray(f[M],T?o.length:f[M+1]);break;case 2:I=n.subarray(h[M],T?n.length:h[M+1]),S=i.subarray(d[M],T?i.length:d[M+1]);break;case 3:I=n.subarray(h[M],T?n.length:h[M+1]),V=a.subarray(u[M],T?a.length:u[M+1]);break;default:continue}if(I&&!compareArrays(I,z.positionsQuantized))return console.error("compareArrays(geometryPositions, xktGeometry.positionsQuantized) === false"),!1;if(P&&!compareArrays(P,z.normalsOctEncoded))return console.error("compareArrays(geometryNormals, xktGeometry.normalsOctEncoded) === false"),!1;if(S&&!compareArrays(S,z.colorsCompressed))return console.error("compareArrays(geometryColors, xktGeometry.colorsCompressed) === false"),!1;if(V&&!compareArrays(V,z.indices))return console.error("compareArrays(geometryIndices, xktGeometry.indices) === false"),!1;if(G&&!compareArrays(G,z.edgeIndices))return console.error("compareArrays(geometryEdgeIndices, xktGeometry.edgeIndices) === false"),!1;if(A!==z.numInstances)return console.error("geometryReuseCount !== xktGeometry.numInstances"),!1}}}return!0}function compareArrays(e,t){if(e.length!==t.length)return!1;for(let n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function createCommonjsModule(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return commonjsRequire(e,void 0===t||null===t?n.path:t)}},n.exports),n.exports}function commonjsRequire(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var pako$1=createCommonjsModule(function(e,t){e.exports=function e(t,n,r){function i(o,s){if(!n[o]){if(!t[o]){var l="function"==typeof commonjsRequire&&commonjsRequire;if(!s&&l)return l(o,!0);if(a)return a(o,!0);var h=new Error("Cannot find module '"+o+"'");throw h.code="MODULE_NOT_FOUND",h}var c=n[o]={exports:{}};t[o][0].call(c.exports,function(e){var n=t[o][1][e];return i(n||e)},c,c.exports,e,t,n,r)}return n[o].exports}for(var a="function"==typeof commonjsRequire&&commonjsRequire,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,t,n){var r=e("./zlib/deflate"),i=e("./utils/common"),a=e("./utils/strings"),o=e("./zlib/messages"),s=e("./zlib/zstream"),l=Object.prototype.toString,h=0,c=-1,d=0,u=8;function f(e){if(!(this instanceof f))return new f(e);this.options=i.assign({level:c,method:u,chunkSize:16384,windowBits:15,memLevel:8,strategy:d,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var n=r.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==h)throw new Error(o[n]);if(t.header&&r.deflateSetHeader(this.strm,t.header),t.dictionary){var m;if(m="string"==typeof t.dictionary?a.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(n=r.deflateSetDictionary(this.strm,m))!==h)throw new Error(o[n]);this._dict_set=!0}}function m(e,t){var n=new f(t);if(n.push(e,!0),n.err)throw n.msg||o[n.err];return n.result}f.prototype.push=function(e,t){var n,o,s=this.strm,c=this.options.chunkSize;if(this.ended)return!1;o=t===~~t?t:!0===t?4:0,"string"==typeof e?s.input=a.string2buf(e):"[object ArrayBuffer]"===l.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new i.Buf8(c),s.next_out=0,s.avail_out=c),1!==(n=r.deflate(s,o))&&n!==h)return this.onEnd(n),this.ended=!0,!1;0!==s.avail_out&&(0!==s.avail_in||4!==o&&2!==o)||("string"===this.options.to?this.onData(a.buf2binstring(i.shrinkBuf(s.output,s.next_out))):this.onData(i.shrinkBuf(s.output,s.next_out)))}while((s.avail_in>0||0===s.avail_out)&&1!==n);return 4===o?(n=r.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===h):2!==o||(this.onEnd(h),s.avail_out=0,!0)},f.prototype.onData=function(e){this.chunks.push(e)},f.prototype.onEnd=function(e){e===h&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Deflate=f,n.deflate=m,n.deflateRaw=function(e,t){return(t=t||{}).raw=!0,m(e,t)},n.gzip=function(e,t){return(t=t||{}).gzip=!0,m(e,t)}},{"./utils/common":3,"./utils/strings":4,"./zlib/deflate":8,"./zlib/messages":13,"./zlib/zstream":15}],2:[function(e,t,n){var r=e("./zlib/inflate"),i=e("./utils/common"),a=e("./utils/strings"),o=e("./zlib/constants"),s=e("./zlib/messages"),l=e("./zlib/zstream"),h=e("./zlib/gzheader"),c=Object.prototype.toString;function d(e){if(!(this instanceof d))return new d(e);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var n=r.inflateInit2(this.strm,t.windowBits);if(n!==o.Z_OK)throw new Error(s[n]);if(this.header=new h,r.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=a.string2buf(t.dictionary):"[object ArrayBuffer]"===c.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=r.inflateSetDictionary(this.strm,t.dictionary))!==o.Z_OK))throw new Error(s[n])}function u(e,t){var n=new d(t);if(n.push(e,!0),n.err)throw n.msg||s[n.err];return n.result}d.prototype.push=function(e,t){var n,s,l,h,d,u=this.strm,f=this.options.chunkSize,m=this.options.dictionary,p=!1;if(this.ended)return!1;s=t===~~t?t:!0===t?o.Z_FINISH:o.Z_NO_FLUSH,"string"==typeof e?u.input=a.binstring2buf(e):"[object ArrayBuffer]"===c.call(e)?u.input=new Uint8Array(e):u.input=e,u.next_in=0,u.avail_in=u.input.length;do{if(0===u.avail_out&&(u.output=new i.Buf8(f),u.next_out=0,u.avail_out=f),(n=r.inflate(u,o.Z_NO_FLUSH))===o.Z_NEED_DICT&&m&&(n=r.inflateSetDictionary(this.strm,m)),n===o.Z_BUF_ERROR&&!0===p&&(n=o.Z_OK,p=!1),n!==o.Z_STREAM_END&&n!==o.Z_OK)return this.onEnd(n),this.ended=!0,!1;u.next_out&&(0!==u.avail_out&&n!==o.Z_STREAM_END&&(0!==u.avail_in||s!==o.Z_FINISH&&s!==o.Z_SYNC_FLUSH)||("string"===this.options.to?(l=a.utf8border(u.output,u.next_out),h=u.next_out-l,d=a.buf2string(u.output,l),u.next_out=h,u.avail_out=f-h,h&&i.arraySet(u.output,u.output,l,h,0),this.onData(d)):this.onData(i.shrinkBuf(u.output,u.next_out)))),0===u.avail_in&&0===u.avail_out&&(p=!0)}while((u.avail_in>0||0===u.avail_out)&&n!==o.Z_STREAM_END);return n===o.Z_STREAM_END&&(s=o.Z_FINISH),s===o.Z_FINISH?(n=r.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===o.Z_OK):s!==o.Z_SYNC_FLUSH||(this.onEnd(o.Z_OK),u.avail_out=0,!0)},d.prototype.onData=function(e){this.chunks.push(e)},d.prototype.onEnd=function(e){e===o.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Inflate=d,n.inflate=u,n.inflateRaw=function(e,t){return(t=t||{}).raw=!0,u(e,t)},n.ungzip=u},{"./utils/common":3,"./utils/strings":4,"./zlib/constants":6,"./zlib/gzheader":9,"./zlib/inflate":11,"./zlib/messages":13,"./zlib/zstream":15}],3:[function(e,t,n){var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}n.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var r in n)i(n,r)&&(e[r]=n[r])}}return e},n.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var a={arraySet:function(e,t,n,r,i){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+r),i);else for(var a=0;a<r;a++)e[i+a]=t[n+a]},flattenChunks:function(e){var t,n,r,i,a,o;for(r=0,t=0,n=e.length;t<n;t++)r+=e[t].length;for(o=new Uint8Array(r),i=0,t=0,n=e.length;t<n;t++)a=e[t],o.set(a,i),i+=a.length;return o}},o={arraySet:function(e,t,n,r,i){for(var a=0;a<r;a++)e[i+a]=t[n+a]},flattenChunks:function(e){return[].concat.apply([],e)}};n.setTyped=function(e){e?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,a)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,o))},n.setTyped(r)},{}],4:[function(e,t,n){var r=e("./common"),i=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch(e){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){a=!1}for(var o=new r.Buf8(256),s=0;s<256;s++)o[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;function l(e,t){if(t<65534&&(e.subarray&&a||!e.subarray&&i))return String.fromCharCode.apply(null,r.shrinkBuf(e,t));for(var n="",o=0;o<t;o++)n+=String.fromCharCode(e[o]);return n}o[254]=o[254]=1,n.string2buf=function(e){var t,n,i,a,o,s=e.length,l=0;for(a=0;a<s;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(i=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(i-56320),a++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=new r.Buf8(l),o=0,a=0;o<l;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(i=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(i-56320),a++),n<128?t[o++]=n:n<2048?(t[o++]=192|n>>>6,t[o++]=128|63&n):n<65536?(t[o++]=224|n>>>12,t[o++]=128|n>>>6&63,t[o++]=128|63&n):(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63,t[o++]=128|n>>>6&63,t[o++]=128|63&n);return t},n.buf2binstring=function(e){return l(e,e.length)},n.binstring2buf=function(e){for(var t=new r.Buf8(e.length),n=0,i=t.length;n<i;n++)t[n]=e.charCodeAt(n);return t},n.buf2string=function(e,t){var n,r,i,a,s=t||e.length,h=new Array(2*s);for(r=0,n=0;n<s;)if((i=e[n++])<128)h[r++]=i;else if((a=o[i])>4)h[r++]=65533,n+=a-1;else{for(i&=2===a?31:3===a?15:7;a>1&&n<s;)i=i<<6|63&e[n++],a--;a>1?h[r++]=65533:i<65536?h[r++]=i:(i-=65536,h[r++]=55296|i>>10&1023,h[r++]=56320|1023&i)}return l(h,r)},n.utf8border=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;n>=0&&128==(192&e[n]);)n--;return n<0?t:0===n?t:n+o[e[n]]>t?n:t}},{"./common":3}],5:[function(e,t,n){t.exports=function(e,t,n,r){for(var i=65535&e|0,a=e>>>16&65535|0,o=0;0!==n;){n-=o=n>2e3?2e3:n;do{i=i+t[r++]|0,a=a+i|0}while(--o);i%=65521,a%=65521}return i|a<<16|0}},{}],6:[function(e,t,n){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],7:[function(e,t,n){var r=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t,n,i){var a=r,o=i+n;e^=-1;for(var s=i;s<o;s++)e=e>>>8^a[255&(e^t[s])];return-1^e}},{}],8:[function(e,t,n){var r,i=e("../utils/common"),a=e("./trees"),o=e("./adler32"),s=e("./crc32"),l=e("./messages"),h=0,c=1,d=3,u=4,f=5,m=0,p=1,_=-2,g=-3,y=-5,w=-1,b=1,v=2,M=3,A=4,k=0,x=2,T=8,B=9,E=15,z=8,I=286,P=30,S=19,V=2*I+1,G=15,D=3,L=258,O=L+D+1,U=32,F=42,C=69,N=73,X=91,R=103,K=113,Z=666,q=1,$=2,j=3,Q=4,Y=3;function H(e,t){return e.msg=l[t],t}function W(e){return(e<<1)-(e>4?9:0)}function J(e){for(var t=e.length;--t>=0;)e[t]=0}function ee(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(i.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function te(e,t){a._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,ee(e.strm)}function ne(e,t){e.pending_buf[e.pending++]=t}function re(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function ie(e,t){var n,r,i=e.max_chain_length,a=e.strstart,o=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-O?e.strstart-(e.w_size-O):0,h=e.window,c=e.w_mask,d=e.prev,u=e.strstart+L,f=h[a+o-1],m=h[a+o];e.prev_length>=e.good_match&&(i>>=2),s>e.lookahead&&(s=e.lookahead);do{if(h[(n=t)+o]===m&&h[n+o-1]===f&&h[n]===h[a]&&h[++n]===h[a+1]){a+=2,n++;do{}while(h[++a]===h[++n]&&h[++a]===h[++n]&&h[++a]===h[++n]&&h[++a]===h[++n]&&h[++a]===h[++n]&&h[++a]===h[++n]&&h[++a]===h[++n]&&h[++a]===h[++n]&&a<u);if(r=L-(u-a),a=u-L,r>o){if(e.match_start=t,o=r,r>=s)break;f=h[a+o-1],m=h[a+o]}}}while((t=d[t&c])>l&&0!=--i);return o<=e.lookahead?o:e.lookahead}function ae(e){var t,n,r,a,l,h,c,d,u,f,m=e.w_size;do{if(a=e.window_size-e.lookahead-e.strstart,e.strstart>=m+(m-O)){i.arraySet(e.window,e.window,m,m,0),e.match_start-=m,e.strstart-=m,e.block_start-=m,n=e.hash_size,t=n;do{r=e.head[--t],e.head[t]=r>=m?r-m:0}while(--n);t=n=m;do{r=e.prev[--t],e.prev[t]=r>=m?r-m:0}while(--n);a+=m}if(0===e.strm.avail_in)break;if(h=e.strm,c=e.window,d=e.strstart+e.lookahead,u=a,f=void 0,(f=h.avail_in)>u&&(f=u),n=0===f?0:(h.avail_in-=f,i.arraySet(c,h.input,h.next_in,f,d),1===h.state.wrap?h.adler=o(h.adler,c,f,d):2===h.state.wrap&&(h.adler=s(h.adler,c,f,d)),h.next_in+=f,h.total_in+=f,f),e.lookahead+=n,e.lookahead+e.insert>=D)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+D-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<D)););}while(e.lookahead<O&&0!==e.strm.avail_in)}function oe(e,t){for(var n,r;;){if(e.lookahead<O){if(ae(e),e.lookahead<O&&t===h)return q;if(0===e.lookahead)break}if(n=0,e.lookahead>=D&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+D-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-O&&(e.match_length=ie(e,n)),e.match_length>=D)if(r=a._tr_tally(e,e.strstart-e.match_start,e.match_length-D),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=D){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+D-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(te(e,!1),0===e.strm.avail_out))return q}return e.insert=e.strstart<D-1?e.strstart:D-1,t===u?(te(e,!0),0===e.strm.avail_out?j:Q):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?q:$}function se(e,t){for(var n,r,i;;){if(e.lookahead<O){if(ae(e),e.lookahead<O&&t===h)return q;if(0===e.lookahead)break}if(n=0,e.lookahead>=D&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+D-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=D-1,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-O&&(e.match_length=ie(e,n),e.match_length<=5&&(e.strategy===b||e.match_length===D&&e.strstart-e.match_start>4096)&&(e.match_length=D-1)),e.prev_length>=D&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-D,r=a._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-D),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+D-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=D-1,e.strstart++,r&&(te(e,!1),0===e.strm.avail_out))return q}else if(e.match_available){if((r=a._tr_tally(e,0,e.window[e.strstart-1]))&&te(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return q}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=a._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<D-1?e.strstart:D-1,t===u?(te(e,!0),0===e.strm.avail_out?j:Q):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?q:$}function le(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}function he(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=x,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?F:K,e.adler=2===t.wrap?0:1,t.last_flush=h,a._tr_init(t),m):H(e,_)}function ce(e){var t,n=he(e);return n===m&&((t=e.state).window_size=2*t.w_size,J(t.head),t.max_lazy_match=r[t.level].max_lazy,t.good_match=r[t.level].good_length,t.nice_match=r[t.level].nice_length,t.max_chain_length=r[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=D-1,t.match_available=0,t.ins_h=0),n}function de(e,t,n,r,a,o){if(!e)return _;var s=1;if(t===w&&(t=6),r<0?(s=0,r=-r):r>15&&(s=2,r-=16),a<1||a>B||n!==T||r<8||r>15||t<0||t>9||o<0||o>A)return H(e,_);8===r&&(r=9);var l=new function(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=T,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(2*V),this.dyn_dtree=new i.Buf16(2*(2*P+1)),this.bl_tree=new i.Buf16(2*(2*S+1)),J(this.dyn_ltree),J(this.dyn_dtree),J(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(G+1),this.heap=new i.Buf16(2*I+1),J(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(2*I+1),J(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0};return e.state=l,l.strm=e,l.wrap=s,l.gzhead=null,l.w_bits=r,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=a+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+D-1)/D),l.window=new i.Buf8(2*l.w_size),l.head=new i.Buf16(l.hash_size),l.prev=new i.Buf16(l.w_size),l.lit_bufsize=1<<a+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new i.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=o,l.method=n,ce(e)}r=[new le(0,0,0,0,function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(ae(e),0===e.lookahead&&t===h)return q;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+n;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,te(e,!1),0===e.strm.avail_out))return q;if(e.strstart-e.block_start>=e.w_size-O&&(te(e,!1),0===e.strm.avail_out))return q}return e.insert=0,t===u?(te(e,!0),0===e.strm.avail_out?j:Q):(e.strstart>e.block_start&&(te(e,!1),e.strm.avail_out),q)}),new le(4,4,8,4,oe),new le(4,5,16,8,oe),new le(4,6,32,32,oe),new le(4,4,16,16,se),new le(8,16,32,32,se),new le(8,16,128,128,se),new le(8,32,128,256,se),new le(32,128,258,1024,se),new le(32,258,258,4096,se)],n.deflateInit=function(e,t){return de(e,t,T,E,z,k)},n.deflateInit2=de,n.deflateReset=ce,n.deflateResetKeep=he,n.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?_:(e.state.gzhead=t,m):_},n.deflate=function(e,t){var n,i,o,l;if(!e||!e.state||t>f||t<0)return e?H(e,_):_;if(i=e.state,!e.output||!e.input&&0!==e.avail_in||i.status===Z&&t!==u)return H(e,0===e.avail_out?y:_);if(i.strm=e,n=i.last_flush,i.last_flush=t,i.status===F)if(2===i.wrap)e.adler=0,ne(i,31),ne(i,139),ne(i,8),i.gzhead?(ne(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),ne(i,255&i.gzhead.time),ne(i,i.gzhead.time>>8&255),ne(i,i.gzhead.time>>16&255),ne(i,i.gzhead.time>>24&255),ne(i,9===i.level?2:i.strategy>=v||i.level<2?4:0),ne(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(ne(i,255&i.gzhead.extra.length),ne(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=s(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=C):(ne(i,0),ne(i,0),ne(i,0),ne(i,0),ne(i,0),ne(i,9===i.level?2:i.strategy>=v||i.level<2?4:0),ne(i,Y),i.status=K);else{var g=T+(i.w_bits-8<<4)<<8,w=-1;w=i.strategy>=v||i.level<2?0:i.level<6?1:6===i.level?2:3,g|=w<<6,0!==i.strstart&&(g|=U),g+=31-g%31,i.status=K,re(i,g),0!==i.strstart&&(re(i,e.adler>>>16),re(i,65535&e.adler)),e.adler=1}if(i.status===C)if(i.gzhead.extra){for(o=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),ee(e),o=i.pending,i.pending!==i.pending_buf_size));)ne(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=N)}else i.status=N;if(i.status===N)if(i.gzhead.name){o=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),ee(e),o=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,ne(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),0===l&&(i.gzindex=0,i.status=X)}else i.status=X;if(i.status===X)if(i.gzhead.comment){o=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),ee(e),o=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,ne(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),0===l&&(i.status=R)}else i.status=R;if(i.status===R&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&ee(e),i.pending+2<=i.pending_buf_size&&(ne(i,255&e.adler),ne(i,e.adler>>8&255),e.adler=0,i.status=K)):i.status=K),0!==i.pending){if(ee(e),0===e.avail_out)return i.last_flush=-1,m}else if(0===e.avail_in&&W(t)<=W(n)&&t!==u)return H(e,y);if(i.status===Z&&0!==e.avail_in)return H(e,y);if(0!==e.avail_in||0!==i.lookahead||t!==h&&i.status!==Z){var b=i.strategy===v?function(e,t){for(var n;;){if(0===e.lookahead&&(ae(e),0===e.lookahead)){if(t===h)return q;break}if(e.match_length=0,n=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(te(e,!1),0===e.strm.avail_out))return q}return e.insert=0,t===u?(te(e,!0),0===e.strm.avail_out?j:Q):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?q:$}(i,t):i.strategy===M?function(e,t){for(var n,r,i,o,s=e.window;;){if(e.lookahead<=L){if(ae(e),e.lookahead<=L&&t===h)return q;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=D&&e.strstart>0&&(i=e.strstart-1,(r=s[i])===s[++i]&&r===s[++i]&&r===s[++i])){o=e.strstart+L;do{}while(r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&i<o);e.match_length=L-(o-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=D?(n=a._tr_tally(e,1,e.match_length-D),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(te(e,!1),0===e.strm.avail_out))return q}return e.insert=0,t===u?(te(e,!0),0===e.strm.avail_out?j:Q):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?q:$}(i,t):r[i.level].func(i,t);if(b!==j&&b!==Q||(i.status=Z),b===q||b===j)return 0===e.avail_out&&(i.last_flush=-1),m;if(b===$&&(t===c?a._tr_align(i):t!==f&&(a._tr_stored_block(i,0,0,!1),t===d&&(J(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),ee(e),0===e.avail_out))return i.last_flush=-1,m}return t!==u?m:i.wrap<=0?p:(2===i.wrap?(ne(i,255&e.adler),ne(i,e.adler>>8&255),ne(i,e.adler>>16&255),ne(i,e.adler>>24&255),ne(i,255&e.total_in),ne(i,e.total_in>>8&255),ne(i,e.total_in>>16&255),ne(i,e.total_in>>24&255)):(re(i,e.adler>>>16),re(i,65535&e.adler)),ee(e),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?m:p)},n.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==F&&t!==C&&t!==N&&t!==X&&t!==R&&t!==K&&t!==Z?H(e,_):(e.state=null,t===K?H(e,g):m):_},n.deflateSetDictionary=function(e,t){var n,r,a,s,l,h,c,d,u=t.length;if(!e||!e.state)return _;if(n=e.state,2===(s=n.wrap)||1===s&&n.status!==F||n.lookahead)return _;for(1===s&&(e.adler=o(e.adler,t,u,0)),n.wrap=0,u>=n.w_size&&(0===s&&(J(n.head),n.strstart=0,n.block_start=0,n.insert=0),d=new i.Buf8(n.w_size),i.arraySet(d,t,u-n.w_size,n.w_size,0),t=d,u=n.w_size),l=e.avail_in,h=e.next_in,c=e.input,e.avail_in=u,e.next_in=0,e.input=t,ae(n);n.lookahead>=D;){r=n.strstart,a=n.lookahead-(D-1);do{n.ins_h=(n.ins_h<<n.hash_shift^n.window[r+D-1])&n.hash_mask,n.prev[r&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=r,r++}while(--a);n.strstart=r,n.lookahead=D-1,ae(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=D-1,n.match_available=0,e.next_in=h,e.input=c,e.avail_in=l,n.wrap=s,m},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":3,"./adler32":5,"./crc32":7,"./messages":13,"./trees":14}],9:[function(e,t,n){t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],10:[function(e,t,n){t.exports=function(e,t){var n,r,i,a,o,s,l,h,c,d,u,f,m,p,_,g,y,w,b,v,M,A,k,x,T;n=e.state,r=e.next_in,x=e.input,i=r+(e.avail_in-5),a=e.next_out,T=e.output,o=a-(t-e.avail_out),s=a+(e.avail_out-257),l=n.dmax,h=n.wsize,c=n.whave,d=n.wnext,u=n.window,f=n.hold,m=n.bits,p=n.lencode,_=n.distcode,g=(1<<n.lenbits)-1,y=(1<<n.distbits)-1;e:do{m<15&&(f+=x[r++]<<m,m+=8,f+=x[r++]<<m,m+=8),w=p[f&g];t:for(;;){if(f>>>=b=w>>>24,m-=b,0==(b=w>>>16&255))T[a++]=65535&w;else{if(!(16&b)){if(0==(64&b)){w=p[(65535&w)+(f&(1<<b)-1)];continue t}if(32&b){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}v=65535&w,(b&=15)&&(m<b&&(f+=x[r++]<<m,m+=8),v+=f&(1<<b)-1,f>>>=b,m-=b),m<15&&(f+=x[r++]<<m,m+=8,f+=x[r++]<<m,m+=8),w=_[f&y];n:for(;;){if(f>>>=b=w>>>24,m-=b,!(16&(b=w>>>16&255))){if(0==(64&b)){w=_[(65535&w)+(f&(1<<b)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(M=65535&w,m<(b&=15)&&(f+=x[r++]<<m,(m+=8)<b&&(f+=x[r++]<<m,m+=8)),(M+=f&(1<<b)-1)>l){e.msg="invalid distance too far back",n.mode=30;break e}if(f>>>=b,m-=b,M>(b=a-o)){if((b=M-b)>c&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(A=0,k=u,0===d){if(A+=h-b,b<v){v-=b;do{T[a++]=u[A++]}while(--b);A=a-M,k=T}}else if(d<b){if(A+=h+d-b,(b-=d)<v){v-=b;do{T[a++]=u[A++]}while(--b);if(A=0,d<v){v-=b=d;do{T[a++]=u[A++]}while(--b);A=a-M,k=T}}}else if(A+=d-b,b<v){v-=b;do{T[a++]=u[A++]}while(--b);A=a-M,k=T}for(;v>2;)T[a++]=k[A++],T[a++]=k[A++],T[a++]=k[A++],v-=3;v&&(T[a++]=k[A++],v>1&&(T[a++]=k[A++]))}else{A=a-M;do{T[a++]=T[A++],T[a++]=T[A++],T[a++]=T[A++],v-=3}while(v>2);v&&(T[a++]=T[A++],v>1&&(T[a++]=T[A++]))}break}}break}}while(r<i&&a<s);r-=v=m>>3,f&=(1<<(m-=v<<3))-1,e.next_in=r,e.next_out=a,e.avail_in=r<i?i-r+5:5-(r-i),e.avail_out=a<s?s-a+257:257-(a-s),n.hold=f,n.bits=m}},{}],11:[function(e,t,n){var r=e("../utils/common"),i=e("./adler32"),a=e("./crc32"),o=e("./inffast"),s=e("./inftrees"),l=0,h=1,c=2,d=4,u=5,f=6,m=0,p=1,_=2,g=-2,y=-3,w=-4,b=-5,v=8,M=1,A=2,k=3,x=4,T=5,B=6,E=7,z=8,I=9,P=10,S=11,V=12,G=13,D=14,L=15,O=16,U=17,F=18,C=19,N=20,X=21,R=22,K=23,Z=24,q=25,$=26,j=27,Q=28,Y=29,H=30,W=31,J=32,ee=852,te=592,ne=15;function re(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function ie(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=M,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new r.Buf32(ee),t.distcode=t.distdyn=new r.Buf32(te),t.sane=1,t.back=-1,m):g}function ae(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,ie(e)):g}function oe(e,t){var n,r;return e&&e.state?(r=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?g:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,ae(e))):g}function se(e,t){var n,i;return e?(i=new function(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0},e.state=i,i.window=null,(n=oe(e,t))!==m&&(e.state=null),n):g}var le,he,ce=!0;function de(e){if(ce){var t;for(le=new r.Buf32(512),he=new r.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(s(h,e.lens,0,288,le,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;s(c,e.lens,0,32,he,0,e.work,{bits:5}),ce=!1}e.lencode=le,e.lenbits=9,e.distcode=he,e.distbits=5}function ue(e,t,n,i){var a,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new r.Buf8(o.wsize)),i>=o.wsize?(r.arraySet(o.window,t,n-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):((a=o.wsize-o.wnext)>i&&(a=i),r.arraySet(o.window,t,n-i,a,o.wnext),(i-=a)?(r.arraySet(o.window,t,n-i,i,0),o.wnext=i,o.whave=o.wsize):(o.wnext+=a,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=a))),0}n.inflateReset=ae,n.inflateReset2=oe,n.inflateResetKeep=ie,n.inflateInit=function(e){return se(e,ne)},n.inflateInit2=se,n.inflate=function(e,t){var n,ee,te,ne,ie,ae,oe,se,le,he,ce,fe,me,pe,_e,ge,ye,we,be,ve,Me,Ae,ke,xe,Te=0,Be=new r.Buf8(4),Ee=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return g;(n=e.state).mode===V&&(n.mode=G),ie=e.next_out,te=e.output,oe=e.avail_out,ne=e.next_in,ee=e.input,ae=e.avail_in,se=n.hold,le=n.bits,he=ae,ce=oe,Ae=m;e:for(;;)switch(n.mode){case M:if(0===n.wrap){n.mode=G;break}for(;le<16;){if(0===ae)break e;ae--,se+=ee[ne++]<<le,le+=8}if(2&n.wrap&&35615===se){n.check=0,Be[0]=255&se,Be[1]=se>>>8&255,n.check=a(n.check,Be,2,0),se=0,le=0,n.mode=A;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&se)<<8)+(se>>8))%31){e.msg="incorrect header check",n.mode=H;break}if((15&se)!==v){e.msg="unknown compression method",n.mode=H;break}if(le-=4,Me=8+(15&(se>>>=4)),0===n.wbits)n.wbits=Me;else if(Me>n.wbits){e.msg="invalid window size",n.mode=H;break}n.dmax=1<<Me,e.adler=n.check=1,n.mode=512&se?P:V,se=0,le=0;break;case A:for(;le<16;){if(0===ae)break e;ae--,se+=ee[ne++]<<le,le+=8}if(n.flags=se,(255&n.flags)!==v){e.msg="unknown compression method",n.mode=H;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=H;break}n.head&&(n.head.text=se>>8&1),512&n.flags&&(Be[0]=255&se,Be[1]=se>>>8&255,n.check=a(n.check,Be,2,0)),se=0,le=0,n.mode=k;case k:for(;le<32;){if(0===ae)break e;ae--,se+=ee[ne++]<<le,le+=8}n.head&&(n.head.time=se),512&n.flags&&(Be[0]=255&se,Be[1]=se>>>8&255,Be[2]=se>>>16&255,Be[3]=se>>>24&255,n.check=a(n.check,Be,4,0)),se=0,le=0,n.mode=x;case x:for(;le<16;){if(0===ae)break e;ae--,se+=ee[ne++]<<le,le+=8}n.head&&(n.head.xflags=255&se,n.head.os=se>>8),512&n.flags&&(Be[0]=255&se,Be[1]=se>>>8&255,n.check=a(n.check,Be,2,0)),se=0,le=0,n.mode=T;case T:if(1024&n.flags){for(;le<16;){if(0===ae)break e;ae--,se+=ee[ne++]<<le,le+=8}n.length=se,n.head&&(n.head.extra_len=se),512&n.flags&&(Be[0]=255&se,Be[1]=se>>>8&255,n.check=a(n.check,Be,2,0)),se=0,le=0}else n.head&&(n.head.extra=null);n.mode=B;case B:if(1024&n.flags&&((fe=n.length)>ae&&(fe=ae),fe&&(n.head&&(Me=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),r.arraySet(n.head.extra,ee,ne,fe,Me)),512&n.flags&&(n.check=a(n.check,ee,fe,ne)),ae-=fe,ne+=fe,n.length-=fe),n.length))break e;n.length=0,n.mode=E;case E:if(2048&n.flags){if(0===ae)break e;fe=0;do{Me=ee[ne+fe++],n.head&&Me&&n.length<65536&&(n.head.name+=String.fromCharCode(Me))}while(Me&&fe<ae);if(512&n.flags&&(n.check=a(n.check,ee,fe,ne)),ae-=fe,ne+=fe,Me)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=z;case z:if(4096&n.flags){if(0===ae)break e;fe=0;do{Me=ee[ne+fe++],n.head&&Me&&n.length<65536&&(n.head.comment+=String.fromCharCode(Me))}while(Me&&fe<ae);if(512&n.flags&&(n.check=a(n.check,ee,fe,ne)),ae-=fe,ne+=fe,Me)break e}else n.head&&(n.head.comment=null);n.mode=I;case I:if(512&n.flags){for(;le<16;){if(0===ae)break e;ae--,se+=ee[ne++]<<le,le+=8}if(se!==(65535&n.check)){e.msg="header crc mismatch",n.mode=H;break}se=0,le=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=V;break;case P:for(;le<32;){if(0===ae)break e;ae--,se+=ee[ne++]<<le,le+=8}e.adler=n.check=re(se),se=0,le=0,n.mode=S;case S:if(0===n.havedict)return e.next_out=ie,e.avail_out=oe,e.next_in=ne,e.avail_in=ae,n.hold=se,n.bits=le,_;e.adler=n.check=1,n.mode=V;case V:if(t===u||t===f)break e;case G:if(n.last){se>>>=7&le,le-=7&le,n.mode=j;break}for(;le<3;){if(0===ae)break e;ae--,se+=ee[ne++]<<le,le+=8}switch(n.last=1&se,le-=1,3&(se>>>=1)){case 0:n.mode=D;break;case 1:if(de(n),n.mode=N,t===f){se>>>=2,le-=2;break e}break;case 2:n.mode=U;break;case 3:e.msg="invalid block type",n.mode=H}se>>>=2,le-=2;break;case D:for(se>>>=7&le,le-=7&le;le<32;){if(0===ae)break e;ae--,se+=ee[ne++]<<le,le+=8}if((65535&se)!=(se>>>16^65535)){e.msg="invalid stored block lengths",n.mode=H;break}if(n.length=65535&se,se=0,le=0,n.mode=L,t===f)break e;case L:n.mode=O;case O:if(fe=n.length){if(fe>ae&&(fe=ae),fe>oe&&(fe=oe),0===fe)break e;r.arraySet(te,ee,ne,fe,ie),ae-=fe,ne+=fe,oe-=fe,ie+=fe,n.length-=fe;break}n.mode=V;break;case U:for(;le<14;){if(0===ae)break e;ae--,se+=ee[ne++]<<le,le+=8}if(n.nlen=257+(31&se),se>>>=5,le-=5,n.ndist=1+(31&se),se>>>=5,le-=5,n.ncode=4+(15&se),se>>>=4,le-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=H;break}n.have=0,n.mode=F;case F:for(;n.have<n.ncode;){for(;le<3;){if(0===ae)break e;ae--,se+=ee[ne++]<<le,le+=8}n.lens[Ee[n.have++]]=7&se,se>>>=3,le-=3}for(;n.have<19;)n.lens[Ee[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,ke={bits:n.lenbits},Ae=s(l,n.lens,0,19,n.lencode,0,n.work,ke),n.lenbits=ke.bits,Ae){e.msg="invalid code lengths set",n.mode=H;break}n.have=0,n.mode=C;case C:for(;n.have<n.nlen+n.ndist;){for(;Te=n.lencode[se&(1<<n.lenbits)-1],ge=Te>>>16&255,ye=65535&Te,!((_e=Te>>>24)<=le);){if(0===ae)break e;ae--,se+=ee[ne++]<<le,le+=8}if(ye<16)se>>>=_e,le-=_e,n.lens[n.have++]=ye;else{if(16===ye){for(xe=_e+2;le<xe;){if(0===ae)break e;ae--,se+=ee[ne++]<<le,le+=8}if(se>>>=_e,le-=_e,0===n.have){e.msg="invalid bit length repeat",n.mode=H;break}Me=n.lens[n.have-1],fe=3+(3&se),se>>>=2,le-=2}else if(17===ye){for(xe=_e+3;le<xe;){if(0===ae)break e;ae--,se+=ee[ne++]<<le,le+=8}le-=_e,Me=0,fe=3+(7&(se>>>=_e)),se>>>=3,le-=3}else{for(xe=_e+7;le<xe;){if(0===ae)break e;ae--,se+=ee[ne++]<<le,le+=8}le-=_e,Me=0,fe=11+(127&(se>>>=_e)),se>>>=7,le-=7}if(n.have+fe>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=H;break}for(;fe--;)n.lens[n.have++]=Me}}if(n.mode===H)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=H;break}if(n.lenbits=9,ke={bits:n.lenbits},Ae=s(h,n.lens,0,n.nlen,n.lencode,0,n.work,ke),n.lenbits=ke.bits,Ae){e.msg="invalid literal/lengths set",n.mode=H;break}if(n.distbits=6,n.distcode=n.distdyn,ke={bits:n.distbits},Ae=s(c,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,ke),n.distbits=ke.bits,Ae){e.msg="invalid distances set",n.mode=H;break}if(n.mode=N,t===f)break e;case N:n.mode=X;case X:if(ae>=6&&oe>=258){e.next_out=ie,e.avail_out=oe,e.next_in=ne,e.avail_in=ae,n.hold=se,n.bits=le,o(e,ce),ie=e.next_out,te=e.output,oe=e.avail_out,ne=e.next_in,ee=e.input,ae=e.avail_in,se=n.hold,le=n.bits,n.mode===V&&(n.back=-1);break}for(n.back=0;Te=n.lencode[se&(1<<n.lenbits)-1],ge=Te>>>16&255,ye=65535&Te,!((_e=Te>>>24)<=le);){if(0===ae)break e;ae--,se+=ee[ne++]<<le,le+=8}if(ge&&0==(240&ge)){for(we=_e,be=ge,ve=ye;Te=n.lencode[ve+((se&(1<<we+be)-1)>>we)],ge=Te>>>16&255,ye=65535&Te,!(we+(_e=Te>>>24)<=le);){if(0===ae)break e;ae--,se+=ee[ne++]<<le,le+=8}se>>>=we,le-=we,n.back+=we}if(se>>>=_e,le-=_e,n.back+=_e,n.length=ye,0===ge){n.mode=$;break}if(32&ge){n.back=-1,n.mode=V;break}if(64&ge){e.msg="invalid literal/length code",n.mode=H;break}n.extra=15&ge,n.mode=R;case R:if(n.extra){for(xe=n.extra;le<xe;){if(0===ae)break e;ae--,se+=ee[ne++]<<le,le+=8}n.length+=se&(1<<n.extra)-1,se>>>=n.extra,le-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=K;case K:for(;Te=n.distcode[se&(1<<n.distbits)-1],ge=Te>>>16&255,ye=65535&Te,!((_e=Te>>>24)<=le);){if(0===ae)break e;ae--,se+=ee[ne++]<<le,le+=8}if(0==(240&ge)){for(we=_e,be=ge,ve=ye;Te=n.distcode[ve+((se&(1<<we+be)-1)>>we)],ge=Te>>>16&255,ye=65535&Te,!(we+(_e=Te>>>24)<=le);){if(0===ae)break e;ae--,se+=ee[ne++]<<le,le+=8}se>>>=we,le-=we,n.back+=we}if(se>>>=_e,le-=_e,n.back+=_e,64&ge){e.msg="invalid distance code",n.mode=H;break}n.offset=ye,n.extra=15&ge,n.mode=Z;case Z:if(n.extra){for(xe=n.extra;le<xe;){if(0===ae)break e;ae--,se+=ee[ne++]<<le,le+=8}n.offset+=se&(1<<n.extra)-1,se>>>=n.extra,le-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=H;break}n.mode=q;case q:if(0===oe)break e;if(fe=ce-oe,n.offset>fe){if((fe=n.offset-fe)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=H;break}fe>n.wnext?(fe-=n.wnext,me=n.wsize-fe):me=n.wnext-fe,fe>n.length&&(fe=n.length),pe=n.window}else pe=te,me=ie-n.offset,fe=n.length;fe>oe&&(fe=oe),oe-=fe,n.length-=fe;do{te[ie++]=pe[me++]}while(--fe);0===n.length&&(n.mode=X);break;case $:if(0===oe)break e;te[ie++]=n.length,oe--,n.mode=X;break;case j:if(n.wrap){for(;le<32;){if(0===ae)break e;ae--,se|=ee[ne++]<<le,le+=8}if(ce-=oe,e.total_out+=ce,n.total+=ce,ce&&(e.adler=n.check=n.flags?a(n.check,te,ce,ie-ce):i(n.check,te,ce,ie-ce)),ce=oe,(n.flags?se:re(se))!==n.check){e.msg="incorrect data check",n.mode=H;break}se=0,le=0}n.mode=Q;case Q:if(n.wrap&&n.flags){for(;le<32;){if(0===ae)break e;ae--,se+=ee[ne++]<<le,le+=8}if(se!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=H;break}se=0,le=0}n.mode=Y;case Y:Ae=p;break e;case H:Ae=y;break e;case W:return w;case J:default:return g}return e.next_out=ie,e.avail_out=oe,e.next_in=ne,e.avail_in=ae,n.hold=se,n.bits=le,(n.wsize||ce!==e.avail_out&&n.mode<H&&(n.mode<j||t!==d))&&ue(e,e.output,e.next_out,ce-e.avail_out),he-=e.avail_in,ce-=e.avail_out,e.total_in+=he,e.total_out+=ce,n.total+=ce,n.wrap&&ce&&(e.adler=n.check=n.flags?a(n.check,te,ce,e.next_out-ce):i(n.check,te,ce,e.next_out-ce)),e.data_type=n.bits+(n.last?64:0)+(n.mode===V?128:0)+(n.mode===N||n.mode===L?256:0),(0===he&&0===ce||t===d)&&Ae===m&&(Ae=b),Ae},n.inflateEnd=function(e){if(!e||!e.state)return g;var t=e.state;return t.window&&(t.window=null),e.state=null,m},n.inflateGetHeader=function(e,t){var n;return e&&e.state?0==(2&(n=e.state).wrap)?g:(n.head=t,t.done=!1,m):g},n.inflateSetDictionary=function(e,t){var n,r=t.length;return e&&e.state?0!==(n=e.state).wrap&&n.mode!==S?g:n.mode===S&&i(1,t,r,0)!==n.check?y:ue(e,t,r,r)?(n.mode=W,w):(n.havedict=1,m):g},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":3,"./adler32":5,"./crc32":7,"./inffast":10,"./inftrees":12}],12:[function(e,t,n){var r=e("../utils/common"),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,n,l,h,c,d,u){var f,m,p,_,g,y,w,b,v,M=u.bits,A=0,k=0,x=0,T=0,B=0,E=0,z=0,I=0,P=0,S=0,V=null,G=0,D=new r.Buf16(16),L=new r.Buf16(16),O=null,U=0;for(A=0;A<=15;A++)D[A]=0;for(k=0;k<l;k++)D[t[n+k]]++;for(B=M,T=15;T>=1&&0===D[T];T--);if(B>T&&(B=T),0===T)return h[c++]=20971520,h[c++]=20971520,u.bits=1,0;for(x=1;x<T&&0===D[x];x++);for(B<x&&(B=x),I=1,A=1;A<=15;A++)if(I<<=1,(I-=D[A])<0)return-1;if(I>0&&(0===e||1!==T))return-1;for(L[1]=0,A=1;A<15;A++)L[A+1]=L[A]+D[A];for(k=0;k<l;k++)0!==t[n+k]&&(d[L[t[n+k]]++]=k);if(0===e?(V=O=d,y=19):1===e?(V=i,G-=257,O=a,U-=257,y=256):(V=o,O=s,y=-1),S=0,k=0,A=x,g=c,E=B,z=0,p=-1,_=(P=1<<B)-1,1===e&&P>852||2===e&&P>592)return 1;for(;;){w=A-z,d[k]<y?(b=0,v=d[k]):d[k]>y?(b=O[U+d[k]],v=V[G+d[k]]):(b=96,v=0),f=1<<A-z,x=m=1<<E;do{h[g+(S>>z)+(m-=f)]=w<<24|b<<16|v|0}while(0!==m);for(f=1<<A-1;S&f;)f>>=1;if(0!==f?(S&=f-1,S+=f):S=0,k++,0==--D[A]){if(A===T)break;A=t[n+d[k]]}if(A>B&&(S&_)!==p){for(0===z&&(z=B),g+=x,I=1<<(E=A-z);E+z<T&&!((I-=D[E+z])<=0);)E++,I<<=1;if(P+=1<<E,1===e&&P>852||2===e&&P>592)return 1;h[p=S&_]=B<<24|E<<16|g-c|0}}return 0!==S&&(h[g+S]=A-z<<24|64<<16|0),u.bits=B,0}},{"../utils/common":3}],13:[function(e,t,n){t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],14:[function(e,t,n){var r=e("../utils/common"),i=4,a=0,o=1,s=2;function l(e){for(var t=e.length;--t>=0;)e[t]=0}var h=0,c=1,d=2,u=29,f=256,m=f+1+u,p=30,_=19,g=2*m+1,y=15,w=16,b=7,v=256,M=16,A=17,k=18,x=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],T=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],B=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],E=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],z=new Array(2*(m+2));l(z);var I=new Array(2*p);l(I);var P=new Array(512);l(P);var S=new Array(256);l(S);var V=new Array(u);l(V);var G,D,L,O=new Array(p);function U(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}function F(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function C(e){return e<256?P[e]:P[256+(e>>>7)]}function N(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function X(e,t,n){e.bi_valid>w-n?(e.bi_buf|=t<<e.bi_valid&65535,N(e,e.bi_buf),e.bi_buf=t>>w-e.bi_valid,e.bi_valid+=n-w):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function R(e,t,n){X(e,n[2*t],n[2*t+1])}function K(e,t){var n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1}function Z(e,t,n){var r,i,a=new Array(y+1),o=0;for(r=1;r<=y;r++)a[r]=o=o+n[r-1]<<1;for(i=0;i<=t;i++){var s=e[2*i+1];0!==s&&(e[2*i]=K(a[s]++,s))}}function q(e){var t;for(t=0;t<m;t++)e.dyn_ltree[2*t]=0;for(t=0;t<p;t++)e.dyn_dtree[2*t]=0;for(t=0;t<_;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*v]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function $(e){e.bi_valid>8?N(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function j(e,t,n,r){var i=2*t,a=2*n;return e[i]<e[a]||e[i]===e[a]&&r[t]<=r[n]}function Q(e,t,n){for(var r=e.heap[n],i=n<<1;i<=e.heap_len&&(i<e.heap_len&&j(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!j(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r}function Y(e,t,n){var r,i,a,o,s=0;if(0!==e.last_lit)do{r=e.pending_buf[e.d_buf+2*s]<<8|e.pending_buf[e.d_buf+2*s+1],i=e.pending_buf[e.l_buf+s],s++,0===r?R(e,i,t):(a=S[i],R(e,a+f+1,t),0!==(o=x[a])&&(i-=V[a],X(e,i,o)),a=C(--r),R(e,a,n),0!==(o=T[a])&&(r-=O[a],X(e,r,o)))}while(s<e.last_lit);R(e,v,t)}function H(e,t){var n,r,i,a=t.dyn_tree,o=t.stat_desc.static_tree,s=t.stat_desc.has_stree,l=t.stat_desc.elems,h=-1;for(e.heap_len=0,e.heap_max=g,n=0;n<l;n++)0!==a[2*n]?(e.heap[++e.heap_len]=h=n,e.depth[n]=0):a[2*n+1]=0;for(;e.heap_len<2;)i=e.heap[++e.heap_len]=h<2?++h:0,a[2*i]=1,e.depth[i]=0,e.opt_len--,s&&(e.static_len-=o[2*i+1]);for(t.max_code=h,n=e.heap_len>>1;n>=1;n--)Q(e,a,n);i=l;do{n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],Q(e,a,1),r=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=r,a[2*i]=a[2*n]+a[2*r],e.depth[i]=(e.depth[n]>=e.depth[r]?e.depth[n]:e.depth[r])+1,a[2*n+1]=a[2*r+1]=i,e.heap[1]=i++,Q(e,a,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,r,i,a,o,s,l=t.dyn_tree,h=t.max_code,c=t.stat_desc.static_tree,d=t.stat_desc.has_stree,u=t.stat_desc.extra_bits,f=t.stat_desc.extra_base,m=t.stat_desc.max_length,p=0;for(a=0;a<=y;a++)e.bl_count[a]=0;for(l[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<g;n++)r=e.heap[n],(a=l[2*l[2*r+1]+1]+1)>m&&(a=m,p++),l[2*r+1]=a,r>h||(e.bl_count[a]++,o=0,r>=f&&(o=u[r-f]),s=l[2*r],e.opt_len+=s*(a+o),d&&(e.static_len+=s*(c[2*r+1]+o)));if(0!==p){do{for(a=m-1;0===e.bl_count[a];)a--;e.bl_count[a]--,e.bl_count[a+1]+=2,e.bl_count[m]--,p-=2}while(p>0);for(a=m;0!==a;a--)for(r=e.bl_count[a];0!==r;)(i=e.heap[--n])>h||(l[2*i+1]!==a&&(e.opt_len+=(a-l[2*i+1])*l[2*i],l[2*i+1]=a),r--)}}(e,t),Z(a,h,e.bl_count)}function W(e,t,n){var r,i,a=-1,o=t[1],s=0,l=7,h=4;for(0===o&&(l=138,h=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)i=o,o=t[2*(r+1)+1],++s<l&&i===o||(s<h?e.bl_tree[2*i]+=s:0!==i?(i!==a&&e.bl_tree[2*i]++,e.bl_tree[2*M]++):s<=10?e.bl_tree[2*A]++:e.bl_tree[2*k]++,s=0,a=i,0===o?(l=138,h=3):i===o?(l=6,h=3):(l=7,h=4))}function J(e,t,n){var r,i,a=-1,o=t[1],s=0,l=7,h=4;for(0===o&&(l=138,h=3),r=0;r<=n;r++)if(i=o,o=t[2*(r+1)+1],!(++s<l&&i===o)){if(s<h)do{R(e,i,e.bl_tree)}while(0!=--s);else 0!==i?(i!==a&&(R(e,i,e.bl_tree),s--),R(e,M,e.bl_tree),X(e,s-3,2)):s<=10?(R(e,A,e.bl_tree),X(e,s-3,3)):(R(e,k,e.bl_tree),X(e,s-11,7));s=0,a=i,0===o?(l=138,h=3):i===o?(l=6,h=3):(l=7,h=4)}}l(O);var ee=!1;function te(e,t,n,i){X(e,(h<<1)+(i?1:0),3),function(e,t,n,i){$(e),i&&(N(e,n),N(e,~n)),r.arraySet(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}(e,t,n,!0)}n._tr_init=function(e){ee||(function(){var e,t,n,r,i,a=new Array(y+1);for(n=0,r=0;r<u-1;r++)for(V[r]=n,e=0;e<1<<x[r];e++)S[n++]=r;for(S[n-1]=r,i=0,r=0;r<16;r++)for(O[r]=i,e=0;e<1<<T[r];e++)P[i++]=r;for(i>>=7;r<p;r++)for(O[r]=i<<7,e=0;e<1<<T[r]-7;e++)P[256+i++]=r;for(t=0;t<=y;t++)a[t]=0;for(e=0;e<=143;)z[2*e+1]=8,e++,a[8]++;for(;e<=255;)z[2*e+1]=9,e++,a[9]++;for(;e<=279;)z[2*e+1]=7,e++,a[7]++;for(;e<=287;)z[2*e+1]=8,e++,a[8]++;for(Z(z,m+1,a),e=0;e<p;e++)I[2*e+1]=5,I[2*e]=K(e,5);G=new U(z,x,f+1,m,y),D=new U(I,T,0,p,y),L=new U(new Array(0),B,0,_,b)}(),ee=!0),e.l_desc=new F(e.dyn_ltree,G),e.d_desc=new F(e.dyn_dtree,D),e.bl_desc=new F(e.bl_tree,L),e.bi_buf=0,e.bi_valid=0,q(e)},n._tr_stored_block=te,n._tr_flush_block=function(e,t,n,r){var l,h,u=0;e.level>0?(e.strm.data_type===s&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return a;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return o;for(t=32;t<f;t++)if(0!==e.dyn_ltree[2*t])return o;return a}(e)),H(e,e.l_desc),H(e,e.d_desc),u=function(e){var t;for(W(e,e.dyn_ltree,e.l_desc.max_code),W(e,e.dyn_dtree,e.d_desc.max_code),H(e,e.bl_desc),t=_-1;t>=3&&0===e.bl_tree[2*E[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),l=e.opt_len+3+7>>>3,(h=e.static_len+3+7>>>3)<=l&&(l=h)):l=h=n+5,n+4<=l&&-1!==t?te(e,t,n,r):e.strategy===i||h===l?(X(e,(c<<1)+(r?1:0),3),Y(e,z,I)):(X(e,(d<<1)+(r?1:0),3),function(e,t,n,r){var i;for(X(e,t-257,5),X(e,n-1,5),X(e,r-4,4),i=0;i<r;i++)X(e,e.bl_tree[2*E[i]+1],3);J(e,e.dyn_ltree,t-1),J(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,u+1),Y(e,e.dyn_ltree,e.dyn_dtree)),q(e),r&&$(e)},n._tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(S[n]+f+1)]++,e.dyn_dtree[2*C(t)]++),e.last_lit===e.lit_bufsize-1},n._tr_align=function(e){X(e,c<<1,3),R(e,v,z),function(e){16===e.bi_valid?(N(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},{"../utils/common":3}],15:[function(e,t,n){t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],"/":[function(e,t,n){var r=e("./lib/utils/common").assign,i=e("./lib/deflate"),a=e("./lib/inflate"),o=e("./lib/zlib/constants"),s={};r(s,i,a,o),t.exports=s},{"./lib/deflate":1,"./lib/inflate":2,"./lib/utils/common":3,"./lib/zlib/constants":6}]},{},[])("/")}),p=Object.freeze({__proto__:null,default:pako$1,__moduleExports:pako$1});let pako$2=p;pako$2.inflate||(pako$2=pako$2.default);const XKT_VERSION=7;function writeXKTModelToArrayBuffer(e){return createArrayBuffer(deflateData(getModelData(e)))}function getModelData(e){const t=e.geometriesList,n=e.meshesList,r=e.entitiesList,i=e.tilesList,a=t.length,o=n.length,s=r.length,l=i.length;let h=0,c=0,d=0,u=0,f=0,m=0;for(let e=0;e<a;e++){const n=t[e];n.positionsQuantized&&(h+=n.positionsQuantized.length),n.normalsOctEncoded&&(c+=n.normalsOctEncoded.length),n.colorsCompressed&&(d+=n.colorsCompressed.length),n.indices&&(u+=n.indices.length),n.edgeIndices&&(f+=n.edgeIndices.length)}for(let e=0;e<o;e++){n[e].geometry.numInstances>1&&(m+=16)}const p={positions:new Uint16Array(h),normals:new Int8Array(c),colors:new Uint8Array(d),indices:new Uint32Array(u),edgeIndices:new Uint32Array(f),matrices:new Float32Array(m),reusedGeometriesDecodeMatrix:new Float32Array(e.reusedGeometriesDecodeMatrix),eachGeometryPrimitiveType:new Uint8Array(a),eachGeometryPositionsPortion:new Uint32Array(a),eachGeometryNormalsPortion:new Uint32Array(a),eachGeometryColorsPortion:new Uint32Array(a),eachGeometryIndicesPortion:new Uint32Array(a),eachGeometryEdgeIndicesPortion:new Uint32Array(a),eachMeshGeometriesPortion:new Uint32Array(o),eachMeshMatricesPortion:new Uint32Array(o),eachMeshMaterial:new Uint8Array(6*o),eachEntityId:[],eachEntityMeshesPortion:new Uint32Array(s),eachTileAABB:new Float64Array(6*l),eachTileEntitiesPortion:new Uint32Array(l)};let _=0,g=0,y=0,w=0,b=0,v=0,M=0;for(let e=0;e<a;e++){const n=t[e],r="triangles"===n.primitiveType?n.solid?0:1:"points"===n.primitiveType?2:3;p.eachGeometryPrimitiveType[e]=r,p.eachGeometryPositionsPortion[e]=_,p.eachGeometryNormalsPortion[e]=g,p.eachGeometryColorsPortion[e]=y,p.eachGeometryIndicesPortion[e]=w,p.eachGeometryEdgeIndicesPortion[e]=b,n.positionsQuantized&&(p.positions.set(n.positionsQuantized,_),_+=n.positionsQuantized.length),n.normalsOctEncoded&&(p.normals.set(n.normalsOctEncoded,g),g+=n.normalsOctEncoded.length),n.colorsCompressed&&(p.colors.set(n.colorsCompressed,y),y+=n.colorsCompressed.length),n.indices&&(p.indices.set(n.indices,w),w+=n.indices.length),n.edgeIndices&&(p.edgeIndices.set(n.edgeIndices,b),b+=n.edgeIndices.length)}for(let e=0;e<o;e++){const t=n[e];t.geometry.numInstances>1&&(p.matrices.set(t.matrix,M),p.eachMeshMatricesPortion[e]=M,M+=16),p.eachMeshMaterial[v+0]=Math.floor(255*t.color[0]),p.eachMeshMaterial[v+1]=Math.floor(255*t.color[1]),p.eachMeshMaterial[v+2]=Math.floor(255*t.color[2]),p.eachMeshMaterial[v+3]=Math.floor(255*t.opacity),p.eachMeshMaterial[v+4]=Math.floor(255*t.metallic),p.eachMeshMaterial[v+5]=Math.floor(255*t.roughness),v+=6}let A=0,k=0;for(let e=0;e<l;e++){const t=i[e],n=t.entities,r=n.length;if(0===r)continue;p.eachTileEntitiesPortion[e]=A;const a=t.aabb;for(let e=0;e<r;e++){const t=n[e],r=t.meshes,i=r.length;if(0!==i){for(let e=0;e<i;e++){const t=r[e].geometry.geometryIndex;p.eachMeshGeometriesPortion[k+e]=t}p.eachEntityId[A]=t.entityId,p.eachEntityMeshesPortion[A]=k,A++,k+=i}}const o=6*e;p.eachTileAABB.set(a,o)}return p}function deflateData(e){return{positions:pako$2.deflate(e.positions.buffer),normals:pako$2.deflate(e.normals.buffer),colors:pako$2.deflate(e.colors.buffer),indices:pako$2.deflate(e.indices.buffer),edgeIndices:pako$2.deflate(e.edgeIndices.buffer),matrices:pako$2.deflate(e.matrices.buffer),reusedGeometriesDecodeMatrix:pako$2.deflate(e.reusedGeometriesDecodeMatrix.buffer),eachGeometryPrimitiveType:pako$2.deflate(e.eachGeometryPrimitiveType.buffer),eachGeometryPositionsPortion:pako$2.deflate(e.eachGeometryPositionsPortion.buffer),eachGeometryNormalsPortion:pako$2.deflate(e.eachGeometryNormalsPortion.buffer),eachGeometryColorsPortion:pako$2.deflate(e.eachGeometryColorsPortion.buffer),eachGeometryIndicesPortion:pako$2.deflate(e.eachGeometryIndicesPortion.buffer),eachGeometryEdgeIndicesPortion:pako$2.deflate(e.eachGeometryEdgeIndicesPortion.buffer),eachMeshGeometriesPortion:pako$2.deflate(e.eachMeshGeometriesPortion.buffer),eachMeshMatricesPortion:pako$2.deflate(e.eachMeshMatricesPortion.buffer),eachMeshMaterial:pako$2.deflate(e.eachMeshMaterial.buffer),eachEntityId:pako$2.deflate(JSON.stringify(e.eachEntityId).replace(/[\u007F-\uFFFF]/g,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).substr(-4)})),eachEntityMeshesPortion:pako$2.deflate(e.eachEntityMeshesPortion.buffer),eachTileAABB:pako$2.deflate(e.eachTileAABB.buffer),eachTileEntitiesPortion:pako$2.deflate(e.eachTileEntitiesPortion.buffer)}}function createArrayBuffer(e){return toArrayBuffer([e.positions,e.normals,e.colors,e.indices,e.edgeIndices,e.matrices,e.reusedGeometriesDecodeMatrix,e.eachGeometryPrimitiveType,e.eachGeometryPositionsPortion,e.eachGeometryNormalsPortion,e.eachGeometryColorsPortion,e.eachGeometryIndicesPortion,e.eachGeometryEdgeIndicesPortion,e.eachMeshGeometriesPortion,e.eachMeshMatricesPortion,e.eachMeshMaterial,e.eachEntityId,e.eachEntityMeshesPortion,e.eachTileAABB,e.eachTileEntitiesPortion])}function toArrayBuffer(e){const t=new Uint32Array(e.length+2);t[0]=XKT_VERSION,t[1]=e.length;let n=0;for(let r=0,i=e.length;r<i;r++){const i=e[r].length;t[r+2]=i,n+=i}const r=new Uint8Array(t.buffer),i=new Uint8Array(r.length+n);i.set(r);let a=r.length;for(let t=0,n=e.length;t<n;t++){const n=e[t];i.set(n,a),a+=n.length}return console.log("Array buffer size: "+(i.length/1024).toFixed(3)+" kB"),i.buffer}function isString(e){return"string"==typeof e||e instanceof String}const utils={isString:isString};let atob2;if("undefined"==typeof atob){const e=require("atob");atob2=e}else atob2=atob;const WEBGL_COMPONENT_TYPES={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},WEBGL_TYPE_SIZES={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};async function parseGLTFIntoXKTModel(e,t,n){const r={gltf:e,getAttachment:n||(()=>{throw new Error("You must define getAttachment() method to convert glTF with external resources")}),xktModel:t,geometryCreated:{},nextGeometryId:0,nextMeshId:0,nextDefaultEntityId:0};await parseBuffers(r),parseBufferViews(r),freeBuffers(r),parseMaterials(r),parseDefaultScene(r)}async function parseBuffers(e){const t=e.gltf.buffers;t&&await Promise.all(t.map(t=>parseBuffer(e,t)))}async function parseBuffer(e,t){const n=t.uri;if(!n)throw new Error("gltf/handleBuffer missing uri in "+JSON.stringify(t));t._buffer=await parseArrayBuffer(e,n)}async function parseArrayBuffer(e,t){const n=t.match(/^data:(.*?)(;base64)?,(.*)$/);if(n){const e=!!n[2];let t=n[3];t=decodeURIComponent(t),e&&(t=atob2(t));const r=new ArrayBuffer(t.length),i=new Uint8Array(r);for(let e=0;e<t.length;e++)i[e]=t.charCodeAt(e);return r}return await e.getAttachment(t)}function parseBufferViews(e){const t=e.gltf.bufferViews;if(t)for(let n=0,r=t.length;n<r;n++)parseBufferView(e,t[n])}function parseBufferView(e,t){const n=e.gltf.buffers[t.buffer];t._typedArray=null;const r=t.byteLength||0,i=t.byteOffset||0;t._buffer=n._buffer.slice(i,i+r)}function freeBuffers(e){const t=e.gltf.buffers;if(t)for(let e=0,n=t.length;e<n;e++)t[e]._buffer=null}function parseMaterials(e){const t=e.gltf.materials;if(t)for(let n=0,r=t.length;n<r;n++){const r=t[n],i=parseMaterial(e,r);r._materialData=i}}function parseMaterial(e,t){const n={color:new Float32Array([1,1,1]),opacity:1,metallic:0,roughness:1},r=t.extensions;if(r){const e=r.KHR_materials_pbrSpecularGlossiness;if(e){const t=e.diffuseFactor;null!==t&&void 0!==t&&(n.color[0]=t[0],n.color[1]=t[1],n.color[2]=t[2])}const t=r.KHR_materials_common;if(t){const e=t.technique,r=t.values||{},i="BLINN"===e,a="PHONG"===e,o="LAMBERT"===e,s=r.diffuse;s&&(i||a||o)&&(utils.isString(s)||(n.color[0]=s[0],n.color[1]=s[1],n.color[2]=s[2]));const l=r.transparency;null!==l&&void 0!==l&&(n.opacity=l);const h=r.transparent;null!==h&&void 0!==h&&(n.opacity=h)}}const i=t.pbrMetallicRoughness;if(i){const e=i.baseColorFactor;e&&(n.color[0]=e[0],n.color[1]=e[1],n.color[2]=e[2],n.opacity=e[3]);const t=i.metallicFactor;null!==t&&void 0!==t&&(n.metallic=t);const r=i.roughnessFactor;null!==r&&void 0!==r&&(n.roughness=r)}return n}function parseDefaultScene(e){const t=e.gltf.scene||0,n=e.gltf.scenes[t];if(!n)throw new Error("glTF has no default scene");parseScene(e,n)}function parseScene(e,t){const n=t.nodes;if(n)for(let t=0,r=n.length;t<r;t++){const r=e.gltf.nodes[n[t]];r&&parseNode(e,r,null)}}function parseNode(e,t,n){const r=e.gltf,i=e.xktModel;let a;t.matrix&&(a=t.matrix,n=n?math.mulMat4(n,a,math.mat4()):a),t.translation&&(a=math.translationMat4v(t.translation),n=n?math.mulMat4(n,a,a):a),t.rotation&&(a=math.quaternionToMat4(t.rotation),n=n?math.mulMat4(n,a,a):a),t.scale&&(a=math.scalingMat4v(t.scale),n=n?math.mulMat4(n,a,a):a);const o=t.mesh;if(void 0!==o){const a=r.meshes[o];if(a){const o=a.primitives.length;if(o>0){const s=[];for(let t=0;t<o;t++){const o=a.primitives[t],l=o.material,h=null!==l&&void 0!==l?r.materials[l]:null,c=h?h._materialData.color:new Float32Array([1,1,1,1]),d=h?h._materialData.opacity:1,u=h?h._materialData.metallic:0,f=h?h._materialData.roughness:1,m=createPrimitiveGeometryHash(o);if(!e.geometryCreated[m]){const t={};parsePrimitiveGeometry(e,o,t);const n=t.colors;let r;if(t.colors){r=[];for(let e=0,t=n.length;e<t;e+=4)r.push(Math.floor(255*n[e+0])),r.push(Math.floor(255*n[e+1])),r.push(Math.floor(255*n[e+2]))}i.createGeometry({geometryId:m,primitiveType:t.primitive,positions:t.positions,normals:t.normals,colorsCompressed:r,indices:t.indices}),e.geometryCreated[m]=!0}const p=e.nextMeshId++;i.createMesh({meshId:p,geometryId:m,matrix:n?n.slice():null,color:c,opacity:d,metallic:u,roughness:f}),s.push(p)}const l=t.name||"entity"+e.nextDefaultEntityId++;i.createEntity({entityId:l,meshIds:s})}}}if(t.children){const i=t.children;for(let t=0,a=i.length;t<a;t++){const a=i[t],o=r.nodes[a];o?parseNode(e,o,n):console.warn("Node not found: "+t)}}}function createPrimitiveGeometryHash(e){return e.attributes?[e.mode,null!==e.indices&&void 0!==e.indices?e.indices:"-",null!==e.positions&&void 0!==e.positions?e.positions:"-",null!==e.normals&&void 0!==e.normals?e.normals:"-",null!==e.colors&&void 0!==e.colors?e.colors:"-"].join(";"):"empty"}function parsePrimitiveGeometry(e,t,n){const r=t.attributes;if(!r)return;switch(t.mode){case 0:n.primitive="points";break;case 1:case 2:case 3:n.primitive="lines";break;case 4:case 5:case 6:n.primitive="triangles"}const i=e.gltf.accessors,a=t.indices;if(null!==a&&void 0!==a){const t=i[a];n.indices=parseAccessorTypedArray(e,t)}const o=r.POSITION;if(null!==o&&void 0!==o){const t=i[o];n.positions=parseAccessorTypedArray(e,t)}const s=r.NORMAL;if(null!==s&&void 0!==s){const t=i[s];n.normals=parseAccessorTypedArray(e,t)}const l=r.COLOR_0;if(null!==l&&void 0!==l){const t=i[l];n.colors=parseAccessorTypedArray(e,t)}}function parseAccessorTypedArray(e,t){const n=e.gltf.bufferViews[t.bufferView],r=WEBGL_TYPE_SIZES[t.type],i=WEBGL_COMPONENT_TYPES[t.componentType],a=i.BYTES_PER_ELEMENT*r;if(t.byteStride&&t.byteStride!==a)throw new Error("interleaved buffer!");return new i(n._buffer,t.byteOffset||0,t.count*r)}function buildBoxGeometry(e={}){let t=e.xSize||1;t<0&&(console.error("negative xSize not allowed - will invert"),t*=-1);let n=e.ySize||1;n<0&&(console.error("negative ySize not allowed - will invert"),n*=-1);let r=e.zSize||1;r<0&&(console.error("negative zSize not allowed - will invert"),r*=-1);const i=e.center,a=i?i[0]:0,o=i?i[1]:0,s=i?i[2]:0,l=-t+a,h=-n+o,c=-r+s,d=t+a,u=n+o,f=r+s;return{primitiveType:"triangles",positions:[d,u,f,l,u,f,l,h,f,d,h,f,d,u,f,d,h,f,d,h,c,d,u,c,d,u,f,d,u,c,l,u,c,l,u,f,l,u,f,l,u,c,l,h,c,l,h,f,l,h,c,d,h,c,d,h,f,l,h,f,d,h,c,l,h,c,l,u,c,d,u,c],normals:[0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1],uv:[1,0,0,0,0,1,1,1,0,0,0,1,1,1,1,0,1,1,1,0,0,0,0,1,1,0,0,0,0,1,1,1,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0],indices:[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]}}function buildBoxLinesGeometry(e={}){let t=e.xSize||1;t<0&&(console.error("negative xSize not allowed - will invert"),t*=-1);let n=e.ySize||1;n<0&&(console.error("negative ySize not allowed - will invert"),n*=-1);let r=e.zSize||1;r<0&&(console.error("negative zSize not allowed - will invert"),r*=-1);const i=e.center,a=i?i[0]:0,o=i?i[1]:0,s=i?i[2]:0,l=-t+a,h=-n+o,c=-r+s,d=t+a,u=n+o,f=r+s;return{primitiveType:"lines",positions:[l,h,c,l,h,f,l,u,c,l,u,f,d,h,c,d,h,f,d,u,c,d,u,f],indices:[0,1,1,3,3,2,2,0,4,5,5,7,7,6,6,4,0,4,1,5,2,6,3,7]}}function buildCylinderGeometry(e={}){let t=e.radiusTop||1;t<0&&(console.error("negative radiusTop not allowed - will invert"),t*=-1);let n=e.radiusBottom||1;n<0&&(console.error("negative radiusBottom not allowed - will invert"),n*=-1);let r=e.height||1;r<0&&(console.error("negative height not allowed - will invert"),r*=-1);let i=e.radialSegments||32;i<0&&(console.error("negative radialSegments not allowed - will invert"),i*=-1),i<3&&(i=3);let a=e.heightSegments||1;a<0&&(console.error("negative heightSegments not allowed - will invert"),a*=-1),a<1&&(a=1);const o=!!e.openEnded;let s=e.center;const l=s?s[0]:0,h=s?s[1]:0,c=s?s[2]:0,d=r/2,u=r/a,f=2*Math.PI/i,m=1/i,p=(t-n)/a,_=[],g=[],y=[],w=[];let b,v,M,A,k,x,T,B,E,z,I;const P=(90-180*Math.atan(r/(n-t))/Math.PI)/90;for(b=0;b<=a;b++)for(k=t-b*p,x=d-b*u,v=0;v<=i;v++)M=Math.sin(v*f),A=Math.cos(v*f),g.push(k*M),g.push(P),g.push(k*A),y.push(v*m),y.push(1*b/a),_.push(k*M+l),_.push(x+h),_.push(k*A+c);for(b=0;b<a;b++)for(v=0;v<=i;v++)B=(T=b*(i+1)+v)+i,w.push(T),w.push(B),w.push(B+1),w.push(T),w.push(B+1),w.push(T+1);if(!o&&t>0){for(E=_.length/3,g.push(0),g.push(1),g.push(0),y.push(.5),y.push(.5),_.push(0+l),_.push(d+h),_.push(0+c),v=0;v<=i;v++)M=Math.sin(v*f),A=Math.cos(v*f),z=.5*Math.sin(v*f)+.5,I=.5*Math.cos(v*f)+.5,g.push(t*M),g.push(1),g.push(t*A),y.push(z),y.push(I),_.push(t*M+l),_.push(d+h),_.push(t*A+c);for(v=0;v<i;v++)s=E,T=E+1+v,w.push(T),w.push(T+1),w.push(s)}if(!o&&n>0){for(E=_.length/3,g.push(0),g.push(-1),g.push(0),y.push(.5),y.push(.5),_.push(0+l),_.push(0-d+h),_.push(0+c),v=0;v<=i;v++)M=Math.sin(v*f),A=Math.cos(v*f),z=.5*Math.sin(v*f)+.5,I=.5*Math.cos(v*f)+.5,g.push(n*M),g.push(-1),g.push(n*A),y.push(z),y.push(I),_.push(n*M+l),_.push(0-d+h),_.push(n*A+c);for(v=0;v<i;v++)s=E,T=E+1+v,w.push(s),w.push(T+1),w.push(T)}return{primitiveType:"triangles",positions:_,normals:g,uv:y,indices:w}}function buildGridGeometry(e={}){let t=e.size||1;t<0&&(console.error("negative size not allowed - will invert"),t*=-1);let n=e.divisions||1;n<0&&(console.error("negative divisions not allowed - will invert"),n*=-1),n<1&&(n=1);const r=(t=t||10)/(n=n||10),i=t/2,a=[],o=[];let s=0;for(let e=0,t=-i;e<=n;e++,t+=r)a.push(-i),a.push(0),a.push(t),a.push(i),a.push(0),a.push(t),a.push(t),a.push(0),a.push(-i),a.push(t),a.push(0),a.push(i),o.push(s++),o.push(s++),o.push(s++),o.push(s++);return{primitiveType:"lines",positions:a,indices:o}}function buildPlaneGeometry(e={}){let t=e.xSize||1;t<0&&(console.error("negative xSize not allowed - will invert"),t*=-1);let n=e.zSize||1;n<0&&(console.error("negative zSize not allowed - will invert"),n*=-1);let r=e.xSegments||1;r<0&&(console.error("negative xSegments not allowed - will invert"),r*=-1),r<1&&(r=1);let i=e.xSegments||1;i<0&&(console.error("negative zSegments not allowed - will invert"),i*=-1),i<1&&(i=1);const a=e.center,o=a?a[0]:0,s=a?a[1]:0,l=a?a[2]:0,h=t/2,c=n/2,d=Math.floor(r)||1,u=Math.floor(i)||1,f=d+1,m=u+1,p=t/d,_=n/u,g=new Float32Array(f*m*3),y=new Float32Array(f*m*3),w=new Float32Array(f*m*2);let b,v,M,A,k,x,T,B=0,E=0;for(b=0;b<m;b++){const e=b*_-c;for(v=0;v<f;v++)M=v*p-h,g[B]=M+o,g[B+1]=s,g[B+2]=-e+l,y[B+2]=-1,w[E]=v/d,w[E+1]=(u-b)/u,B+=3,E+=2}B=0;const z=new(g.length/3>65535?Uint32Array:Uint16Array)(d*u*6);for(b=0;b<u;b++)for(v=0;v<d;v++)A=v+f*b,k=v+f*(b+1),x=v+1+f*(b+1),T=v+1+f*b,z[B]=T,z[B+1]=k,z[B+2]=A,z[B+3]=T,z[B+4]=x,z[B+5]=k,B+=6;return{primitiveType:"triangles",positions:g,normals:y,uv:w,indices:z}}function buildSphereGeometry(e={}){const t=e.lod||1,n=e.center?e.center[0]:0,r=e.center?e.center[1]:0,i=e.center?e.center[2]:0;let a=e.radius||1;a<0&&(console.error("negative radius not allowed - will invert"),a*=-1);let o=e.heightSegments||18;o<0&&(console.error("negative heightSegments not allowed - will invert"),o*=-1),(o=Math.floor(t*o))<18&&(o=18);let s=e.widthSegments||18;s<0&&(console.error("negative widthSegments not allowed - will invert"),s*=-1),(s=Math.floor(t*s))<18&&(s=18);const l=[],h=[],c=[],d=[];let u,f,m,p,_,g,y,w,b,v,M,A,k,x,T;for(u=0;u<=o;u++)for(m=u*Math.PI/o,p=Math.sin(m),_=Math.cos(m),f=0;f<=s;f++)g=2*f*Math.PI/s,y=Math.sin(g),b=(w=Math.cos(g))*p,v=_,M=y*p,A=1-f/s,k=u/o,h.push(b),h.push(v),h.push(M),c.push(A),c.push(k),l.push(n+a*b),l.push(r+a*v),l.push(i+a*M);for(u=0;u<o;u++)for(f=0;f<s;f++)T=(x=u*(s+1)+f)+s+1,d.push(x+1),d.push(T+1),d.push(T),d.push(x+1),d.push(T),d.push(x);return{primitiveType:"triangles",positions:l,normals:h,uv:c,indices:d}}function buildTorusGeometry(e={}){let t=e.radius||1;t<0&&(console.error("negative radius not allowed - will invert"),t*=-1),t*=.5;let n=e.tube||.3;n<0&&(console.error("negative tube not allowed - will invert"),n*=-1);let r=e.radialSegments||32;r<0&&(console.error("negative radialSegments not allowed - will invert"),r*=-1),r<4&&(r=4);let i=e.tubeSegments||24;i<0&&(console.error("negative tubeSegments not allowed - will invert"),i*=-1),i<4&&(i=4);let a=e.arc||2*Math.PI;a<0&&(console.warn("negative arc not allowed - will invert"),a*=-1),a>360&&(a=360);const o=e.center;let s=o?o[0]:0,l=o?o[1]:0;const h=o?o[2]:0,c=[],d=[],u=[],f=[];let m,p,_,g,y,w,b,v,M,A,k,x;for(v=0;v<=i;v++)for(b=0;b<=r;b++)m=b/r*a,p=.785398+v/i*Math.PI*2,s=t*Math.cos(m),l=t*Math.sin(m),_=(t+n*Math.cos(p))*Math.cos(m),g=(t+n*Math.cos(p))*Math.sin(m),y=n*Math.sin(p),c.push(_+s),c.push(g+l),c.push(y+h),u.push(1-b/r),u.push(v/i),w=math.normalizeVec3(math.subVec3([_,g,y],[s,l,h],[]),[]),d.push(w[0]),d.push(w[1]),d.push(w[2]);for(v=1;v<=i;v++)for(b=1;b<=r;b++)M=(r+1)*v+b-1,A=(r+1)*(v-1)+b-1,k=(r+1)*(v-1)+b,x=(r+1)*v+b,f.push(M),f.push(A),f.push(k),f.push(k),f.push(x),f.push(M);return{primitiveType:"triangles",positions:c,normals:d,uv:u,indices:f}}const letters={" ":{width:16,points:[]},"!":{width:10,points:[[5,21],[5,7],[-1,-1],[5,2],[4,1],[5,0],[6,1],[5,2]]},'"':{width:16,points:[[4,21],[4,14],[-1,-1],[12,21],[12,14]]},"#":{width:21,points:[[11,25],[4,-7],[-1,-1],[17,25],[10,-7],[-1,-1],[4,12],[18,12],[-1,-1],[3,6],[17,6]]},$:{width:20,points:[[8,25],[8,-4],[-1,-1],[12,25],[12,-4],[-1,-1],[17,18],[15,20],[12,21],[8,21],[5,20],[3,18],[3,16],[4,14],[5,13],[7,12],[13,10],[15,9],[16,8],[17,6],[17,3],[15,1],[12,0],[8,0],[5,1],[3,3]]},"%":{width:24,points:[[21,21],[3,0],[-1,-1],[8,21],[10,19],[10,17],[9,15],[7,14],[5,14],[3,16],[3,18],[4,20],[6,21],[8,21],[10,20],[13,19],[16,19],[19,20],[21,21],[-1,-1],[17,7],[15,6],[14,4],[14,2],[16,0],[18,0],[20,1],[21,3],[21,5],[19,7],[17,7]]},"&":{width:26,points:[[23,12],[23,13],[22,14],[21,14],[20,13],[19,11],[17,6],[15,3],[13,1],[11,0],[7,0],[5,1],[4,2],[3,4],[3,6],[4,8],[5,9],[12,13],[13,14],[14,16],[14,18],[13,20],[11,21],[9,20],[8,18],[8,16],[9,13],[11,10],[16,3],[18,1],[20,0],[22,0],[23,1],[23,2]]},"'":{width:10,points:[[5,19],[4,20],[5,21],[6,20],[6,18],[5,16],[4,15]]},"(":{width:14,points:[[11,25],[9,23],[7,20],[5,16],[4,11],[4,7],[5,2],[7,-2],[9,-5],[11,-7]]},")":{width:14,points:[[3,25],[5,23],[7,20],[9,16],[10,11],[10,7],[9,2],[7,-2],[5,-5],[3,-7]]},"*":{width:16,points:[[8,21],[8,9],[-1,-1],[3,18],[13,12],[-1,-1],[13,18],[3,12]]},"+":{width:26,points:[[13,18],[13,0],[-1,-1],[4,9],[22,9]]},",":{width:10,points:[[6,1],[5,0],[4,1],[5,2],[6,1],[6,-1],[5,-3],[4,-4]]},"-":{width:26,points:[[4,9],[22,9]]},".":{width:10,points:[[5,2],[4,1],[5,0],[6,1],[5,2]]},"/":{width:22,points:[[20,25],[2,-7]]},0:{width:20,points:[[9,21],[6,20],[4,17],[3,12],[3,9],[4,4],[6,1],[9,0],[11,0],[14,1],[16,4],[17,9],[17,12],[16,17],[14,20],[11,21],[9,21]]},1:{width:20,points:[[6,17],[8,18],[11,21],[11,0]]},2:{width:20,points:[[4,16],[4,17],[5,19],[6,20],[8,21],[12,21],[14,20],[15,19],[16,17],[16,15],[15,13],[13,10],[3,0],[17,0]]},3:{width:20,points:[[5,21],[16,21],[10,13],[13,13],[15,12],[16,11],[17,8],[17,6],[16,3],[14,1],[11,0],[8,0],[5,1],[4,2],[3,4]]},4:{width:20,points:[[13,21],[3,7],[18,7],[-1,-1],[13,21],[13,0]]},5:{width:20,points:[[15,21],[5,21],[4,12],[5,13],[8,14],[11,14],[14,13],[16,11],[17,8],[17,6],[16,3],[14,1],[11,0],[8,0],[5,1],[4,2],[3,4]]},6:{width:20,points:[[16,18],[15,20],[12,21],[10,21],[7,20],[5,17],[4,12],[4,7],[5,3],[7,1],[10,0],[11,0],[14,1],[16,3],[17,6],[17,7],[16,10],[14,12],[11,13],[10,13],[7,12],[5,10],[4,7]]},7:{width:20,points:[[17,21],[7,0],[-1,-1],[3,21],[17,21]]},8:{width:20,points:[[8,21],[5,20],[4,18],[4,16],[5,14],[7,13],[11,12],[14,11],[16,9],[17,7],[17,4],[16,2],[15,1],[12,0],[8,0],[5,1],[4,2],[3,4],[3,7],[4,9],[6,11],[9,12],[13,13],[15,14],[16,16],[16,18],[15,20],[12,21],[8,21]]},9:{width:20,points:[[16,14],[15,11],[13,9],[10,8],[9,8],[6,9],[4,11],[3,14],[3,15],[4,18],[6,20],[9,21],[10,21],[13,20],[15,18],[16,14],[16,9],[15,4],[13,1],[10,0],[8,0],[5,1],[4,3]]},":":{width:10,points:[[5,14],[4,13],[5,12],[6,13],[5,14],[-1,-1],[5,2],[4,1],[5,0],[6,1],[5,2]]},";":{width:10,points:[[5,14],[4,13],[5,12],[6,13],[5,14],[-1,-1],[6,1],[5,0],[4,1],[5,2],[6,1],[6,-1],[5,-3],[4,-4]]},"<":{width:24,points:[[20,18],[4,9],[20,0]]},"=":{width:26,points:[[4,12],[22,12],[-1,-1],[4,6],[22,6]]},">":{width:24,points:[[4,18],[20,9],[4,0]]},"?":{width:18,points:[[3,16],[3,17],[4,19],[5,20],[7,21],[11,21],[13,20],[14,19],[15,17],[15,15],[14,13],[13,12],[9,10],[9,7],[-1,-1],[9,2],[8,1],[9,0],[10,1],[9,2]]},"@":{width:27,points:[[18,13],[17,15],[15,16],[12,16],[10,15],[9,14],[8,11],[8,8],[9,6],[11,5],[14,5],[16,6],[17,8],[-1,-1],[12,16],[10,14],[9,11],[9,8],[10,6],[11,5],[-1,-1],[18,16],[17,8],[17,6],[19,5],[21,5],[23,7],[24,10],[24,12],[23,15],[22,17],[20,19],[18,20],[15,21],[12,21],[9,20],[7,19],[5,17],[4,15],[3,12],[3,9],[4,6],[5,4],[7,2],[9,1],[12,0],[15,0],[18,1],[20,2],[21,3],[-1,-1],[19,16],[18,8],[18,6],[19,5]]},A:{width:18,points:[[9,21],[1,0],[-1,-1],[9,21],[17,0],[-1,-1],[4,7],[14,7]]},B:{width:21,points:[[4,21],[4,0],[-1,-1],[4,21],[13,21],[16,20],[17,19],[18,17],[18,15],[17,13],[16,12],[13,11],[-1,-1],[4,11],[13,11],[16,10],[17,9],[18,7],[18,4],[17,2],[16,1],[13,0],[4,0]]},C:{width:21,points:[[18,16],[17,18],[15,20],[13,21],[9,21],[7,20],[5,18],[4,16],[3,13],[3,8],[4,5],[5,3],[7,1],[9,0],[13,0],[15,1],[17,3],[18,5]]},D:{width:21,points:[[4,21],[4,0],[-1,-1],[4,21],[11,21],[14,20],[16,18],[17,16],[18,13],[18,8],[17,5],[16,3],[14,1],[11,0],[4,0]]},E:{width:19,points:[[4,21],[4,0],[-1,-1],[4,21],[17,21],[-1,-1],[4,11],[12,11],[-1,-1],[4,0],[17,0]]},F:{width:18,points:[[4,21],[4,0],[-1,-1],[4,21],[17,21],[-1,-1],[4,11],[12,11]]},G:{width:21,points:[[18,16],[17,18],[15,20],[13,21],[9,21],[7,20],[5,18],[4,16],[3,13],[3,8],[4,5],[5,3],[7,1],[9,0],[13,0],[15,1],[17,3],[18,5],[18,8],[-1,-1],[13,8],[18,8]]},H:{width:22,points:[[4,21],[4,0],[-1,-1],[18,21],[18,0],[-1,-1],[4,11],[18,11]]},I:{width:8,points:[[4,21],[4,0]]},J:{width:16,points:[[12,21],[12,5],[11,2],[10,1],[8,0],[6,0],[4,1],[3,2],[2,5],[2,7]]},K:{width:21,points:[[4,21],[4,0],[-1,-1],[18,21],[4,7],[-1,-1],[9,12],[18,0]]},L:{width:17,points:[[4,21],[4,0],[-1,-1],[4,0],[16,0]]},M:{width:24,points:[[4,21],[4,0],[-1,-1],[4,21],[12,0],[-1,-1],[20,21],[12,0],[-1,-1],[20,21],[20,0]]},N:{width:22,points:[[4,21],[4,0],[-1,-1],[4,21],[18,0],[-1,-1],[18,21],[18,0]]},O:{width:22,points:[[9,21],[7,20],[5,18],[4,16],[3,13],[3,8],[4,5],[5,3],[7,1],[9,0],[13,0],[15,1],[17,3],[18,5],[19,8],[19,13],[18,16],[17,18],[15,20],[13,21],[9,21]]},P:{width:21,points:[[4,21],[4,0],[-1,-1],[4,21],[13,21],[16,20],[17,19],[18,17],[18,14],[17,12],[16,11],[13,10],[4,10]]},Q:{width:22,points:[[9,21],[7,20],[5,18],[4,16],[3,13],[3,8],[4,5],[5,3],[7,1],[9,0],[13,0],[15,1],[17,3],[18,5],[19,8],[19,13],[18,16],[17,18],[15,20],[13,21],[9,21],[-1,-1],[12,4],[18,-2]]},R:{width:21,points:[[4,21],[4,0],[-1,-1],[4,21],[13,21],[16,20],[17,19],[18,17],[18,15],[17,13],[16,12],[13,11],[4,11],[-1,-1],[11,11],[18,0]]},S:{width:20,points:[[17,18],[15,20],[12,21],[8,21],[5,20],[3,18],[3,16],[4,14],[5,13],[7,12],[13,10],[15,9],[16,8],[17,6],[17,3],[15,1],[12,0],[8,0],[5,1],[3,3]]},T:{width:16,points:[[8,21],[8,0],[-1,-1],[1,21],[15,21]]},U:{width:22,points:[[4,21],[4,6],[5,3],[7,1],[10,0],[12,0],[15,1],[17,3],[18,6],[18,21]]},V:{width:18,points:[[1,21],[9,0],[-1,-1],[17,21],[9,0]]},W:{width:24,points:[[2,21],[7,0],[-1,-1],[12,21],[7,0],[-1,-1],[12,21],[17,0],[-1,-1],[22,21],[17,0]]},X:{width:20,points:[[3,21],[17,0],[-1,-1],[17,21],[3,0]]},Y:{width:18,points:[[1,21],[9,11],[9,0],[-1,-1],[17,21],[9,11]]},Z:{width:20,points:[[17,21],[3,0],[-1,-1],[3,21],[17,21],[-1,-1],[3,0],[17,0]]},"[":{width:14,points:[[4,25],[4,-7],[-1,-1],[5,25],[5,-7],[-1,-1],[4,25],[11,25],[-1,-1],[4,-7],[11,-7]]},"\\":{width:14,points:[[0,21],[14,-3]]},"]":{width:14,points:[[9,25],[9,-7],[-1,-1],[10,25],[10,-7],[-1,-1],[3,25],[10,25],[-1,-1],[3,-7],[10,-7]]},"^":{width:16,points:[[6,15],[8,18],[10,15],[-1,-1],[3,12],[8,17],[13,12],[-1,-1],[8,17],[8,0]]},_:{width:16,points:[[0,-2],[16,-2]]},"`":{width:10,points:[[6,21],[5,20],[4,18],[4,16],[5,15],[6,16],[5,17]]},a:{width:19,points:[[15,14],[15,0],[-1,-1],[15,11],[13,13],[11,14],[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3]]},b:{width:19,points:[[4,21],[4,0],[-1,-1],[4,11],[6,13],[8,14],[11,14],[13,13],[15,11],[16,8],[16,6],[15,3],[13,1],[11,0],[8,0],[6,1],[4,3]]},c:{width:18,points:[[15,11],[13,13],[11,14],[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3]]},d:{width:19,points:[[15,21],[15,0],[-1,-1],[15,11],[13,13],[11,14],[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3]]},e:{width:18,points:[[3,8],[15,8],[15,10],[14,12],[13,13],[11,14],[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3]]},f:{width:12,points:[[10,21],[8,21],[6,20],[5,17],[5,0],[-1,-1],[2,14],[9,14]]},g:{width:19,points:[[15,14],[15,-2],[14,-5],[13,-6],[11,-7],[8,-7],[6,-6],[-1,-1],[15,11],[13,13],[11,14],[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3]]},h:{width:19,points:[[4,21],[4,0],[-1,-1],[4,10],[7,13],[9,14],[12,14],[14,13],[15,10],[15,0]]},i:{width:8,points:[[3,21],[4,20],[5,21],[4,22],[3,21],[-1,-1],[4,14],[4,0]]},j:{width:10,points:[[5,21],[6,20],[7,21],[6,22],[5,21],[-1,-1],[6,14],[6,-3],[5,-6],[3,-7],[1,-7]]},k:{width:17,points:[[4,21],[4,0],[-1,-1],[14,14],[4,4],[-1,-1],[8,8],[15,0]]},l:{width:8,points:[[4,21],[4,0]]},m:{width:30,points:[[4,14],[4,0],[-1,-1],[4,10],[7,13],[9,14],[12,14],[14,13],[15,10],[15,0],[-1,-1],[15,10],[18,13],[20,14],[23,14],[25,13],[26,10],[26,0]]},n:{width:19,points:[[4,14],[4,0],[-1,-1],[4,10],[7,13],[9,14],[12,14],[14,13],[15,10],[15,0]]},o:{width:19,points:[[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3],[16,6],[16,8],[15,11],[13,13],[11,14],[8,14]]},p:{width:19,points:[[4,14],[4,-7],[-1,-1],[4,11],[6,13],[8,14],[11,14],[13,13],[15,11],[16,8],[16,6],[15,3],[13,1],[11,0],[8,0],[6,1],[4,3]]},q:{width:19,points:[[15,14],[15,-7],[-1,-1],[15,11],[13,13],[11,14],[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3]]},r:{width:13,points:[[4,14],[4,0],[-1,-1],[4,8],[5,11],[7,13],[9,14],[12,14]]},s:{width:17,points:[[14,11],[13,13],[10,14],[7,14],[4,13],[3,11],[4,9],[6,8],[11,7],[13,6],[14,4],[14,3],[13,1],[10,0],[7,0],[4,1],[3,3]]},t:{width:12,points:[[5,21],[5,4],[6,1],[8,0],[10,0],[-1,-1],[2,14],[9,14]]},u:{width:19,points:[[4,14],[4,4],[5,1],[7,0],[10,0],[12,1],[15,4],[-1,-1],[15,14],[15,0]]},v:{width:16,points:[[2,14],[8,0],[-1,-1],[14,14],[8,0]]},w:{width:22,points:[[3,14],[7,0],[-1,-1],[11,14],[7,0],[-1,-1],[11,14],[15,0],[-1,-1],[19,14],[15,0]]},x:{width:17,points:[[3,14],[14,0],[-1,-1],[14,14],[3,0]]},y:{width:16,points:[[2,14],[8,0],[-1,-1],[14,14],[8,0],[6,-4],[4,-6],[2,-7],[1,-7]]},z:{width:17,points:[[14,14],[3,0],[-1,-1],[3,14],[14,14],[-1,-1],[3,0],[14,0]]},"{":{width:14,points:[[9,25],[7,24],[6,23],[5,21],[5,19],[6,17],[7,16],[8,14],[8,12],[6,10],[-1,-1],[7,24],[6,22],[6,20],[7,18],[8,17],[9,15],[9,13],[8,11],[4,9],[8,7],[9,5],[9,3],[8,1],[7,0],[6,-2],[6,-4],[7,-6],[-1,-1],[6,8],[8,6],[8,4],[7,2],[6,1],[5,-1],[5,-3],[6,-5],[7,-6],[9,-7]]},"|":{width:8,points:[[4,25],[4,-7]]},"}":{width:14,points:[[5,25],[7,24],[8,23],[9,21],[9,19],[8,17],[7,16],[6,14],[6,12],[8,10],[-1,-1],[7,24],[8,22],[8,20],[7,18],[6,17],[5,15],[5,13],[6,11],[10,9],[6,7],[5,5],[5,3],[6,1],[7,0],[8,-2],[8,-4],[7,-6],[-1,-1],[8,8],[6,6],[6,4],[7,2],[8,1],[9,-1],[9,-3],[8,-5],[7,-6],[5,-7]]},"~":{width:24,points:[[3,6],[3,8],[4,11],[6,12],[8,12],[10,11],[14,8],[16,7],[18,7],[20,8],[21,10],[-1,-1],[3,8],[4,10],[6,11],[8,11],[10,10],[14,7],[16,6],[18,6],[20,7],[21,10],[21,12]]}};function buildVectorTextGeometry(e={}){for(var t,n,r,i,a,o,s,l,h,c=e.origin||[0,0,0],d=c[0],u=c[1],f=c[2],m=e.size||1,p=[],_=[],g=((""+e.text).trim()||"").split("\n"),y=0,w=0,b=0;b<g.length;b++){t=0,r=(n=g[b]).length;for(var v=0;v<r;v++)if(i=letters[n.charAt(v)]){a=1,o=-1,s=-1,l=i.points.length;for(var M=0;M<l;M++)-1!==(h=i.points[M])[0]||-1!==h[1]?(p.push(t+h[0]*m*.04+d),p.push(w+h[1]*m*.04+u),p.push(0+f),-1===o?o=y:-1===s?s=y:(o=s,s=y),y++,a?a=!1:(_.push(o),_.push(s))):a=1;t+=.04*i.width*m}w-=35*.04*m}return{primitiveType:"lines",positions:p,indices:_}}exports.XKTModel=XKTModel,exports.buildBoxGeometry=buildBoxGeometry,exports.buildBoxLinesGeometry=buildBoxLinesGeometry,exports.buildCylinderGeometry=buildCylinderGeometry,exports.buildGridGeometry=buildGridGeometry,exports.buildPlaneGeometry=buildPlaneGeometry,exports.buildSphereGeometry=buildSphereGeometry,exports.buildTorusGeometry=buildTorusGeometry,exports.buildVectorTextGeometry=buildVectorTextGeometry,exports.parseGLTFIntoXKTModel=parseGLTFIntoXKTModel,exports.validateXKTArrayBuffer=validateXKTArrayBuffer,exports.writeXKTModelToArrayBuffer=writeXKTModelToArrayBuffer;
