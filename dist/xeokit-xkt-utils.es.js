const FloatArrayType=Float64Array,tempMat1=new FloatArrayType(16),tempMat2=new FloatArrayType(16),tempVec4=new FloatArrayType(4),math={MIN_DOUBLE:-Number.MAX_SAFE_INTEGER,MAX_DOUBLE:Number.MAX_SAFE_INTEGER,DEGTORAD:.0174532925,RADTODEG:57.295779513,vec2:t=>new FloatArrayType(t||2),vec3:t=>new FloatArrayType(t||3),vec4:t=>new FloatArrayType(t||4),mat3:t=>new FloatArrayType(t||9),mat3ToMat4:(t,e=new FloatArrayType(16))=>(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=0,e[4]=t[3],e[5]=t[4],e[6]=t[5],e[7]=0,e[8]=t[6],e[9]=t[7],e[10]=t[8],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e),mat4:t=>new FloatArrayType(t||16),mat4ToMat3(t,e){},createUUID:(()=>{const t=[];for(let e=0;e<256;e++)t[e]=(e<16?"0":"")+e.toString(16);return()=>{const e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return`${t[255&e]+t[e>>8&255]+t[e>>16&255]+t[e>>24&255]}-${t[255&n]}${t[n>>8&255]}-${t[n>>16&15|64]}${t[n>>24&255]}-${t[63&r|128]}${t[r>>8&255]}-${t[r>>16&255]}${t[r>>24&255]}${t[255&i]}${t[i>>8&255]}${t[i>>16&255]}${t[i>>24&255]}`}})(),clamp:(t,e,n)=>Math.max(e,Math.min(n,t)),fmod(t,e){if(t<e)return console.error("math.fmod : Attempting to find modulus within negative range - would be infinite loop - ignoring"),t;for(;e<=t;)t-=e;return t},negateVec4:(t,e)=>(e||(e=t),e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e),addVec4:(t,e,n)=>(n||(n=t),n[0]=t[0]+e[0],n[1]=t[1]+e[1],n[2]=t[2]+e[2],n[3]=t[3]+e[3],n),addVec4Scalar:(t,e,n)=>(n||(n=t),n[0]=t[0]+e,n[1]=t[1]+e,n[2]=t[2]+e,n[3]=t[3]+e,n),addVec3:(t,e,n)=>(n||(n=t),n[0]=t[0]+e[0],n[1]=t[1]+e[1],n[2]=t[2]+e[2],n),addVec3Scalar:(t,e,n)=>(n||(n=t),n[0]=t[0]+e,n[1]=t[1]+e,n[2]=t[2]+e,n),subVec4:(t,e,n)=>(n||(n=t),n[0]=t[0]-e[0],n[1]=t[1]-e[1],n[2]=t[2]-e[2],n[3]=t[3]-e[3],n),subVec3:(t,e,n)=>(n||(n=t),n[0]=t[0]-e[0],n[1]=t[1]-e[1],n[2]=t[2]-e[2],n),subVec2:(t,e,n)=>(n||(n=t),n[0]=t[0]-e[0],n[1]=t[1]-e[1],n),subVec4Scalar:(t,e,n)=>(n||(n=t),n[0]=t[0]-e,n[1]=t[1]-e,n[2]=t[2]-e,n[3]=t[3]-e,n),subScalarVec4:(t,e,n)=>(n||(n=t),n[0]=e-t[0],n[1]=e-t[1],n[2]=e-t[2],n[3]=e-t[3],n),mulVec4:(t,e,n)=>(n||(n=t),n[0]=t[0]*e[0],n[1]=t[1]*e[1],n[2]=t[2]*e[2],n[3]=t[3]*e[3],n),mulVec4Scalar:(t,e,n)=>(n||(n=t),n[0]=t[0]*e,n[1]=t[1]*e,n[2]=t[2]*e,n[3]=t[3]*e,n),mulVec3Scalar:(t,e,n)=>(n||(n=t),n[0]=t[0]*e,n[1]=t[1]*e,n[2]=t[2]*e,n),mulVec2Scalar:(t,e,n)=>(n||(n=t),n[0]=t[0]*e,n[1]=t[1]*e,n),divVec3:(t,e,n)=>(n||(n=t),n[0]=t[0]/e[0],n[1]=t[1]/e[1],n[2]=t[2]/e[2],n),divVec4:(t,e,n)=>(n||(n=t),n[0]=t[0]/e[0],n[1]=t[1]/e[1],n[2]=t[2]/e[2],n[3]=t[3]/e[3],n),divScalarVec3:(t,e,n)=>(n||(n=e),n[0]=t/e[0],n[1]=t/e[1],n[2]=t/e[2],n),divVec3Scalar:(t,e,n)=>(n||(n=t),n[0]=t[0]/e,n[1]=t[1]/e,n[2]=t[2]/e,n),divVec4Scalar:(t,e,n)=>(n||(n=t),n[0]=t[0]/e,n[1]=t[1]/e,n[2]=t[2]/e,n[3]=t[3]/e,n),divScalarVec4:(t,e,n)=>(n||(n=e),n[0]=t/e[0],n[1]=t/e[1],n[2]=t/e[2],n[3]=t/e[3],n),dotVec4:(t,e)=>t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3],cross3Vec4(t,e){const n=t[0],r=t[1],i=t[2],a=e[0],o=e[1],s=e[2];return[r*s-i*o,i*a-n*s,n*o-r*a,0]},cross3Vec3(t,e,n){n||(n=t);const r=t[0],i=t[1],a=t[2],o=e[0],s=e[1],l=e[2];return n[0]=i*l-a*s,n[1]=a*o-r*l,n[2]=r*s-i*o,n},sqLenVec4:t=>math.dotVec4(t,t),lenVec4:t=>Math.sqrt(math.sqLenVec4(t)),dotVec3:(t,e)=>t[0]*e[0]+t[1]*e[1]+t[2]*e[2],dotVec2:(t,e)=>t[0]*e[0]+t[1]*e[1],sqLenVec3:t=>math.dotVec3(t,t),sqLenVec2:t=>math.dotVec2(t,t),lenVec3:t=>Math.sqrt(math.sqLenVec3(t)),distVec3:(()=>{const t=new FloatArrayType(3);return(e,n)=>math.lenVec3(math.subVec3(e,n,t))})(),lenVec2:t=>Math.sqrt(math.sqLenVec2(t)),distVec2:(()=>{const t=new FloatArrayType(2);return(e,n)=>math.lenVec2(math.subVec2(e,n,t))})(),rcpVec3:(t,e)=>math.divScalarVec3(1,t,e),normalizeVec4(t,e){const n=1/math.lenVec4(t);return math.mulVec4Scalar(t,n,e)},normalizeVec3(t,e){const n=1/math.lenVec3(t);return math.mulVec3Scalar(t,n,e)},normalizeVec2(t,e){const n=1/math.lenVec2(t);return math.mulVec2Scalar(t,n,e)},angleVec3(t,e){let n=math.dotVec3(t,e)/Math.sqrt(math.sqLenVec3(t)*math.sqLenVec3(e));return n=n<-1?-1:n>1?1:n,Math.acos(n)},vec3FromMat4Scale:(()=>{const t=new FloatArrayType(3);return(e,n)=>(t[0]=e[0],t[1]=e[1],t[2]=e[2],n[0]=math.lenVec3(t),t[0]=e[4],t[1]=e[5],t[2]=e[6],n[1]=math.lenVec3(t),t[0]=e[8],t[1]=e[9],t[2]=e[10],n[2]=math.lenVec3(t),n)})(),vecToArray:(()=>{function t(t){return Math.round(1e5*t)/1e5}return e=>{for(let n=0,r=(e=Array.prototype.slice.call(e)).length;n<r;n++)e[n]=t(e[n]);return e}})(),xyzArrayToObject:t=>({x:t[0],y:t[1],z:t[2]}),xyzObjectToArray:(t,e)=>((e=e||new FloatArrayType(3))[0]=t.x,e[1]=t.y,e[2]=t.z,e),dupMat4:t=>t.slice(0,16),mat4To3:t=>[t[0],t[1],t[2],t[4],t[5],t[6],t[8],t[9],t[10]],m4s:t=>[t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],setMat4ToZeroes:()=>math.m4s(0),setMat4ToOnes:()=>math.m4s(1),diagonalMat4v:t=>new FloatArrayType([t[0],0,0,0,0,t[1],0,0,0,0,t[2],0,0,0,0,t[3]]),diagonalMat4c:(t,e,n,r)=>math.diagonalMat4v([t,e,n,r]),diagonalMat4s:t=>math.diagonalMat4c(t,t,t,t),identityMat4:(t=new FloatArrayType(16))=>(t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t),identityMat3:(t=new FloatArrayType(9))=>(t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t),isIdentityMat4:t=>1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&0===t[4]&&1===t[5]&&0===t[6]&&0===t[7]&&0===t[8]&&0===t[9]&&1===t[10]&&0===t[11]&&0===t[12]&&0===t[13]&&0===t[14]&&1===t[15],negateMat4:(t,e)=>(e||(e=t),e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e[4]=-t[4],e[5]=-t[5],e[6]=-t[6],e[7]=-t[7],e[8]=-t[8],e[9]=-t[9],e[10]=-t[10],e[11]=-t[11],e[12]=-t[12],e[13]=-t[13],e[14]=-t[14],e[15]=-t[15],e),addMat4:(t,e,n)=>(n||(n=t),n[0]=t[0]+e[0],n[1]=t[1]+e[1],n[2]=t[2]+e[2],n[3]=t[3]+e[3],n[4]=t[4]+e[4],n[5]=t[5]+e[5],n[6]=t[6]+e[6],n[7]=t[7]+e[7],n[8]=t[8]+e[8],n[9]=t[9]+e[9],n[10]=t[10]+e[10],n[11]=t[11]+e[11],n[12]=t[12]+e[12],n[13]=t[13]+e[13],n[14]=t[14]+e[14],n[15]=t[15]+e[15],n),addMat4Scalar:(t,e,n)=>(n||(n=t),n[0]=t[0]+e,n[1]=t[1]+e,n[2]=t[2]+e,n[3]=t[3]+e,n[4]=t[4]+e,n[5]=t[5]+e,n[6]=t[6]+e,n[7]=t[7]+e,n[8]=t[8]+e,n[9]=t[9]+e,n[10]=t[10]+e,n[11]=t[11]+e,n[12]=t[12]+e,n[13]=t[13]+e,n[14]=t[14]+e,n[15]=t[15]+e,n),addScalarMat4:(t,e,n)=>math.addMat4Scalar(e,t,n),subMat4:(t,e,n)=>(n||(n=t),n[0]=t[0]-e[0],n[1]=t[1]-e[1],n[2]=t[2]-e[2],n[3]=t[3]-e[3],n[4]=t[4]-e[4],n[5]=t[5]-e[5],n[6]=t[6]-e[6],n[7]=t[7]-e[7],n[8]=t[8]-e[8],n[9]=t[9]-e[9],n[10]=t[10]-e[10],n[11]=t[11]-e[11],n[12]=t[12]-e[12],n[13]=t[13]-e[13],n[14]=t[14]-e[14],n[15]=t[15]-e[15],n),subMat4Scalar:(t,e,n)=>(n||(n=t),n[0]=t[0]-e,n[1]=t[1]-e,n[2]=t[2]-e,n[3]=t[3]-e,n[4]=t[4]-e,n[5]=t[5]-e,n[6]=t[6]-e,n[7]=t[7]-e,n[8]=t[8]-e,n[9]=t[9]-e,n[10]=t[10]-e,n[11]=t[11]-e,n[12]=t[12]-e,n[13]=t[13]-e,n[14]=t[14]-e,n[15]=t[15]-e,n),subScalarMat4:(t,e,n)=>(n||(n=e),n[0]=t-e[0],n[1]=t-e[1],n[2]=t-e[2],n[3]=t-e[3],n[4]=t-e[4],n[5]=t-e[5],n[6]=t-e[6],n[7]=t-e[7],n[8]=t-e[8],n[9]=t-e[9],n[10]=t-e[10],n[11]=t-e[11],n[12]=t-e[12],n[13]=t-e[13],n[14]=t-e[14],n[15]=t-e[15],n),mulMat4(t,e,n){n||(n=t);const r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],l=t[5],h=t[6],c=t[7],d=t[8],u=t[9],f=t[10],m=t[11],p=t[12],_=t[13],g=t[14],y=t[15],w=e[0],b=e[1],v=e[2],M=e[3],A=e[4],k=e[5],x=e[6],T=e[7],B=e[8],E=e[9],z=e[10],I=e[11],P=e[12],S=e[13],V=e[14],D=e[15];return n[0]=w*r+b*s+v*d+M*p,n[1]=w*i+b*l+v*u+M*_,n[2]=w*a+b*h+v*f+M*g,n[3]=w*o+b*c+v*m+M*y,n[4]=A*r+k*s+x*d+T*p,n[5]=A*i+k*l+x*u+T*_,n[6]=A*a+k*h+x*f+T*g,n[7]=A*o+k*c+x*m+T*y,n[8]=B*r+E*s+z*d+I*p,n[9]=B*i+E*l+z*u+I*_,n[10]=B*a+E*h+z*f+I*g,n[11]=B*o+E*c+z*m+I*y,n[12]=P*r+S*s+V*d+D*p,n[13]=P*i+S*l+V*u+D*_,n[14]=P*a+S*h+V*f+D*g,n[15]=P*o+S*c+V*m+D*y,n},mulMat3(t,e,n){n||(n=new FloatArrayType(9));const r=t[0],i=t[3],a=t[6],o=t[1],s=t[4],l=t[7],h=t[2],c=t[5],d=t[8],u=e[0],f=e[3],m=e[6],p=e[1],_=e[4],g=e[7],y=e[2],w=e[5],b=e[8];return n[0]=r*u+i*p+a*y,n[3]=r*f+i*_+a*w,n[6]=r*m+i*g+a*b,n[1]=o*u+s*p+l*y,n[4]=o*f+s*_+l*w,n[7]=o*m+s*g+l*b,n[2]=h*u+c*p+d*y,n[5]=h*f+c*_+d*w,n[8]=h*m+c*g+d*b,n},mulMat4Scalar:(t,e,n)=>(n||(n=t),n[0]=t[0]*e,n[1]=t[1]*e,n[2]=t[2]*e,n[3]=t[3]*e,n[4]=t[4]*e,n[5]=t[5]*e,n[6]=t[6]*e,n[7]=t[7]*e,n[8]=t[8]*e,n[9]=t[9]*e,n[10]=t[10]*e,n[11]=t[11]*e,n[12]=t[12]*e,n[13]=t[13]*e,n[14]=t[14]*e,n[15]=t[15]*e,n),mulMat4v4(t,e,n=math.vec4()){const r=e[0],i=e[1],a=e[2],o=e[3];return n[0]=t[0]*r+t[4]*i+t[8]*a+t[12]*o,n[1]=t[1]*r+t[5]*i+t[9]*a+t[13]*o,n[2]=t[2]*r+t[6]*i+t[10]*a+t[14]*o,n[3]=t[3]*r+t[7]*i+t[11]*a+t[15]*o,n},transposeMat4(t,e){const n=t[4],r=t[14],i=t[8],a=t[13],o=t[12],s=t[9];if(!e||t===e){const e=t[1],l=t[2],h=t[3],c=t[6],d=t[7],u=t[11];return t[1]=n,t[2]=i,t[3]=o,t[4]=e,t[6]=s,t[7]=a,t[8]=l,t[9]=c,t[11]=r,t[12]=h,t[13]=d,t[14]=u,t}return e[0]=t[0],e[1]=n,e[2]=i,e[3]=o,e[4]=t[1],e[5]=t[5],e[6]=s,e[7]=a,e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=r,e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15],e},transposeMat3(t,e){if(e===t){const n=t[1],r=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=r,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},determinantMat4(t){const e=t[0],n=t[1],r=t[2],i=t[3],a=t[4],o=t[5],s=t[6],l=t[7],h=t[8],c=t[9],d=t[10],u=t[11],f=t[12],m=t[13],p=t[14],_=t[15];return f*c*s*i-h*m*s*i-f*o*d*i+a*m*d*i+h*o*p*i-a*c*p*i-f*c*r*l+h*m*r*l+f*n*d*l-e*m*d*l-h*n*p*l+e*c*p*l+f*o*r*u-a*m*r*u-f*n*s*u+e*m*s*u+a*n*p*u-e*o*p*u-h*o*r*_+a*c*r*_+h*n*s*_-e*c*s*_-a*n*d*_+e*o*d*_},inverseMat4(t,e){e||(e=t);const n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6],h=t[7],c=t[8],d=t[9],u=t[10],f=t[11],m=t[12],p=t[13],_=t[14],g=t[15],y=n*s-r*o,w=n*l-i*o,b=n*h-a*o,v=r*l-i*s,M=r*h-a*s,A=i*h-a*l,k=c*p-d*m,x=c*_-u*m,T=c*g-f*m,B=d*_-u*p,E=d*g-f*p,z=u*g-f*_,I=1/(y*z-w*E+b*B+v*T-M*x+A*k);return e[0]=(s*z-l*E+h*B)*I,e[1]=(-r*z+i*E-a*B)*I,e[2]=(p*A-_*M+g*v)*I,e[3]=(-d*A+u*M-f*v)*I,e[4]=(-o*z+l*T-h*x)*I,e[5]=(n*z-i*T+a*x)*I,e[6]=(-m*A+_*b-g*w)*I,e[7]=(c*A-u*b+f*w)*I,e[8]=(o*E-s*T+h*k)*I,e[9]=(-n*E+r*T-a*k)*I,e[10]=(m*M-p*b+g*y)*I,e[11]=(-c*M+d*b-f*y)*I,e[12]=(-o*B+s*x-l*k)*I,e[13]=(n*B-r*x+i*k)*I,e[14]=(-m*v+p*w-_*y)*I,e[15]=(c*v-d*w+u*y)*I,e},traceMat4:t=>t[0]+t[5]+t[10]+t[15],translationMat4v(t,e){const n=e||math.identityMat4();return n[12]=t[0],n[13]=t[1],n[14]=t[2],n},translationMat3v(t,e){const n=e||math.identityMat3();return n[6]=t[0],n[7]=t[1],n},translationMat4c:(()=>{const t=new FloatArrayType(3);return(e,n,r,i)=>(t[0]=e,t[1]=n,t[2]=r,math.translationMat4v(t,i))})(),translationMat4s:(t,e)=>math.translationMat4c(t,t,t,e),translateMat4v:(t,e)=>math.translateMat4c(t[0],t[1],t[2],e),OLDtranslateMat4c(t,e,n,r){const i=r[12];r[0]+=i*t,r[4]+=i*e,r[8]+=i*n;const a=r[13];r[1]+=a*t,r[5]+=a*e,r[9]+=a*n;const o=r[14];r[2]+=o*t,r[6]+=o*e,r[10]+=o*n;const s=r[15];return r[3]+=s*t,r[7]+=s*e,r[11]+=s*n,r},translateMat4c(t,e,n,r){const i=r[3];r[0]+=i*t,r[1]+=i*e,r[2]+=i*n;const a=r[7];r[4]+=a*t,r[5]+=a*e,r[6]+=a*n;const o=r[11];r[8]+=o*t,r[9]+=o*e,r[10]+=o*n;const s=r[15];return r[12]+=s*t,r[13]+=s*e,r[14]+=s*n,r},rotationMat4v(t,e,n){const r=math.normalizeVec4([e[0],e[1],e[2],0],[]),i=Math.sin(t),a=Math.cos(t),o=1-a,s=r[0],l=r[1],h=r[2];let c,d,u,f,m,p;return c=s*l,d=l*h,u=h*s,f=s*i,m=l*i,p=h*i,(n=n||math.mat4())[0]=o*s*s+a,n[1]=o*c+p,n[2]=o*u-m,n[3]=0,n[4]=o*c-p,n[5]=o*l*l+a,n[6]=o*d+f,n[7]=0,n[8]=o*u+m,n[9]=o*d-f,n[10]=o*h*h+a,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},rotationMat4c:(t,e,n,r,i)=>math.rotationMat4v(t,[e,n,r],i),scalingMat4v:(t,e=math.identityMat4())=>(e[0]=t[0],e[5]=t[1],e[10]=t[2],e),scalingMat3v:(t,e=math.identityMat3())=>(e[0]=t[0],e[4]=t[1],e),scalingMat4c:(()=>{const t=new FloatArrayType(3);return(e,n,r,i)=>(t[0]=e,t[1]=n,t[2]=r,math.scalingMat4v(t,i))})(),scaleMat4c:(t,e,n,r)=>(r[0]*=t,r[4]*=e,r[8]*=n,r[1]*=t,r[5]*=e,r[9]*=n,r[2]*=t,r[6]*=e,r[10]*=n,r[3]*=t,r[7]*=e,r[11]*=n,r),scaleMat4v(t,e){const n=t[0],r=t[1],i=t[2];return e[0]*=n,e[4]*=r,e[8]*=i,e[1]*=n,e[5]*=r,e[9]*=i,e[2]*=n,e[6]*=r,e[10]*=i,e[3]*=n,e[7]*=r,e[11]*=i,e},scalingMat4s:t=>math.scalingMat4c(t,t,t),rotationTranslationMat4(t,e,n=math.mat4()){const r=t[0],i=t[1],a=t[2],o=t[3],s=r+r,l=i+i,h=a+a,c=r*s,d=r*l,u=r*h,f=i*l,m=i*h,p=a*h,_=o*s,g=o*l,y=o*h;return n[0]=1-(f+p),n[1]=d+y,n[2]=u-g,n[3]=0,n[4]=d-y,n[5]=1-(c+p),n[6]=m+_,n[7]=0,n[8]=u+g,n[9]=m-_,n[10]=1-(c+f),n[11]=0,n[12]=e[0],n[13]=e[1],n[14]=e[2],n[15]=1,n},mat4ToEuler(t,e,n=math.vec4()){const r=math.clamp,i=t[0],a=t[4],o=t[8],s=t[1],l=t[5],h=t[9],c=t[2],d=t[6],u=t[10];return"XYZ"===e?(n[1]=Math.asin(r(o,-1,1)),Math.abs(o)<.99999?(n[0]=Math.atan2(-h,u),n[2]=Math.atan2(-a,i)):(n[0]=Math.atan2(d,l),n[2]=0)):"YXZ"===e?(n[0]=Math.asin(-r(h,-1,1)),Math.abs(h)<.99999?(n[1]=Math.atan2(o,u),n[2]=Math.atan2(s,l)):(n[1]=Math.atan2(-c,i),n[2]=0)):"ZXY"===e?(n[0]=Math.asin(r(d,-1,1)),Math.abs(d)<.99999?(n[1]=Math.atan2(-c,u),n[2]=Math.atan2(-a,l)):(n[1]=0,n[2]=Math.atan2(s,i))):"ZYX"===e?(n[1]=Math.asin(-r(c,-1,1)),Math.abs(c)<.99999?(n[0]=Math.atan2(d,u),n[2]=Math.atan2(s,i)):(n[0]=0,n[2]=Math.atan2(-a,l))):"YZX"===e?(n[2]=Math.asin(r(s,-1,1)),Math.abs(s)<.99999?(n[0]=Math.atan2(-h,l),n[1]=Math.atan2(-c,i)):(n[0]=0,n[1]=Math.atan2(o,u))):"XZY"===e&&(n[2]=Math.asin(-r(a,-1,1)),Math.abs(a)<.99999?(n[0]=Math.atan2(d,l),n[1]=Math.atan2(o,i)):(n[0]=Math.atan2(-h,u),n[1]=0)),n},composeMat4:(t,e,n,r=math.mat4())=>(math.quaternionToRotationMat4(e,r),math.scaleMat4v(n,r),math.translateMat4v(t,r),r),decomposeMat4:(()=>{const t=new FloatArrayType(3),e=new FloatArrayType(16);return function(n,r,i,a){t[0]=n[0],t[1]=n[1],t[2]=n[2];let o=math.lenVec3(t);t[0]=n[4],t[1]=n[5],t[2]=n[6];const s=math.lenVec3(t);t[8]=n[8],t[9]=n[9],t[10]=n[10];const l=math.lenVec3(t);math.determinantMat4(n)<0&&(o=-o),r[0]=n[12],r[1]=n[13],r[2]=n[14],e.set(n);const h=1/o,c=1/s,d=1/l;return e[0]*=h,e[1]*=h,e[2]*=h,e[4]*=c,e[5]*=c,e[6]*=c,e[8]*=d,e[9]*=d,e[10]*=d,math.mat4ToQuaternion(e,i),a[0]=o,a[1]=s,a[2]=l,this}})(),lookAtMat4v(t,e,n,r){r||(r=math.mat4());const i=t[0],a=t[1],o=t[2],s=n[0],l=n[1],h=n[2],c=e[0],d=e[1],u=e[2];if(i===c&&a===d&&o===u)return math.identityMat4();let f,m,p,_,g,y,w,b,v,M;return f=i-c,m=a-d,p=o-u,_=l*(p*=M=1/Math.sqrt(f*f+m*m+p*p))-h*(m*=M),g=h*(f*=M)-s*p,y=s*m-l*f,(M=Math.sqrt(_*_+g*g+y*y))?(_*=M=1/M,g*=M,y*=M):(_=0,g=0,y=0),w=m*y-p*g,b=p*_-f*y,v=f*g-m*_,(M=Math.sqrt(w*w+b*b+v*v))?(w*=M=1/M,b*=M,v*=M):(w=0,b=0,v=0),r[0]=_,r[1]=w,r[2]=f,r[3]=0,r[4]=g,r[5]=b,r[6]=m,r[7]=0,r[8]=y,r[9]=v,r[10]=p,r[11]=0,r[12]=-(_*i+g*a+y*o),r[13]=-(w*i+b*a+v*o),r[14]=-(f*i+m*a+p*o),r[15]=1,r},lookAtMat4c:(t,e,n,r,i,a,o,s,l)=>math.lookAtMat4v([t,e,n],[r,i,a],[o,s,l],[]),orthoMat4c(t,e,n,r,i,a,o){o||(o=math.mat4());const s=e-t,l=r-n,h=a-i;return o[0]=2/s,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2/l,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=-2/h,o[11]=0,o[12]=-(t+e)/s,o[13]=-(r+n)/l,o[14]=-(a+i)/h,o[15]=1,o},frustumMat4v(t,e,n){n||(n=math.mat4());const r=[t[0],t[1],t[2],0],i=[e[0],e[1],e[2],0];math.addVec4(i,r,tempMat1),math.subVec4(i,r,tempMat2);const a=2*r[2],o=tempMat2[0],s=tempMat2[1],l=tempMat2[2];return n[0]=a/o,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=a/s,n[6]=0,n[7]=0,n[8]=tempMat1[0]/o,n[9]=tempMat1[1]/s,n[10]=-tempMat1[2]/l,n[11]=-1,n[12]=0,n[13]=0,n[14]=-a*i[2]/l,n[15]=0,n},frustumMat4(t,e,n,r,i,a,o){o||(o=math.mat4());const s=e-t,l=r-n,h=a-i;return o[0]=2*i/s,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2*i/l,o[6]=0,o[7]=0,o[8]=(e+t)/s,o[9]=(r+n)/l,o[10]=-(a+i)/h,o[11]=-1,o[12]=0,o[13]=0,o[14]=-a*i*2/h,o[15]=0,o},perspectiveMat4(t,e,n,r,i){const a=[],o=[];return a[2]=n,o[2]=r,o[1]=a[2]*Math.tan(t/2),a[1]=-o[1],o[0]=o[1]*e,a[0]=-o[0],math.frustumMat4v(a,o,i)},transformPoint3(t,e,n=math.vec3()){const r=e[0],i=e[1],a=e[2];return n[0]=t[0]*r+t[4]*i+t[8]*a+t[12],n[1]=t[1]*r+t[5]*i+t[9]*a+t[13],n[2]=t[2]*r+t[6]*i+t[10]*a+t[14],n},transformPoint4:(t,e,n=math.vec4())=>(n[0]=t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12]*e[3],n[1]=t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13]*e[3],n[2]=t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14]*e[3],n[3]=t[3]*e[0]+t[7]*e[1]+t[11]*e[2]+t[15]*e[3],n),transformPoints3(t,e,n){const r=n||[],i=e.length;let a,o,s,l;const h=t[0],c=t[1],d=t[2],u=t[3],f=t[4],m=t[5],p=t[6],_=t[7],g=t[8],y=t[9],w=t[10],b=t[11],v=t[12],M=t[13],A=t[14],k=t[15];let x;for(let t=0;t<i;++t)a=(l=e[t])[0],o=l[1],s=l[2],(x=r[t]||(r[t]=[0,0,0]))[0]=h*a+f*o+g*s+v,x[1]=c*a+m*o+y*s+M,x[2]=d*a+p*o+w*s+A,x[3]=u*a+_*o+b*s+k;return r.length=i,r},transformPositions3(t,e,n=e){let r;const i=e.length;let a,o,s;const l=t[0],h=t[1],c=t[2],d=t[3],u=t[4],f=t[5],m=t[6],p=t[7],_=t[8],g=t[9],y=t[10],w=t[11],b=t[12],v=t[13],M=t[14],A=t[15];for(r=0;r<i;r+=3)a=e[r+0],o=e[r+1],s=e[r+2],n[r+0]=l*a+u*o+_*s+b,n[r+1]=h*a+f*o+g*s+v,n[r+2]=c*a+m*o+y*s+M,n[r+3]=d*a+p*o+w*s+A;return n},transformPositions4(t,e,n=e){let r;const i=e.length;let a,o,s;const l=t[0],h=t[1],c=t[2],d=t[3],u=t[4],f=t[5],m=t[6],p=t[7],_=t[8],g=t[9],y=t[10],w=t[11],b=t[12],v=t[13],M=t[14],A=t[15];for(r=0;r<i;r+=4)a=e[r+0],o=e[r+1],s=e[r+2],n[r+0]=l*a+u*o+_*s+b,n[r+1]=h*a+f*o+g*s+v,n[r+2]=c*a+m*o+y*s+M,n[r+3]=d*a+p*o+w*s+A;return n},transformVec3(t,e,n){const r=e[0],i=e[1],a=e[2];return(n=n||this.vec3())[0]=t[0]*r+t[4]*i+t[8]*a,n[1]=t[1]*r+t[5]*i+t[9]*a,n[2]=t[2]*r+t[6]*i+t[10]*a,n},transformVec4(t,e,n){const r=e[0],i=e[1],a=e[2],o=e[3];return(n=n||math.vec4())[0]=t[0]*r+t[4]*i+t[8]*a+t[12]*o,n[1]=t[1]*r+t[5]*i+t[9]*a+t[13]*o,n[2]=t[2]*r+t[6]*i+t[10]*a+t[14]*o,n[3]=t[3]*r+t[7]*i+t[11]*a+t[15]*o,n},rotateVec3X(t,e,n,r){const i=[],a=[];return i[0]=t[0]-e[0],i[1]=t[1]-e[1],i[2]=t[2]-e[2],a[0]=i[0],a[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),a[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),r[0]=a[0]+e[0],r[1]=a[1]+e[1],r[2]=a[2]+e[2],r},rotateVec3Y(t,e,n,r){const i=[],a=[];return i[0]=t[0]-e[0],i[1]=t[1]-e[1],i[2]=t[2]-e[2],a[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),a[1]=i[1],a[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),r[0]=a[0]+e[0],r[1]=a[1]+e[1],r[2]=a[2]+e[2],r},rotateVec3Z(t,e,n,r){const i=[],a=[];return i[0]=t[0]-e[0],i[1]=t[1]-e[1],i[2]=t[2]-e[2],a[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),a[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),a[2]=i[2],r[0]=a[0]+e[0],r[1]=a[1]+e[1],r[2]=a[2]+e[2],r},projectVec4(t,e){const n=1/t[3];return(e=e||math.vec2())[0]=v[0]*n,e[1]=v[1]*n,e},unprojectVec3:(()=>{const t=new FloatArrayType(16),e=new FloatArrayType(16),n=new FloatArrayType(16);return function(r,i,a,o){return this.transformVec3(this.mulMat4(this.inverseMat4(i,t),this.inverseMat4(a,e),n),r,o)}})(),lerpVec3(t,e,n,r,i,a){const o=a||math.vec3(),s=(t-e)/(n-e);return o[0]=r[0]+s*(i[0]-r[0]),o[1]=r[1]+s*(i[1]-r[1]),o[2]=r[2]+s*(i[2]-r[2]),o},flatten(t){const e=[];let n,r,i,a,o;for(n=0,r=t.length;n<r;n++)for(i=0,a=(o=t[n]).length;i<a;i++)e.push(o[i]);return e},identityQuaternion:(t=math.vec4())=>(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t),eulerToQuaternion(t,e,n=math.vec4()){const r=t[0]*math.DEGTORAD/2,i=t[1]*math.DEGTORAD/2,a=t[2]*math.DEGTORAD/2,o=Math.cos(r),s=Math.cos(i),l=Math.cos(a),h=Math.sin(r),c=Math.sin(i),d=Math.sin(a);return"XYZ"===e?(n[0]=h*s*l+o*c*d,n[1]=o*c*l-h*s*d,n[2]=o*s*d+h*c*l,n[3]=o*s*l-h*c*d):"YXZ"===e?(n[0]=h*s*l+o*c*d,n[1]=o*c*l-h*s*d,n[2]=o*s*d-h*c*l,n[3]=o*s*l+h*c*d):"ZXY"===e?(n[0]=h*s*l-o*c*d,n[1]=o*c*l+h*s*d,n[2]=o*s*d+h*c*l,n[3]=o*s*l-h*c*d):"ZYX"===e?(n[0]=h*s*l-o*c*d,n[1]=o*c*l+h*s*d,n[2]=o*s*d-h*c*l,n[3]=o*s*l+h*c*d):"YZX"===e?(n[0]=h*s*l+o*c*d,n[1]=o*c*l+h*s*d,n[2]=o*s*d-h*c*l,n[3]=o*s*l-h*c*d):"XZY"===e&&(n[0]=h*s*l-o*c*d,n[1]=o*c*l-h*s*d,n[2]=o*s*d+h*c*l,n[3]=o*s*l+h*c*d),n},mat4ToQuaternion(t,e=math.vec4()){const n=t[0],r=t[4],i=t[8],a=t[1],o=t[5],s=t[9],l=t[2],h=t[6],c=t[10];let d;const u=n+o+c;return u>0?(d=.5/Math.sqrt(u+1),e[3]=.25/d,e[0]=(h-s)*d,e[1]=(i-l)*d,e[2]=(a-r)*d):n>o&&n>c?(d=2*Math.sqrt(1+n-o-c),e[3]=(h-s)/d,e[0]=.25*d,e[1]=(r+a)/d,e[2]=(i+l)/d):o>c?(d=2*Math.sqrt(1+o-n-c),e[3]=(i-l)/d,e[0]=(r+a)/d,e[1]=.25*d,e[2]=(s+h)/d):(d=2*Math.sqrt(1+c-n-o),e[3]=(a-r)/d,e[0]=(i+l)/d,e[1]=(s+h)/d,e[2]=.25*d),e},vec3PairToQuaternion(t,e,n=math.vec4()){const r=Math.sqrt(math.dotVec3(t,t)*math.dotVec3(e,e));let i=r+math.dotVec3(t,e);return i<1e-8*r?(i=0,Math.abs(t[0])>Math.abs(t[2])?(n[0]=-t[1],n[1]=t[0],n[2]=0):(n[0]=0,n[1]=-t[2],n[2]=t[1])):math.cross3Vec3(t,e,n),n[3]=i,math.normalizeQuaternion(n)},angleAxisToQuaternion(t,e=math.vec4()){const n=t[3]/2,r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e},quaternionToEuler:(()=>{const t=new FloatArrayType(16);return(e,n,r)=>(r=r||math.vec3(),math.quaternionToRotationMat4(e,t),math.mat4ToEuler(t,n,r),r)})(),mulQuaternions(t,e,n=math.vec4()){const r=t[0],i=t[1],a=t[2],o=t[3],s=e[0],l=e[1],h=e[2],c=e[3];return n[0]=o*s+r*c+i*h-a*l,n[1]=o*l+i*c+a*s-r*h,n[2]=o*h+a*c+r*l-i*s,n[3]=o*c-r*s-i*l-a*h,n},vec3ApplyQuaternion(t,e,n=math.vec3()){const r=e[0],i=e[1],a=e[2],o=t[0],s=t[1],l=t[2],h=t[3],c=h*r+s*a-l*i,d=h*i+l*r-o*a,u=h*a+o*i-s*r,f=-o*r-s*i-l*a;return n[0]=c*h+f*-o+d*-l-u*-s,n[1]=d*h+f*-s+u*-o-c*-l,n[2]=u*h+f*-l+c*-s-d*-o,n},quaternionToMat4(t,e){e=math.identityMat4(e);const n=t[0],r=t[1],i=t[2],a=t[3],o=2*n,s=2*r,l=2*i,h=o*a,c=s*a,d=l*a,u=o*n,f=s*n,m=l*n,p=s*r,_=l*r,g=l*i;return e[0]=1-(p+g),e[1]=f+d,e[2]=m-c,e[4]=f-d,e[5]=1-(u+g),e[6]=_+h,e[8]=m+c,e[9]=_-h,e[10]=1-(u+p),e},quaternionToRotationMat4(t,e){const n=t[0],r=t[1],i=t[2],a=t[3],o=n+n,s=r+r,l=i+i,h=n*o,c=n*s,d=n*l,u=r*s,f=r*l,m=i*l,p=a*o,_=a*s,g=a*l;return e[0]=1-(u+m),e[4]=c-g,e[8]=d+_,e[1]=c+g,e[5]=1-(h+m),e[9]=f-p,e[2]=d-_,e[6]=f+p,e[10]=1-(h+u),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},normalizeQuaternion(t,e=t){const n=math.lenVec4([t[0],t[1],t[2],t[3]]);return e[0]=t[0]/n,e[1]=t[1]/n,e[2]=t[2]/n,e[3]=t[3]/n,e},conjugateQuaternion:(t,e=t)=>(e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e),inverseQuaternion:(t,e)=>math.normalizeQuaternion(math.conjugateQuaternion(t,e)),quaternionToAngleAxis(t,e=math.vec4()){const n=(t=math.normalizeQuaternion(t,tempVec4))[3],r=2*Math.acos(n),i=Math.sqrt(1-n*n);return i<.001?(e[0]=t[0],e[1]=t[1],e[2]=t[2]):(e[0]=t[0]/i,e[1]=t[1]/i,e[2]=t[2]/i),e[3]=r,e},AABB3:t=>new FloatArrayType(t||6),AABB2:t=>new FloatArrayType(t||4),OBB3:t=>new FloatArrayType(t||32),OBB2:t=>new FloatArrayType(t||16),Sphere3:(t,e,n,r)=>new FloatArrayType([t,e,n,r]),transformOBB3(t,e,n=e){let r;const i=e.length;let a,o,s;const l=t[0],h=t[1],c=t[2],d=t[3],u=t[4],f=t[5],m=t[6],p=t[7],_=t[8],g=t[9],y=t[10],w=t[11],b=t[12],v=t[13],M=t[14],A=t[15];for(r=0;r<i;r+=4)a=e[r+0],o=e[r+1],s=e[r+2],n[r+0]=l*a+u*o+_*s+b,n[r+1]=h*a+f*o+g*s+v,n[r+2]=c*a+m*o+y*s+M,n[r+3]=d*a+p*o+w*s+A;return n},containsAABB3:function(t,e){return t[0]<=e[0]&&e[3]<=t[3]&&t[1]<=e[1]&&e[4]<=t[4]&&t[2]<=e[2]&&e[5]<=t[5]},getAABB3Diag:(()=>{const t=new FloatArrayType(3),e=new FloatArrayType(3),n=new FloatArrayType(3);return r=>(t[0]=r[0],t[1]=r[1],t[2]=r[2],e[0]=r[3],e[1]=r[4],e[2]=r[5],math.subVec3(e,t,n),Math.abs(math.lenVec3(n)))})(),getAABB3DiagPoint:(()=>{const t=new FloatArrayType(3),e=new FloatArrayType(3),n=new FloatArrayType(3);return(r,i)=>{t[0]=r[0],t[1]=r[1],t[2]=r[2],e[0]=r[3],e[1]=r[4],e[2]=r[5];const a=math.subVec3(e,t,n),o=i[0]-r[0],s=r[3]-i[0],l=i[1]-r[1],h=r[4]-i[1],c=i[2]-r[2],d=r[5]-i[2];return a[0]+=o>s?o:s,a[1]+=l>h?l:h,a[2]+=c>d?c:d,Math.abs(math.lenVec3(a))}})(),getAABB3Center(t,e){const n=e||math.vec3();return n[0]=(t[0]+t[3])/2,n[1]=(t[1]+t[4])/2,n[2]=(t[2]+t[5])/2,n},getAABB2Center(t,e){const n=e||math.vec2();return n[0]=(t[2]+t[0])/2,n[1]=(t[3]+t[1])/2,n},collapseAABB3:(t=math.AABB3())=>(t[0]=math.MAX_DOUBLE,t[1]=math.MAX_DOUBLE,t[2]=math.MAX_DOUBLE,t[3]=-math.MAX_DOUBLE,t[4]=-math.MAX_DOUBLE,t[5]=-math.MAX_DOUBLE,t),AABB3ToOBB3:(t,e=math.OBB3())=>(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=1,e[4]=t[3],e[5]=t[1],e[6]=t[2],e[7]=1,e[8]=t[3],e[9]=t[4],e[10]=t[2],e[11]=1,e[12]=t[0],e[13]=t[4],e[14]=t[2],e[15]=1,e[16]=t[0],e[17]=t[1],e[18]=t[5],e[19]=1,e[20]=t[3],e[21]=t[1],e[22]=t[5],e[23]=1,e[24]=t[3],e[25]=t[4],e[26]=t[5],e[27]=1,e[28]=t[0],e[29]=t[4],e[30]=t[5],e[31]=1,e),positions3ToAABB3:(()=>{const t=new FloatArrayType(3);return(e,n,r)=>{n=n||math.AABB3();let i,a,o,s=math.MAX_DOUBLE,l=math.MAX_DOUBLE,h=math.MAX_DOUBLE,c=-math.MAX_DOUBLE,d=-math.MAX_DOUBLE,u=-math.MAX_DOUBLE;for(let n=0,f=e.length;n<f;n+=3)r?(t[0]=e[n+0],t[1]=e[n+1],t[2]=e[n+2],math.decompressPosition(t,r,t),i=t[0],a=t[1],o=t[2]):(i=e[n+0],a=e[n+1],o=e[n+2]),i<s&&(s=i),a<l&&(l=a),o<h&&(h=o),i>c&&(c=i),a>d&&(d=a),o>u&&(u=o);return n[0]=s,n[1]=l,n[2]=h,n[3]=c,n[4]=d,n[5]=u,n}})(),OBB3ToAABB3(t,e=math.AABB3()){let n,r,i,a=math.MAX_DOUBLE,o=math.MAX_DOUBLE,s=math.MAX_DOUBLE,l=-math.MAX_DOUBLE,h=-math.MAX_DOUBLE,c=-math.MAX_DOUBLE;for(let e=0,d=t.length;e<d;e+=4)n=t[e+0],r=t[e+1],i=t[e+2],n<a&&(a=n),r<o&&(o=r),i<s&&(s=i),n>l&&(l=n),r>h&&(h=r),i>c&&(c=i);return e[0]=a,e[1]=o,e[2]=s,e[3]=l,e[4]=h,e[5]=c,e},points3ToAABB3(t,e=math.AABB3()){let n,r,i,a=math.MAX_DOUBLE,o=math.MAX_DOUBLE,s=math.MAX_DOUBLE,l=-math.MAX_DOUBLE,h=-math.MAX_DOUBLE,c=-math.MAX_DOUBLE;for(let e=0,d=t.length;e<d;e++)n=t[e][0],r=t[e][1],i=t[e][2],n<a&&(a=n),r<o&&(o=r),i<s&&(s=i),n>l&&(l=n),r>h&&(h=r),i>c&&(c=i);return e[0]=a,e[1]=o,e[2]=s,e[3]=l,e[4]=h,e[5]=c,e},points3ToSphere3:(()=>{const t=new FloatArrayType(3);return(e,n)=>{n=n||math.vec4();let r,i=0,a=0,o=0;const s=e.length;for(r=0;r<s;r++)i+=e[r][0],a+=e[r][1],o+=e[r][2];n[0]=i/s,n[1]=a/s,n[2]=o/s;let l,h=0;for(r=0;r<s;r++)(l=Math.abs(math.lenVec3(math.subVec3(e[r],n,t))))>h&&(h=l);return n[3]=h,n}})(),positions3ToSphere3:(()=>{const t=new FloatArrayType(3),e=new FloatArrayType(3);return(n,r)=>{r=r||math.vec4();let i,a=0,o=0,s=0;const l=n.length;let h=0;for(i=0;i<l;i+=3)a+=n[i],o+=n[i+1],s+=n[i+2];const c=l/3;let d;for(r[0]=a/c,r[1]=o/c,r[2]=s/c,i=0;i<l;i+=3)t[0]=n[i],t[1]=n[i+1],t[2]=n[i+2],(d=Math.abs(math.lenVec3(math.subVec3(t,r,e))))>h&&(h=d);return r[3]=h,r}})(),OBB3ToSphere3:(()=>{const t=new FloatArrayType(3),e=new FloatArrayType(3);return(n,r)=>{r=r||math.vec4();let i,a=0,o=0,s=0;const l=n.length,h=l/4;for(i=0;i<l;i+=4)a+=n[i+0],o+=n[i+1],s+=n[i+2];r[0]=a/h,r[1]=o/h,r[2]=s/h;let c,d=0;for(i=0;i<l;i+=4)t[0]=n[i+0],t[1]=n[i+1],t[2]=n[i+2],(c=Math.abs(math.lenVec3(math.subVec3(t,r,e))))>d&&(d=c);return r[3]=d,r}})(),getSphere3Center:(t,e=math.vec3())=>(e[0]=t[0],e[1]=t[1],e[2]=t[2],e),expandAABB3:(t,e)=>(t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]>e[2]&&(t[2]=e[2]),t[3]<e[3]&&(t[3]=e[3]),t[4]<e[4]&&(t[4]=e[4]),t[5]<e[5]&&(t[5]=e[5]),t),expandAABB3Point3:(t,e)=>(t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]>e[2]&&(t[2]=e[2]),t[3]<e[0]&&(t[3]=e[0]),t[4]<e[1]&&(t[4]=e[1]),t[5]<e[2]&&(t[5]=e[2]),t)};var quantizePositions=function(t,e,n,r){const i=n[0],a=n[1],o=n[2],s=65535/(n[3]-i),l=65535/(n[4]-a),h=65535/(n[5]-o);let c;for(c=0;c<e;c+=3)r[c+0]=Math.floor((t[c+0]-i)*s),r[c+1]=Math.floor((t[c+1]-a)*l),r[c+2]=Math.floor((t[c+2]-o)*h)},createPositionsDecodeMatrix=function(){const t=math.mat4(),e=math.mat4();return function(n,r){r=r||math.mat4();const i=n[0],a=n[1],o=n[2],s=n[3]-i,l=n[4]-a,h=n[5]-o;return math.identityMat4(t),math.translationMat4v(n,t),math.identityMat4(e),math.scalingMat4v([s/65535,l/65535,h/65535],e),math.mulMat4(t,e,r),r}}();function transformAndOctEncodeNormals(t,e,n,r,i){let a,o,s,l,h,c,d=math.vec3(),u=math.vec3();for(c=0;c<n;c+=3)d[0]=e[c],d[1]=e[c+1],d[2]=e[c+2],math.transformVec3(t,d,u),math.normalizeVec3(u,u),s=a=octEncodeVec3(u,0,"floor","floor"),l=h=dot(u,0,o=octDecodeVec2(a)),(l=dot(u,0,o=octDecodeVec2(a=octEncodeVec3(u,0,"ceil","floor"))))>h&&(s=a,h=l),(l=dot(u,0,o=octDecodeVec2(a=octEncodeVec3(u,0,"floor","ceil"))))>h&&(s=a,h=l),(l=dot(u,0,o=octDecodeVec2(a=octEncodeVec3(u,0,"ceil","ceil"))))>h&&(s=a,h=l),r[i+c+0]=s[0],r[i+c+1]=s[1],r[i+c+2]=0;return i+=n}function octEncodeNormals(t,e,n,r){let i,a,o,s,l;for(let h=0;h<e;h+=3)o=i=octEncodeVec3(t,h,"floor","floor"),s=l=dot(t,h,a=octDecodeVec2(i)),(s=dot(t,h,a=octDecodeVec2(i=octEncodeVec3(t,h,"ceil","floor"))))>l&&(o=i,l=s),(s=dot(t,h,a=octDecodeVec2(i=octEncodeVec3(t,h,"floor","ceil"))))>l&&(o=i,l=s),(s=dot(t,h,a=octDecodeVec2(i=octEncodeVec3(t,h,"ceil","ceil"))))>l&&(o=i,l=s),n[r+h+0]=o[0],n[r+h+1]=o[1],n[r+h+2]=0;return r+=e}function octEncodeVec3(t,e,n,r){let i=t[e]/(Math.abs(t[e])+Math.abs(t[e+1])+Math.abs(t[e+2])),a=t[e+1]/(Math.abs(t[e])+Math.abs(t[e+1])+Math.abs(t[e+2]));if(t[e+2]<0){let t=(1-Math.abs(a))*(i>=0?1:-1),e=(1-Math.abs(i))*(a>=0?1:-1);i=t,a=e}return new Int8Array([Math[n](127.5*i+(i<0?-1:0)),Math[r](127.5*a+(a<0?-1:0))])}function octDecodeVec2(t){let e=t[0],n=t[1];e/=e<0?127:128,n/=n<0?127:128;const r=1-Math.abs(e)-Math.abs(n);r<0&&(e=(1-Math.abs(n))*(e>=0?1:-1),n=(1-Math.abs(e))*(n>=0?1:-1));const i=Math.sqrt(e*e+n*n+r*r);return[e/i,n/i,r/i]}function dot(t,e,n){return t[e]*n[0]+t[e+1]*n[1]+t[e+2]*n[2]}const geometryCompression={quantizePositions:quantizePositions,createPositionsDecodeMatrix:createPositionsDecodeMatrix,transformAndOctEncodeNormals:transformAndOctEncodeNormals,octEncodeNormals:octEncodeNormals},buildEdgeIndices=function(){const t=[],e=[],n=[],r=[],i=[];let a=0;const o=new Uint16Array(3),s=new Uint16Array(3),l=new Uint16Array(3),h=math.vec3(),c=math.vec3(),d=math.vec3(),u=math.vec3(),f=math.vec3(),m=math.vec3(),p=math.vec3();return function(_,g,y,w){!function(i,a){const o={};let s,l,h,c;const d=Math.pow(10,4);let u,f,m=0;for(u=0,f=i.length;u<f;u+=3)s=i[u],l=i[u+1],h=i[u+2],void 0===o[c=Math.round(s*d)+"_"+Math.round(l*d)+"_"+Math.round(h*d)]&&(o[c]=m/3,t[m++]=s,t[m++]=l,t[m++]=h),e[u/3]=o[c];for(u=0,f=a.length;u<f;u++)r[u]=e[a[u]],n[r[u]]=a[u]}(_,g),function(e,n){a=0;for(let _=0,g=e;_<g;_+=3){const e=3*r[_],g=3*r[_+1],y=3*r[_+2];n?(o[0]=t[e],o[1]=t[e+1],o[2]=t[e+2],s[0]=t[g],s[1]=t[g+1],s[2]=t[g+2],l[0]=t[y],l[1]=t[y+1],l[2]=t[y+2],math.decompressPosition(o,n,h),math.decompressPosition(s,n,c),math.decompressPosition(l,n,d)):(h[0]=t[e],h[1]=t[e+1],h[2]=t[e+2],c[0]=t[g],c[1]=t[g+1],c[2]=t[g+2],d[0]=t[y],d[1]=t[y+1],d[2]=t[y+2]),math.subVec3(d,c,u),math.subVec3(h,c,f),math.cross3Vec3(u,f,m),math.normalizeVec3(m,p);const w=i[a]||(i[a]={normal:math.vec3()});w.normal[0]=p[0],w.normal[1]=p[1],w.normal[2]=p[2],a++}}(g.length,y);const b=[],v=Math.cos(math.DEGTORAD*w),M={};let A,k,x,T,B,E,z,I,P,S,V,D=!1;for(let t=0,e=g.length;t<e;t+=3){const e=t/3;for(let n=0;n<3;n++)A=r[t+n],k=r[t+(n+1)%3],void 0===M[B=(x=Math.min(A,k))+","+(T=Math.max(A,k))]?M[B]={index1:x,index2:T,face1:e,face2:void 0}:M[B].face2=e}for(B in M)void 0!==(E=M[B]).face2&&(z=i[E.face1].normal,I=i[E.face2].normal,(P=math.dotVec3(z,I))>v)||(S=n[E.index1],V=n[E.index2],(!D&&S>65535||V>65535)&&(D=!0),b.push(S),b.push(V));return D?new Uint32Array(b):new Uint16Array(b)}}(),isTriangleMeshSolid=(t,e)=>{let n=0;const r={},i=[],a={};for(let a=0,o=t.length;a<o;a++){const o=t[a],s=e[3*o]+","+e[3*o+1]+","+e[3*o+2];let l=r[s];void 0===l&&(l=n++),i[a]=l,r[s]=l}for(let t=0,e=i.length;t<e;t+=3){const e=i[t],n=i[t+1],r=i[t+2];let o=e,s=n,l=r;e>n&&e>r?n>r?(o=e,s=n,l=r):(o=e,s=r,l=n):n>e&&n>r?e>r?(o=n,s=e,l=r):(o=n,s=r,l=e):r>e&&r>n&&(e>n?(o=r,s=e,l=n):(o=r,s=n,l=e));let h=o+"-"+s,c=a[h];if(a[h]=void 0===c?1:c+1,c=a[h=s+"-"+l],a[h]=void 0===c?1:c+1,o>l){const t=l;l=o,o=t}c=a[h=l+"-"+o],a[h]=void 0===c?1:c+1}for(let t in a)if(2!==a[t])return!1;return!0};class XKTMesh{constructor(t){this.meshId=t.meshId,this.meshIndex=t.meshIndex,this.matrix=t.matrix,this.geometry=t.geometry,this.color=t.color||new Uint8Array(3),this.metallic=null!==t.metallic&&void 0!==t.metallic?t.metallic:0,this.roughness=null!==t.roughness&&void 0!==t.roughness?t.roughness:1,this.opacity=void 0!==t.opacity&&null!==t.opacity?t.opacity:1,this.entity=null}}class XKTGeometry{constructor(t){this.geometryId=t.geometryId,this.primitiveType=t.primitiveType,this.geometryIndex=t.geometryIndex,this.numInstances=0,this.positions=t.positions,this.positionsQuantized=new Uint16Array(t.positions.length),this.normals=t.normals,this.normalsOctEncoded=null,this.colorsCompressed=t.colorsCompressed,this.indices=t.indices,this.edgeIndices=t.edgeIndices,this.solid=!1}get reused(){return this.numInstances>1}}class XKTEntity{constructor(t,e){this.entityId=t,this.entityIndex=0,this.meshes=e,this.aabb=math.AABB3(),this.hasReusedGeometries=!1}}class XKTTile{constructor(t,e){this.aabb=t,this.entities=e}}class KDNode{constructor(t){this.aabb=t,this.entities=null,this.left=null,this.right=null}}const tempVec4a=math.vec4([0,0,0,1]),tempVec4b=math.vec4([0,0,0,1]),tempMat4=math.mat4(),tempMat4b=math.mat4(),MIN_TILE_DIAG=1e4,kdTreeDimLength=new Float64Array(3);class XKTModel{constructor(t={}){this.edgeThreshold=t.edgeThreshold||10,this.reusedGeometriesDecodeMatrix=new Float64Array(16),this.geometries={},this.geometriesList=[],this.meshes={},this.meshesList=[],this.entities={},this.entitiesList=[],this.tilesList=[],this.finalized=!1}createGeometry(t){if(!t)throw"Parameters expected: params";if(null===t.geometryId||void 0===t.geometryId)throw"Parameter expected: params.geometryId";if(!t.primitiveType)throw"Parameter expected: params.primitiveType";if(!t.positions)throw"Parameter expected: params.positions";const e="triangles"===t.primitiveType,n="points"===t.primitiveType,r="lines"===t.primitiveType;if(!e&&!n&&!r)throw"Unsupported value for params.primitiveType: "+t.primitiveType+"' - supported values are 'triangles', 'points' and 'lines'";if(e){if(!t.normals)throw"Parameter expected for 'triangles' primitive: params.normals";if(!t.indices)throw"Parameter expected for 'triangles' primitive: params.indices"}if(n&&!t.colors&&!t.colorsCompressed)throw"Parameter expected for 'points' primitive: params.colors or params.colorsCompressed";if(r&&!t.indices)throw"Parameter expected for 'lines' primitive: params.indices";if(this.finalized)return void console.error("XKTModel has been finalized, can't add more geometries");if(this.geometries[t.geometryId])return void console.error("XKTGeometry already exists with this ID: "+t.geometryId);const i=t.geometryId,a=t.primitiveType,o=new Float64Array(t.positions),s={geometryId:i,geometryIndex:this.geometriesList.length,primitiveType:a,positions:o};if(e&&(s.normals=new Float64Array(t.normals),s.indices=t.indices,s.edgeIndices=buildEdgeIndices(o,t.indices,null,t.edgeThreshold||this.edgeThreshold||10)),n)if(t.colorsCompressed)s.colorsCompressed=new Uint8Array(t.colorsCompressed);else{const e=t.colors,n=new Uint8Array(e.length);for(let t=0,r=e.length;t<r;t++)n[t]=Math.floor(255*e[t]);s.colorsCompressed=n}r&&(s.indices=t.indices);const l=new XKTGeometry(s);return this.geometries[i]=l,this.geometriesList.push(l),l}createMesh(t){if(null===t.meshId||void 0===t.meshId)throw"Parameter expected: params.meshId";if(null===t.geometryId||void 0===t.geometryId)throw"Parameter expected: params.geometryId";if(this.finalized)throw"XKTModel has been finalized, can't add more meshes";if(this.meshes[t.meshId])return void console.error("XKTMesh already exists with this ID: "+t.meshId);const e=this.geometries[t.geometryId];if(!e)return void console.error("XKTGeometry not found: "+t.geometryId);e.numInstances++;let n=t.matrix;if(!n){const e=t.position,r=t.scale,i=t.rotation;if(e||r||i){n=math.identityMat4();const t=math.eulerToQuaternion(i||[0,0,0],"XYZ",math.identityQuaternion());math.composeMat4(e||[0,0,0],t,r||[1,1,1],n)}else n=math.identityMat4()}const r=this.meshesList.length,i=new XKTMesh({meshId:t.meshId,meshIndex:r,matrix:n,geometry:e,color:t.color,metallic:t.metallic,roughness:t.roughness,opacity:t.opacity});return this.meshes[i.meshId]=i,this.meshesList.push(i),i}createEntity(t){if(!t)throw"Parameters expected: params";if(null===t.entityId||void 0===t.entityId)throw"Parameter expected: params.entityId";if(!t.meshIds)throw"Parameter expected: params.meshIds";if(this.finalized)return void console.error("XKTModel has been finalized, can't add more entities");if(this.entities[t.entityId])return void console.error("XKTEntity already exists with this ID: "+t.entityId);const e=t.entityId,n=t.meshIds,r=[];for(let t=0,e=n.length;t<e;t++){const e=n[t],i=this.meshes[e];i?i.entity?console.error("XKTMesh "+e+" already used by XKTEntity "+i.entity.entityId):r.push(i):console.error("XKTMesh found: "+e)}const i=new XKTEntity(e,r);for(let t=0,e=r.length;t<e;t++){r[t].entity=i}return this.entities[e]=i,this.entitiesList.push(i),i}finalize(){if(this.finalized)return void console.log("XKTModel already finalized");this._bakeSingleUseGeometryPositions(),this._bakeAndOctEncodeNormals(),this._createEntityAABBs();const t=this._createKDTree();this._createTilesFromKDTree(t),this._createReusedGeometriesDecodeMatrix(),this._flagSolidGeometries(),this.finalized=!0}_bakeSingleUseGeometryPositions(){for(let t=0,e=this.meshesList.length;t<e;t++){const e=this.meshesList[t],n=e.geometry;if(1===n.numInstances){const t=e.matrix;if(t&&!math.isIdentityMat4(t)){const e=n.positions;for(let n=0,r=e.length;n<r;n+=3)tempVec4a[0]=e[n+0],tempVec4a[1]=e[n+1],tempVec4a[2]=e[n+2],tempVec4a[3]=1,math.transformPoint4(t,tempVec4a,tempVec4b),e[n+0]=tempVec4b[0],e[n+1]=tempVec4b[1],e[n+2]=tempVec4b[2]}}}}_bakeAndOctEncodeNormals(){for(let t=0,e=this.meshesList.length;t<e;t++){const e=this.meshesList[t],n=e.geometry;if(n.normals&&!n.normalsOctEncoded)if(n.normalsOctEncoded=new Int8Array(n.normals.length),n.numInstances>1)geometryCompression.octEncodeNormals(n.normals,n.normals.length,n.normalsOctEncoded,0);else{const t=math.inverseMat4(math.transposeMat4(e.matrix,tempMat4),tempMat4b);geometryCompression.transformAndOctEncodeNormals(t,n.normals,n.normals.length,n.normalsOctEncoded,0)}}}_createEntityAABBs(){for(let t=0,e=this.entitiesList.length;t<e;t++){const e=this.entitiesList[t],n=e.aabb,r=e.meshes;math.collapseAABB3(n);for(let t=0,e=r.length;t<e;t++){const e=r[t],i=e.geometry,a=e.matrix;if(i.numInstances>1){const t=i.positions;for(let e=0,r=t.length;e<r;e+=3)tempVec4a[0]=t[e+0],tempVec4a[1]=t[e+1],tempVec4a[2]=t[e+2],tempVec4a[3]=1,math.transformPoint4(a,tempVec4a,tempVec4b),math.expandAABB3Point3(n,tempVec4b)}else{const t=i.positions;for(let e=0,r=t.length;e<r;e+=3)tempVec4a[0]=t[e+0],tempVec4a[1]=t[e+1],tempVec4a[2]=t[e+2],math.expandAABB3Point3(n,tempVec4a)}}}}_createKDTree(){const t=math.collapseAABB3();for(let e=0,n=this.entitiesList.length;e<n;e++){const n=this.entitiesList[e];math.expandAABB3(t,n.aabb)}const e=new KDNode(t);for(let t=0,n=this.entitiesList.length;t<n;t++){const n=this.entitiesList[t];this._insertEntityIntoKDTree(e,n)}return e}_insertEntityIntoKDTree(t,e){const n=t.aabb,r=e.aabb;if(math.getAABB3Diag(n)<MIN_TILE_DIAG)return t.entities=t.entities||[],t.entities.push(e),void math.expandAABB3(n,r);if(t.left&&math.containsAABB3(t.left.aabb,r))return void this._insertEntityIntoKDTree(t.left,e);if(t.right&&math.containsAABB3(t.right.aabb,r))return void this._insertEntityIntoKDTree(t.right,e);kdTreeDimLength[0]=n[3]-n[0],kdTreeDimLength[1]=n[4]-n[1],kdTreeDimLength[2]=n[5]-n[2];let i=0;if(kdTreeDimLength[1]>kdTreeDimLength[i]&&(i=1),kdTreeDimLength[2]>kdTreeDimLength[i]&&(i=2),!t.left){const a=n.slice();if(a[i+3]=(n[i]+n[i+3])/2,t.left=new KDNode(a),math.containsAABB3(a,r))return void this._insertEntityIntoKDTree(t.left,e)}if(!t.right){const a=n.slice();if(a[i]=(n[i]+n[i+3])/2,t.right=new KDNode(a),math.containsAABB3(a,r))return void this._insertEntityIntoKDTree(t.right,e)}t.entities=t.entities||[],t.entities.push(e),math.expandAABB3(n,r)}_createTilesFromKDTree(t){this._createTilesFromKDNode(t)}_createTilesFromKDNode(t){t.entities&&t.entities.length>0&&this._createTileFromEntities(t.entities),t.left&&this._createTilesFromKDNode(t.left),t.right&&this._createTilesFromKDNode(t.right)}_createTileFromEntities(t){const e=math.AABB3();math.collapseAABB3(e);for(let n=0;n<t.length;n++){const r=t[n];math.expandAABB3(e,r.aabb)}const n=math.getAABB3Center(e),r=math.mulVec3Scalar(n,-1,math.vec3()),i=math.AABB3();i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],i[3]=e[3]-n[0],i[4]=e[4]-n[1],i[5]=e[5]-n[2];for(let e=0;e<t.length;e++){const a=t[e],o=a.meshes;for(let t=0,e=o.length;t<e;t++){const e=o[t],a=e.geometry;if(a.reused)math.translateMat4v(r,e.matrix);else{const t=a.positions;for(let e=0,r=t.length;e<r;e+=3)t[e+0]-=n[0],t[e+1]-=n[1],t[e+2]-=n[2];geometryCompression.quantizePositions(t,t.length,i,a.positionsQuantized)}}a.entityIndex=this.entitiesList.length,this.entitiesList.push(a)}const a=new XKTTile(e,t);this.tilesList.push(a)}_createReusedGeometriesDecodeMatrix(){const t=math.vec3(),e=math.collapseAABB3(math.AABB3());let n=0;for(let r=0,i=this.geometriesList.length;r<i;r++){const i=this.geometriesList[r];if(i.reused){const r=i.positions;for(let n=0,i=r.length;n<i;n+=3)t[0]=r[n],t[1]=r[n+1],t[2]=r[n+2],math.expandAABB3Point3(e,t);n++}}if(n>0){geometryCompression.createPositionsDecodeMatrix(e,this.reusedGeometriesDecodeMatrix);for(let t=0,n=this.geometriesList.length;t<n;t++){const n=this.geometriesList[t];n.reused&&geometryCompression.quantizePositions(n.positions,n.positions.length,e,n.positionsQuantized)}}else math.identityMat4(this.reusedGeometriesDecodeMatrix)}_flagSolidGeometries(){for(let t=0,e=this.geometriesList.length;t<e;t++){const e=this.geometriesList[t];"triangles"===e.primitiveType&&(e.solid=isTriangleMeshSolid(e.indices,e.positionsQuantized))}}}function validateXKTArrayBuffer(t,e){const n=new DataView(t),r=new Uint8Array(t),i=(n.getUint32(0,!0),n.getUint32(4,!0)),a=[];let o=4*(i+2);for(let t=0;t<i;t++){const e=n.getUint32(4*(t+2),!0);a.push(r.subarray(o,o+e)),o+=e}return validateData(inflate(extract(a)),e)}function extract(t){return{positions:t[0],normals:t[1],colors:t[2],indices:t[3],edgeIndices:t[4],matrices:t[5],reusedGeometriesDecodeMatrix:t[6],eachGeometryPrimitiveType:t[7],eachGeometryPositionsPortion:t[8],eachGeometryNormalsPortion:t[9],eachGeometryColorsPortion:t[10],eachGeometryIndicesPortion:t[11],eachGeometryEdgeIndicesPortion:t[12],eachMeshGeometriesPortion:t[13],eachMeshMatricesPortion:t[14],eachMeshColorAndOpacity:t[15],eachEntityId:t[16],eachEntityMeshesPortion:t[17],eachTileAABB:t[18],eachTileEntitiesPortion:t[19]}}function inflate(t){return{positions:new Uint16Array(pako.inflate(t.positions).buffer),normals:new Int8Array(pako.inflate(t.normals).buffer),colors:new Uint8Array(pako.inflate(t.colors).buffer),indices:new Uint32Array(pako.inflate(t.indices).buffer),edgeIndices:new Uint32Array(pako.inflate(t.edgeIndices).buffer),matrices:new Float32Array(pako.inflate(t.matrices).buffer),reusedGeometriesDecodeMatrix:new Float32Array(pako.inflate(t.reusedGeometriesDecodeMatrix).buffer),eachGeometryPrimitiveType:new Uint8Array(pako.inflate(t.eachGeometryPrimitiveType).buffer),eachGeometryPositionsPortion:new Uint32Array(pako.inflate(t.eachGeometryPositionsPortion).buffer),eachGeometryNormalsPortion:new Uint32Array(pako.inflate(t.eachGeometryNormalsPortion).buffer),eachGeometryColorsPortion:new Uint32Array(pako.inflate(t.eachGeometryColorsPortion).buffer),eachGeometryIndicesPortion:new Uint32Array(pako.inflate(t.eachGeometryIndicesPortion).buffer),eachGeometryEdgeIndicesPortion:new Uint32Array(pako.inflate(t.eachGeometryEdgeIndicesPortion).buffer),eachMeshGeometriesPortion:new Uint32Array(pako.inflate(t.eachMeshGeometriesPortion).buffer),eachMeshMatricesPortion:new Uint32Array(pako.inflate(t.eachMeshMatricesPortion).buffer),eachMeshColorAndOpacity:new Uint8Array(pako.inflate(t.eachMeshColorAndOpacity).buffer),eachEntityId:pako.inflate(t.eachEntityId,{to:"string"}),eachEntityMeshesPortion:new Uint32Array(pako.inflate(t.eachEntityMeshesPortion).buffer),eachTileAABB:new Float64Array(pako.inflate(t.eachTileAABB).buffer),eachTileEntitiesPortion:new Uint32Array(pako.inflate(t.eachTileEntitiesPortion).buffer)}}const decompressColor=function(){const t=new Float32Array(3);return function(e){return t[0]=e[0]/255,t[1]=e[1]/255,t[2]=e[2]/255,t}}();function validateData(t,e){const n=t.positions,r=t.normals,i=t.colors,a=t.indices,o=t.edgeIndices,s=t.matrices,l=(t.reusedGeometriesDecodeMatrix,t.eachGeometryPrimitiveType),h=t.eachGeometryPositionsPortion,c=t.eachGeometryNormalsPortion,d=t.eachGeometryColorsPortion,u=t.eachGeometryIndicesPortion,f=t.eachGeometryEdgeIndicesPortion,m=t.eachMeshGeometriesPortion,p=t.eachMeshColorAndOpacity,_=t.eachMeshMatricesPortion,g=JSON.parse(t.eachEntityId),y=t.eachEntityMeshesPortion,w=t.eachTileAABB,b=t.eachTileEntitiesPortion,v=h.length,M=m.length,A=g.length,k=b.length;if(k!==e.tilesList.length)return console.error("Unexpected number of tiles; found "+k+", but expected "+e.tilesList.length),!1;const x=new Uint32Array(v);for(let t=0;t<M;t++){const e=m[t];void 0!==x[e]?x[e]++:x[e]=1}for(let t=0;t<M;t++){const n=m[t],r=e.geometriesList[n];if(!r)return console.error("xktModel.geometriesList[geometryIndex] not found"),!1;if(r.numInstances!==x[n])return console.error("xktGeometry.numInstances !== geometryReuseCounts[geometryIndex]"),!1}for(let t=0;t<v;t++){const n=e.geometriesList[t];if(!n)return console.error("xktModel.geometriesList[geometryIndex] not found"),!1;switch(l[t]){case 0:case 1:if("triangles"!==n.primitiveType)return console.error("eachGeometryPrimitiveType[geometryIndex] unexpected value"),!1;break;case 2:if("points"!==n.primitiveType)return console.error("eachGeometryPrimitiveType[geometryIndex] unexpected value"),!1;break;case 3:if("lines"!==n.primitiveType)return console.error("eachGeometryPrimitiveType[geometryIndex] unexpected value"),!1;break;default:return console.error("eachGeometryPrimitiveType[geometryIndex] unexpected value"),!1}}for(let t=0;t<k;t++){const M=t===k-1,T=b[t],B=M?A:b[t+1],E=6*t,z=w.subarray(E,E+6),I=e.tilesList[t];if(!I)return console.error("xktModel.tilesList[tileIndex] not found"),!1;if(!compareArrays(z,I.aabb))return console.error("compareArrays(tileAABB, xktTile.aabb) === false"),!1;if(B-T!==I.entities.length)return console.error("Unexpected number of entities in tile"),!1;for(let t=T;t<B;t++){const w=g[t],b=t===A-1,M=y[t],k=b?m.length:y[t+1],T=e.entitiesList[t];if(!T)return console.error("xktModel.entitiesList[tileEntityIndex] not found"),!1;if(w!==T.entityId)return console.error("entityId !== xktEntity.entityId"),!1;for(let t=M;t<k;t++){const g=_[t],y=s.slice(g,g+16),w=decompressColor(p.subarray(4*t,4*t+3)),b=p[4*t+3]/255,M=m[t],A=x[M],k=A>1,T=M===v-1,B=l[M],E=e.meshesList[t],z=e.geometriesList[M];if(!E)return console.error("xktModel.meshesList[meshIndex] not found"),!1;if(!z)return console.error("xktModel.geometriesList[geometryIndex] not found"),!1;if(k&&!compareArrays(y,E.matrix))return console.error("compareArrays(meshMatrix, xktMesh.matrix) === false"),!1;if(E.color&&!compareArrays(w,E.color))return console.error("compareArrays(color, xktMesh.color) === false"),!1;if(b!==E.opacity)return console.error("opacity !== xktMesh.opacity"),!1;if(E.geometry!==z)return console.error("xktMesh.geometry !== xktGeometry"),!1;let I,P,S,V,D;switch(B){case 0:case 1:I=n.subarray(h[M],T?n.length:h[M+1]),P=r.subarray(c[M],T?r.length:c[M+1]),V=a.subarray(u[M],T?a.length:u[M+1]),D=o.subarray(f[M],T?o.length:f[M+1]);break;case 2:I=n.subarray(h[M],T?n.length:h[M+1]),S=i.subarray(d[M],T?i.length:d[M+1]);break;case 3:I=n.subarray(h[M],T?n.length:h[M+1]),V=a.subarray(u[M],T?a.length:u[M+1]);break;default:continue}if(I&&!compareArrays(I,z.positionsQuantized))return console.error("compareArrays(geometryPositions, xktGeometry.positionsQuantized) === false"),!1;if(P&&!compareArrays(P,z.normalsOctEncoded))return console.error("compareArrays(geometryNormals, xktGeometry.normalsOctEncoded) === false"),!1;if(S&&!compareArrays(S,z.colorsCompressed))return console.error("compareArrays(geometryColors, xktGeometry.colorsCompressed) === false"),!1;if(V&&!compareArrays(V,z.indices))return console.error("compareArrays(geometryIndices, xktGeometry.indices) === false"),!1;if(D&&!compareArrays(D,z.edgeIndices))return console.error("compareArrays(geometryEdgeIndices, xktGeometry.edgeIndices) === false"),!1;if(A!==z.numInstances)return console.error("geometryReuseCount !== xktGeometry.numInstances"),!1}}}return!0}function compareArrays(t,e){if(t.length!==e.length)return!1;for(let n=0,r=t.length;n<r;n++)if(t[n]!==e[n])return!1;return!0}function createCommonjsModule(t,e,n){return t(n={path:e,exports:{},require:function(t,e){return commonjsRequire(t,void 0===e||null===e?n.path:e)}},n.exports),n.exports}function commonjsRequire(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var pako$1=createCommonjsModule(function(t,e){t.exports=function t(e,n,r){function i(o,s){if(!n[o]){if(!e[o]){var l="function"==typeof commonjsRequire&&commonjsRequire;if(!s&&l)return l(o,!0);if(a)return a(o,!0);var h=new Error("Cannot find module '"+o+"'");throw h.code="MODULE_NOT_FOUND",h}var c=n[o]={exports:{}};e[o][0].call(c.exports,function(t){var n=e[o][1][t];return i(n||t)},c,c.exports,t,e,n,r)}return n[o].exports}for(var a="function"==typeof commonjsRequire&&commonjsRequire,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(t,e,n){var r=t("./zlib/deflate"),i=t("./utils/common"),a=t("./utils/strings"),o=t("./zlib/messages"),s=t("./zlib/zstream"),l=Object.prototype.toString,h=0,c=-1,d=0,u=8;function f(t){if(!(this instanceof f))return new f(t);this.options=i.assign({level:c,method:u,chunkSize:16384,windowBits:15,memLevel:8,strategy:d,to:""},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var n=r.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(n!==h)throw new Error(o[n]);if(e.header&&r.deflateSetHeader(this.strm,e.header),e.dictionary){var m;if(m="string"==typeof e.dictionary?a.string2buf(e.dictionary):"[object ArrayBuffer]"===l.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,(n=r.deflateSetDictionary(this.strm,m))!==h)throw new Error(o[n]);this._dict_set=!0}}function m(t,e){var n=new f(e);if(n.push(t,!0),n.err)throw n.msg||o[n.err];return n.result}f.prototype.push=function(t,e){var n,o,s=this.strm,c=this.options.chunkSize;if(this.ended)return!1;o=e===~~e?e:!0===e?4:0,"string"==typeof t?s.input=a.string2buf(t):"[object ArrayBuffer]"===l.call(t)?s.input=new Uint8Array(t):s.input=t,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new i.Buf8(c),s.next_out=0,s.avail_out=c),1!==(n=r.deflate(s,o))&&n!==h)return this.onEnd(n),this.ended=!0,!1;0!==s.avail_out&&(0!==s.avail_in||4!==o&&2!==o)||("string"===this.options.to?this.onData(a.buf2binstring(i.shrinkBuf(s.output,s.next_out))):this.onData(i.shrinkBuf(s.output,s.next_out)))}while((s.avail_in>0||0===s.avail_out)&&1!==n);return 4===o?(n=r.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===h):2!==o||(this.onEnd(h),s.avail_out=0,!0)},f.prototype.onData=function(t){this.chunks.push(t)},f.prototype.onEnd=function(t){t===h&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},n.Deflate=f,n.deflate=m,n.deflateRaw=function(t,e){return(e=e||{}).raw=!0,m(t,e)},n.gzip=function(t,e){return(e=e||{}).gzip=!0,m(t,e)}},{"./utils/common":3,"./utils/strings":4,"./zlib/deflate":8,"./zlib/messages":13,"./zlib/zstream":15}],2:[function(t,e,n){var r=t("./zlib/inflate"),i=t("./utils/common"),a=t("./utils/strings"),o=t("./zlib/constants"),s=t("./zlib/messages"),l=t("./zlib/zstream"),h=t("./zlib/gzheader"),c=Object.prototype.toString;function d(t){if(!(this instanceof d))return new d(t);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var n=r.inflateInit2(this.strm,e.windowBits);if(n!==o.Z_OK)throw new Error(s[n]);if(this.header=new h,r.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=a.string2buf(e.dictionary):"[object ArrayBuffer]"===c.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(n=r.inflateSetDictionary(this.strm,e.dictionary))!==o.Z_OK))throw new Error(s[n])}function u(t,e){var n=new d(e);if(n.push(t,!0),n.err)throw n.msg||s[n.err];return n.result}d.prototype.push=function(t,e){var n,s,l,h,d,u=this.strm,f=this.options.chunkSize,m=this.options.dictionary,p=!1;if(this.ended)return!1;s=e===~~e?e:!0===e?o.Z_FINISH:o.Z_NO_FLUSH,"string"==typeof t?u.input=a.binstring2buf(t):"[object ArrayBuffer]"===c.call(t)?u.input=new Uint8Array(t):u.input=t,u.next_in=0,u.avail_in=u.input.length;do{if(0===u.avail_out&&(u.output=new i.Buf8(f),u.next_out=0,u.avail_out=f),(n=r.inflate(u,o.Z_NO_FLUSH))===o.Z_NEED_DICT&&m&&(n=r.inflateSetDictionary(this.strm,m)),n===o.Z_BUF_ERROR&&!0===p&&(n=o.Z_OK,p=!1),n!==o.Z_STREAM_END&&n!==o.Z_OK)return this.onEnd(n),this.ended=!0,!1;u.next_out&&(0!==u.avail_out&&n!==o.Z_STREAM_END&&(0!==u.avail_in||s!==o.Z_FINISH&&s!==o.Z_SYNC_FLUSH)||("string"===this.options.to?(l=a.utf8border(u.output,u.next_out),h=u.next_out-l,d=a.buf2string(u.output,l),u.next_out=h,u.avail_out=f-h,h&&i.arraySet(u.output,u.output,l,h,0),this.onData(d)):this.onData(i.shrinkBuf(u.output,u.next_out)))),0===u.avail_in&&0===u.avail_out&&(p=!0)}while((u.avail_in>0||0===u.avail_out)&&n!==o.Z_STREAM_END);return n===o.Z_STREAM_END&&(s=o.Z_FINISH),s===o.Z_FINISH?(n=r.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===o.Z_OK):s!==o.Z_SYNC_FLUSH||(this.onEnd(o.Z_OK),u.avail_out=0,!0)},d.prototype.onData=function(t){this.chunks.push(t)},d.prototype.onEnd=function(t){t===o.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},n.Inflate=d,n.inflate=u,n.inflateRaw=function(t,e){return(e=e||{}).raw=!0,u(t,e)},n.ungzip=u},{"./utils/common":3,"./utils/strings":4,"./zlib/constants":6,"./zlib/gzheader":9,"./zlib/inflate":11,"./zlib/messages":13,"./zlib/zstream":15}],3:[function(t,e,n){var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function i(t,e){return Object.prototype.hasOwnProperty.call(t,e)}n.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var n=e.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var r in n)i(n,r)&&(t[r]=n[r])}}return t},n.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var a={arraySet:function(t,e,n,r,i){if(e.subarray&&t.subarray)t.set(e.subarray(n,n+r),i);else for(var a=0;a<r;a++)t[i+a]=e[n+a]},flattenChunks:function(t){var e,n,r,i,a,o;for(r=0,e=0,n=t.length;e<n;e++)r+=t[e].length;for(o=new Uint8Array(r),i=0,e=0,n=t.length;e<n;e++)a=t[e],o.set(a,i),i+=a.length;return o}},o={arraySet:function(t,e,n,r,i){for(var a=0;a<r;a++)t[i+a]=e[n+a]},flattenChunks:function(t){return[].concat.apply([],t)}};n.setTyped=function(t){t?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,a)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,o))},n.setTyped(r)},{}],4:[function(t,e,n){var r=t("./common"),i=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch(t){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){a=!1}for(var o=new r.Buf8(256),s=0;s<256;s++)o[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;function l(t,e){if(e<65534&&(t.subarray&&a||!t.subarray&&i))return String.fromCharCode.apply(null,r.shrinkBuf(t,e));for(var n="",o=0;o<e;o++)n+=String.fromCharCode(t[o]);return n}o[254]=o[254]=1,n.string2buf=function(t){var e,n,i,a,o,s=t.length,l=0;for(a=0;a<s;a++)55296==(64512&(n=t.charCodeAt(a)))&&a+1<s&&56320==(64512&(i=t.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(i-56320),a++),l+=n<128?1:n<2048?2:n<65536?3:4;for(e=new r.Buf8(l),o=0,a=0;o<l;a++)55296==(64512&(n=t.charCodeAt(a)))&&a+1<s&&56320==(64512&(i=t.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(i-56320),a++),n<128?e[o++]=n:n<2048?(e[o++]=192|n>>>6,e[o++]=128|63&n):n<65536?(e[o++]=224|n>>>12,e[o++]=128|n>>>6&63,e[o++]=128|63&n):(e[o++]=240|n>>>18,e[o++]=128|n>>>12&63,e[o++]=128|n>>>6&63,e[o++]=128|63&n);return e},n.buf2binstring=function(t){return l(t,t.length)},n.binstring2buf=function(t){for(var e=new r.Buf8(t.length),n=0,i=e.length;n<i;n++)e[n]=t.charCodeAt(n);return e},n.buf2string=function(t,e){var n,r,i,a,s=e||t.length,h=new Array(2*s);for(r=0,n=0;n<s;)if((i=t[n++])<128)h[r++]=i;else if((a=o[i])>4)h[r++]=65533,n+=a-1;else{for(i&=2===a?31:3===a?15:7;a>1&&n<s;)i=i<<6|63&t[n++],a--;a>1?h[r++]=65533:i<65536?h[r++]=i:(i-=65536,h[r++]=55296|i>>10&1023,h[r++]=56320|1023&i)}return l(h,r)},n.utf8border=function(t,e){var n;for((e=e||t.length)>t.length&&(e=t.length),n=e-1;n>=0&&128==(192&t[n]);)n--;return n<0?e:0===n?e:n+o[t[n]]>e?n:e}},{"./common":3}],5:[function(t,e,n){e.exports=function(t,e,n,r){for(var i=65535&t|0,a=t>>>16&65535|0,o=0;0!==n;){n-=o=n>2e3?2e3:n;do{i=i+e[r++]|0,a=a+i|0}while(--o);i%=65521,a%=65521}return i|a<<16|0}},{}],6:[function(t,e,n){e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],7:[function(t,e,n){var r=function(){for(var t,e=[],n=0;n<256;n++){t=n;for(var r=0;r<8;r++)t=1&t?3988292384^t>>>1:t>>>1;e[n]=t}return e}();e.exports=function(t,e,n,i){var a=r,o=i+n;t^=-1;for(var s=i;s<o;s++)t=t>>>8^a[255&(t^e[s])];return-1^t}},{}],8:[function(t,e,n){var r,i=t("../utils/common"),a=t("./trees"),o=t("./adler32"),s=t("./crc32"),l=t("./messages"),h=0,c=1,d=3,u=4,f=5,m=0,p=1,_=-2,g=-3,y=-5,w=-1,b=1,v=2,M=3,A=4,k=0,x=2,T=8,B=9,E=15,z=8,I=286,P=30,S=19,V=2*I+1,D=15,G=3,L=258,O=L+G+1,U=32,F=42,C=69,N=73,X=91,R=103,Z=113,K=666,q=1,$=2,j=3,Q=4,Y=3;function H(t,e){return t.msg=l[e],e}function W(t){return(t<<1)-(t>4?9:0)}function J(t){for(var e=t.length;--e>=0;)t[e]=0}function tt(t){var e=t.state,n=e.pending;n>t.avail_out&&(n=t.avail_out),0!==n&&(i.arraySet(t.output,e.pending_buf,e.pending_out,n,t.next_out),t.next_out+=n,e.pending_out+=n,t.total_out+=n,t.avail_out-=n,e.pending-=n,0===e.pending&&(e.pending_out=0))}function et(t,e){a._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,tt(t.strm)}function nt(t,e){t.pending_buf[t.pending++]=e}function rt(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function it(t,e){var n,r,i=t.max_chain_length,a=t.strstart,o=t.prev_length,s=t.nice_match,l=t.strstart>t.w_size-O?t.strstart-(t.w_size-O):0,h=t.window,c=t.w_mask,d=t.prev,u=t.strstart+L,f=h[a+o-1],m=h[a+o];t.prev_length>=t.good_match&&(i>>=2),s>t.lookahead&&(s=t.lookahead);do{if(h[(n=e)+o]===m&&h[n+o-1]===f&&h[n]===h[a]&&h[++n]===h[a+1]){a+=2,n++;do{}while(h[++a]===h[++n]&&h[++a]===h[++n]&&h[++a]===h[++n]&&h[++a]===h[++n]&&h[++a]===h[++n]&&h[++a]===h[++n]&&h[++a]===h[++n]&&h[++a]===h[++n]&&a<u);if(r=L-(u-a),a=u-L,r>o){if(t.match_start=e,o=r,r>=s)break;f=h[a+o-1],m=h[a+o]}}}while((e=d[e&c])>l&&0!=--i);return o<=t.lookahead?o:t.lookahead}function at(t){var e,n,r,a,l,h,c,d,u,f,m=t.w_size;do{if(a=t.window_size-t.lookahead-t.strstart,t.strstart>=m+(m-O)){i.arraySet(t.window,t.window,m,m,0),t.match_start-=m,t.strstart-=m,t.block_start-=m,n=t.hash_size,e=n;do{r=t.head[--e],t.head[e]=r>=m?r-m:0}while(--n);e=n=m;do{r=t.prev[--e],t.prev[e]=r>=m?r-m:0}while(--n);a+=m}if(0===t.strm.avail_in)break;if(h=t.strm,c=t.window,d=t.strstart+t.lookahead,u=a,f=void 0,(f=h.avail_in)>u&&(f=u),n=0===f?0:(h.avail_in-=f,i.arraySet(c,h.input,h.next_in,f,d),1===h.state.wrap?h.adler=o(h.adler,c,f,d):2===h.state.wrap&&(h.adler=s(h.adler,c,f,d)),h.next_in+=f,h.total_in+=f,f),t.lookahead+=n,t.lookahead+t.insert>=G)for(l=t.strstart-t.insert,t.ins_h=t.window[l],t.ins_h=(t.ins_h<<t.hash_shift^t.window[l+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[l+G-1])&t.hash_mask,t.prev[l&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=l,l++,t.insert--,!(t.lookahead+t.insert<G)););}while(t.lookahead<O&&0!==t.strm.avail_in)}function ot(t,e){for(var n,r;;){if(t.lookahead<O){if(at(t),t.lookahead<O&&e===h)return q;if(0===t.lookahead)break}if(n=0,t.lookahead>=G&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+G-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==n&&t.strstart-n<=t.w_size-O&&(t.match_length=it(t,n)),t.match_length>=G)if(r=a._tr_tally(t,t.strstart-t.match_start,t.match_length-G),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=G){t.match_length--;do{t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+G-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else r=a._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(r&&(et(t,!1),0===t.strm.avail_out))return q}return t.insert=t.strstart<G-1?t.strstart:G-1,e===u?(et(t,!0),0===t.strm.avail_out?j:Q):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?q:$}function st(t,e){for(var n,r,i;;){if(t.lookahead<O){if(at(t),t.lookahead<O&&e===h)return q;if(0===t.lookahead)break}if(n=0,t.lookahead>=G&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+G-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=G-1,0!==n&&t.prev_length<t.max_lazy_match&&t.strstart-n<=t.w_size-O&&(t.match_length=it(t,n),t.match_length<=5&&(t.strategy===b||t.match_length===G&&t.strstart-t.match_start>4096)&&(t.match_length=G-1)),t.prev_length>=G&&t.match_length<=t.prev_length){i=t.strstart+t.lookahead-G,r=a._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-G),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=i&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+G-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=G-1,t.strstart++,r&&(et(t,!1),0===t.strm.avail_out))return q}else if(t.match_available){if((r=a._tr_tally(t,0,t.window[t.strstart-1]))&&et(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return q}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(r=a._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<G-1?t.strstart:G-1,e===u?(et(t,!0),0===t.strm.avail_out?j:Q):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?q:$}function lt(t,e,n,r,i){this.good_length=t,this.max_lazy=e,this.nice_length=n,this.max_chain=r,this.func=i}function ht(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=x,(e=t.state).pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?F:Z,t.adler=2===e.wrap?0:1,e.last_flush=h,a._tr_init(e),m):H(t,_)}function ct(t){var e,n=ht(t);return n===m&&((e=t.state).window_size=2*e.w_size,J(e.head),e.max_lazy_match=r[e.level].max_lazy,e.good_match=r[e.level].good_length,e.nice_match=r[e.level].nice_length,e.max_chain_length=r[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=G-1,e.match_available=0,e.ins_h=0),n}function dt(t,e,n,r,a,o){if(!t)return _;var s=1;if(e===w&&(e=6),r<0?(s=0,r=-r):r>15&&(s=2,r-=16),a<1||a>B||n!==T||r<8||r>15||e<0||e>9||o<0||o>A)return H(t,_);8===r&&(r=9);var l=new function(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=T,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(2*V),this.dyn_dtree=new i.Buf16(2*(2*P+1)),this.bl_tree=new i.Buf16(2*(2*S+1)),J(this.dyn_ltree),J(this.dyn_dtree),J(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(D+1),this.heap=new i.Buf16(2*I+1),J(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(2*I+1),J(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0};return t.state=l,l.strm=t,l.wrap=s,l.gzhead=null,l.w_bits=r,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=a+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+G-1)/G),l.window=new i.Buf8(2*l.w_size),l.head=new i.Buf16(l.hash_size),l.prev=new i.Buf16(l.w_size),l.lit_bufsize=1<<a+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new i.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=e,l.strategy=o,l.method=n,ct(t)}r=[new lt(0,0,0,0,function(t,e){var n=65535;for(n>t.pending_buf_size-5&&(n=t.pending_buf_size-5);;){if(t.lookahead<=1){if(at(t),0===t.lookahead&&e===h)return q;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var r=t.block_start+n;if((0===t.strstart||t.strstart>=r)&&(t.lookahead=t.strstart-r,t.strstart=r,et(t,!1),0===t.strm.avail_out))return q;if(t.strstart-t.block_start>=t.w_size-O&&(et(t,!1),0===t.strm.avail_out))return q}return t.insert=0,e===u?(et(t,!0),0===t.strm.avail_out?j:Q):(t.strstart>t.block_start&&(et(t,!1),t.strm.avail_out),q)}),new lt(4,4,8,4,ot),new lt(4,5,16,8,ot),new lt(4,6,32,32,ot),new lt(4,4,16,16,st),new lt(8,16,32,32,st),new lt(8,16,128,128,st),new lt(8,32,128,256,st),new lt(32,128,258,1024,st),new lt(32,258,258,4096,st)],n.deflateInit=function(t,e){return dt(t,e,T,E,z,k)},n.deflateInit2=dt,n.deflateReset=ct,n.deflateResetKeep=ht,n.deflateSetHeader=function(t,e){return t&&t.state?2!==t.state.wrap?_:(t.state.gzhead=e,m):_},n.deflate=function(t,e){var n,i,o,l;if(!t||!t.state||e>f||e<0)return t?H(t,_):_;if(i=t.state,!t.output||!t.input&&0!==t.avail_in||i.status===K&&e!==u)return H(t,0===t.avail_out?y:_);if(i.strm=t,n=i.last_flush,i.last_flush=e,i.status===F)if(2===i.wrap)t.adler=0,nt(i,31),nt(i,139),nt(i,8),i.gzhead?(nt(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),nt(i,255&i.gzhead.time),nt(i,i.gzhead.time>>8&255),nt(i,i.gzhead.time>>16&255),nt(i,i.gzhead.time>>24&255),nt(i,9===i.level?2:i.strategy>=v||i.level<2?4:0),nt(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(nt(i,255&i.gzhead.extra.length),nt(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(t.adler=s(t.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=C):(nt(i,0),nt(i,0),nt(i,0),nt(i,0),nt(i,0),nt(i,9===i.level?2:i.strategy>=v||i.level<2?4:0),nt(i,Y),i.status=Z);else{var g=T+(i.w_bits-8<<4)<<8,w=-1;w=i.strategy>=v||i.level<2?0:i.level<6?1:6===i.level?2:3,g|=w<<6,0!==i.strstart&&(g|=U),g+=31-g%31,i.status=Z,rt(i,g),0!==i.strstart&&(rt(i,t.adler>>>16),rt(i,65535&t.adler)),t.adler=1}if(i.status===C)if(i.gzhead.extra){for(o=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>o&&(t.adler=s(t.adler,i.pending_buf,i.pending-o,o)),tt(t),o=i.pending,i.pending!==i.pending_buf_size));)nt(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>o&&(t.adler=s(t.adler,i.pending_buf,i.pending-o,o)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=N)}else i.status=N;if(i.status===N)if(i.gzhead.name){o=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>o&&(t.adler=s(t.adler,i.pending_buf,i.pending-o,o)),tt(t),o=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,nt(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>o&&(t.adler=s(t.adler,i.pending_buf,i.pending-o,o)),0===l&&(i.gzindex=0,i.status=X)}else i.status=X;if(i.status===X)if(i.gzhead.comment){o=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>o&&(t.adler=s(t.adler,i.pending_buf,i.pending-o,o)),tt(t),o=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,nt(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>o&&(t.adler=s(t.adler,i.pending_buf,i.pending-o,o)),0===l&&(i.status=R)}else i.status=R;if(i.status===R&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&tt(t),i.pending+2<=i.pending_buf_size&&(nt(i,255&t.adler),nt(i,t.adler>>8&255),t.adler=0,i.status=Z)):i.status=Z),0!==i.pending){if(tt(t),0===t.avail_out)return i.last_flush=-1,m}else if(0===t.avail_in&&W(e)<=W(n)&&e!==u)return H(t,y);if(i.status===K&&0!==t.avail_in)return H(t,y);if(0!==t.avail_in||0!==i.lookahead||e!==h&&i.status!==K){var b=i.strategy===v?function(t,e){for(var n;;){if(0===t.lookahead&&(at(t),0===t.lookahead)){if(e===h)return q;break}if(t.match_length=0,n=a._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,n&&(et(t,!1),0===t.strm.avail_out))return q}return t.insert=0,e===u?(et(t,!0),0===t.strm.avail_out?j:Q):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?q:$}(i,e):i.strategy===M?function(t,e){for(var n,r,i,o,s=t.window;;){if(t.lookahead<=L){if(at(t),t.lookahead<=L&&e===h)return q;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=G&&t.strstart>0&&(i=t.strstart-1,(r=s[i])===s[++i]&&r===s[++i]&&r===s[++i])){o=t.strstart+L;do{}while(r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&i<o);t.match_length=L-(o-i),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=G?(n=a._tr_tally(t,1,t.match_length-G),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(n=a._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),n&&(et(t,!1),0===t.strm.avail_out))return q}return t.insert=0,e===u?(et(t,!0),0===t.strm.avail_out?j:Q):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?q:$}(i,e):r[i.level].func(i,e);if(b!==j&&b!==Q||(i.status=K),b===q||b===j)return 0===t.avail_out&&(i.last_flush=-1),m;if(b===$&&(e===c?a._tr_align(i):e!==f&&(a._tr_stored_block(i,0,0,!1),e===d&&(J(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),tt(t),0===t.avail_out))return i.last_flush=-1,m}return e!==u?m:i.wrap<=0?p:(2===i.wrap?(nt(i,255&t.adler),nt(i,t.adler>>8&255),nt(i,t.adler>>16&255),nt(i,t.adler>>24&255),nt(i,255&t.total_in),nt(i,t.total_in>>8&255),nt(i,t.total_in>>16&255),nt(i,t.total_in>>24&255)):(rt(i,t.adler>>>16),rt(i,65535&t.adler)),tt(t),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?m:p)},n.deflateEnd=function(t){var e;return t&&t.state?(e=t.state.status)!==F&&e!==C&&e!==N&&e!==X&&e!==R&&e!==Z&&e!==K?H(t,_):(t.state=null,e===Z?H(t,g):m):_},n.deflateSetDictionary=function(t,e){var n,r,a,s,l,h,c,d,u=e.length;if(!t||!t.state)return _;if(n=t.state,2===(s=n.wrap)||1===s&&n.status!==F||n.lookahead)return _;for(1===s&&(t.adler=o(t.adler,e,u,0)),n.wrap=0,u>=n.w_size&&(0===s&&(J(n.head),n.strstart=0,n.block_start=0,n.insert=0),d=new i.Buf8(n.w_size),i.arraySet(d,e,u-n.w_size,n.w_size,0),e=d,u=n.w_size),l=t.avail_in,h=t.next_in,c=t.input,t.avail_in=u,t.next_in=0,t.input=e,at(n);n.lookahead>=G;){r=n.strstart,a=n.lookahead-(G-1);do{n.ins_h=(n.ins_h<<n.hash_shift^n.window[r+G-1])&n.hash_mask,n.prev[r&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=r,r++}while(--a);n.strstart=r,n.lookahead=G-1,at(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=G-1,n.match_available=0,t.next_in=h,t.input=c,t.avail_in=l,n.wrap=s,m},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":3,"./adler32":5,"./crc32":7,"./messages":13,"./trees":14}],9:[function(t,e,n){e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],10:[function(t,e,n){e.exports=function(t,e){var n,r,i,a,o,s,l,h,c,d,u,f,m,p,_,g,y,w,b,v,M,A,k,x,T;n=t.state,r=t.next_in,x=t.input,i=r+(t.avail_in-5),a=t.next_out,T=t.output,o=a-(e-t.avail_out),s=a+(t.avail_out-257),l=n.dmax,h=n.wsize,c=n.whave,d=n.wnext,u=n.window,f=n.hold,m=n.bits,p=n.lencode,_=n.distcode,g=(1<<n.lenbits)-1,y=(1<<n.distbits)-1;t:do{m<15&&(f+=x[r++]<<m,m+=8,f+=x[r++]<<m,m+=8),w=p[f&g];e:for(;;){if(f>>>=b=w>>>24,m-=b,0==(b=w>>>16&255))T[a++]=65535&w;else{if(!(16&b)){if(0==(64&b)){w=p[(65535&w)+(f&(1<<b)-1)];continue e}if(32&b){n.mode=12;break t}t.msg="invalid literal/length code",n.mode=30;break t}v=65535&w,(b&=15)&&(m<b&&(f+=x[r++]<<m,m+=8),v+=f&(1<<b)-1,f>>>=b,m-=b),m<15&&(f+=x[r++]<<m,m+=8,f+=x[r++]<<m,m+=8),w=_[f&y];n:for(;;){if(f>>>=b=w>>>24,m-=b,!(16&(b=w>>>16&255))){if(0==(64&b)){w=_[(65535&w)+(f&(1<<b)-1)];continue n}t.msg="invalid distance code",n.mode=30;break t}if(M=65535&w,m<(b&=15)&&(f+=x[r++]<<m,(m+=8)<b&&(f+=x[r++]<<m,m+=8)),(M+=f&(1<<b)-1)>l){t.msg="invalid distance too far back",n.mode=30;break t}if(f>>>=b,m-=b,M>(b=a-o)){if((b=M-b)>c&&n.sane){t.msg="invalid distance too far back",n.mode=30;break t}if(A=0,k=u,0===d){if(A+=h-b,b<v){v-=b;do{T[a++]=u[A++]}while(--b);A=a-M,k=T}}else if(d<b){if(A+=h+d-b,(b-=d)<v){v-=b;do{T[a++]=u[A++]}while(--b);if(A=0,d<v){v-=b=d;do{T[a++]=u[A++]}while(--b);A=a-M,k=T}}}else if(A+=d-b,b<v){v-=b;do{T[a++]=u[A++]}while(--b);A=a-M,k=T}for(;v>2;)T[a++]=k[A++],T[a++]=k[A++],T[a++]=k[A++],v-=3;v&&(T[a++]=k[A++],v>1&&(T[a++]=k[A++]))}else{A=a-M;do{T[a++]=T[A++],T[a++]=T[A++],T[a++]=T[A++],v-=3}while(v>2);v&&(T[a++]=T[A++],v>1&&(T[a++]=T[A++]))}break}}break}}while(r<i&&a<s);r-=v=m>>3,f&=(1<<(m-=v<<3))-1,t.next_in=r,t.next_out=a,t.avail_in=r<i?i-r+5:5-(r-i),t.avail_out=a<s?s-a+257:257-(a-s),n.hold=f,n.bits=m}},{}],11:[function(t,e,n){var r=t("../utils/common"),i=t("./adler32"),a=t("./crc32"),o=t("./inffast"),s=t("./inftrees"),l=0,h=1,c=2,d=4,u=5,f=6,m=0,p=1,_=2,g=-2,y=-3,w=-4,b=-5,v=8,M=1,A=2,k=3,x=4,T=5,B=6,E=7,z=8,I=9,P=10,S=11,V=12,D=13,G=14,L=15,O=16,U=17,F=18,C=19,N=20,X=21,R=22,Z=23,K=24,q=25,$=26,j=27,Q=28,Y=29,H=30,W=31,J=32,tt=852,et=592,nt=15;function rt(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function it(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=M,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new r.Buf32(tt),e.distcode=e.distdyn=new r.Buf32(et),e.sane=1,e.back=-1,m):g}function at(t){var e;return t&&t.state?((e=t.state).wsize=0,e.whave=0,e.wnext=0,it(t)):g}function ot(t,e){var n,r;return t&&t.state?(r=t.state,e<0?(n=0,e=-e):(n=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?g:(null!==r.window&&r.wbits!==e&&(r.window=null),r.wrap=n,r.wbits=e,at(t))):g}function st(t,e){var n,i;return t?(i=new function(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0},t.state=i,i.window=null,(n=ot(t,e))!==m&&(t.state=null),n):g}var lt,ht,ct=!0;function dt(t){if(ct){var e;for(lt=new r.Buf32(512),ht=new r.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(s(h,t.lens,0,288,lt,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;s(c,t.lens,0,32,ht,0,t.work,{bits:5}),ct=!1}t.lencode=lt,t.lenbits=9,t.distcode=ht,t.distbits=5}function ut(t,e,n,i){var a,o=t.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new r.Buf8(o.wsize)),i>=o.wsize?(r.arraySet(o.window,e,n-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):((a=o.wsize-o.wnext)>i&&(a=i),r.arraySet(o.window,e,n-i,a,o.wnext),(i-=a)?(r.arraySet(o.window,e,n-i,i,0),o.wnext=i,o.whave=o.wsize):(o.wnext+=a,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=a))),0}n.inflateReset=at,n.inflateReset2=ot,n.inflateResetKeep=it,n.inflateInit=function(t){return st(t,nt)},n.inflateInit2=st,n.inflate=function(t,e){var n,tt,et,nt,it,at,ot,st,lt,ht,ct,ft,mt,pt,_t,gt,yt,wt,bt,vt,Mt,At,kt,xt,Tt=0,Bt=new r.Buf8(4),Et=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return g;(n=t.state).mode===V&&(n.mode=D),it=t.next_out,et=t.output,ot=t.avail_out,nt=t.next_in,tt=t.input,at=t.avail_in,st=n.hold,lt=n.bits,ht=at,ct=ot,At=m;t:for(;;)switch(n.mode){case M:if(0===n.wrap){n.mode=D;break}for(;lt<16;){if(0===at)break t;at--,st+=tt[nt++]<<lt,lt+=8}if(2&n.wrap&&35615===st){n.check=0,Bt[0]=255&st,Bt[1]=st>>>8&255,n.check=a(n.check,Bt,2,0),st=0,lt=0,n.mode=A;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&st)<<8)+(st>>8))%31){t.msg="incorrect header check",n.mode=H;break}if((15&st)!==v){t.msg="unknown compression method",n.mode=H;break}if(lt-=4,Mt=8+(15&(st>>>=4)),0===n.wbits)n.wbits=Mt;else if(Mt>n.wbits){t.msg="invalid window size",n.mode=H;break}n.dmax=1<<Mt,t.adler=n.check=1,n.mode=512&st?P:V,st=0,lt=0;break;case A:for(;lt<16;){if(0===at)break t;at--,st+=tt[nt++]<<lt,lt+=8}if(n.flags=st,(255&n.flags)!==v){t.msg="unknown compression method",n.mode=H;break}if(57344&n.flags){t.msg="unknown header flags set",n.mode=H;break}n.head&&(n.head.text=st>>8&1),512&n.flags&&(Bt[0]=255&st,Bt[1]=st>>>8&255,n.check=a(n.check,Bt,2,0)),st=0,lt=0,n.mode=k;case k:for(;lt<32;){if(0===at)break t;at--,st+=tt[nt++]<<lt,lt+=8}n.head&&(n.head.time=st),512&n.flags&&(Bt[0]=255&st,Bt[1]=st>>>8&255,Bt[2]=st>>>16&255,Bt[3]=st>>>24&255,n.check=a(n.check,Bt,4,0)),st=0,lt=0,n.mode=x;case x:for(;lt<16;){if(0===at)break t;at--,st+=tt[nt++]<<lt,lt+=8}n.head&&(n.head.xflags=255&st,n.head.os=st>>8),512&n.flags&&(Bt[0]=255&st,Bt[1]=st>>>8&255,n.check=a(n.check,Bt,2,0)),st=0,lt=0,n.mode=T;case T:if(1024&n.flags){for(;lt<16;){if(0===at)break t;at--,st+=tt[nt++]<<lt,lt+=8}n.length=st,n.head&&(n.head.extra_len=st),512&n.flags&&(Bt[0]=255&st,Bt[1]=st>>>8&255,n.check=a(n.check,Bt,2,0)),st=0,lt=0}else n.head&&(n.head.extra=null);n.mode=B;case B:if(1024&n.flags&&((ft=n.length)>at&&(ft=at),ft&&(n.head&&(Mt=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),r.arraySet(n.head.extra,tt,nt,ft,Mt)),512&n.flags&&(n.check=a(n.check,tt,ft,nt)),at-=ft,nt+=ft,n.length-=ft),n.length))break t;n.length=0,n.mode=E;case E:if(2048&n.flags){if(0===at)break t;ft=0;do{Mt=tt[nt+ft++],n.head&&Mt&&n.length<65536&&(n.head.name+=String.fromCharCode(Mt))}while(Mt&&ft<at);if(512&n.flags&&(n.check=a(n.check,tt,ft,nt)),at-=ft,nt+=ft,Mt)break t}else n.head&&(n.head.name=null);n.length=0,n.mode=z;case z:if(4096&n.flags){if(0===at)break t;ft=0;do{Mt=tt[nt+ft++],n.head&&Mt&&n.length<65536&&(n.head.comment+=String.fromCharCode(Mt))}while(Mt&&ft<at);if(512&n.flags&&(n.check=a(n.check,tt,ft,nt)),at-=ft,nt+=ft,Mt)break t}else n.head&&(n.head.comment=null);n.mode=I;case I:if(512&n.flags){for(;lt<16;){if(0===at)break t;at--,st+=tt[nt++]<<lt,lt+=8}if(st!==(65535&n.check)){t.msg="header crc mismatch",n.mode=H;break}st=0,lt=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=V;break;case P:for(;lt<32;){if(0===at)break t;at--,st+=tt[nt++]<<lt,lt+=8}t.adler=n.check=rt(st),st=0,lt=0,n.mode=S;case S:if(0===n.havedict)return t.next_out=it,t.avail_out=ot,t.next_in=nt,t.avail_in=at,n.hold=st,n.bits=lt,_;t.adler=n.check=1,n.mode=V;case V:if(e===u||e===f)break t;case D:if(n.last){st>>>=7&lt,lt-=7&lt,n.mode=j;break}for(;lt<3;){if(0===at)break t;at--,st+=tt[nt++]<<lt,lt+=8}switch(n.last=1&st,lt-=1,3&(st>>>=1)){case 0:n.mode=G;break;case 1:if(dt(n),n.mode=N,e===f){st>>>=2,lt-=2;break t}break;case 2:n.mode=U;break;case 3:t.msg="invalid block type",n.mode=H}st>>>=2,lt-=2;break;case G:for(st>>>=7&lt,lt-=7&lt;lt<32;){if(0===at)break t;at--,st+=tt[nt++]<<lt,lt+=8}if((65535&st)!=(st>>>16^65535)){t.msg="invalid stored block lengths",n.mode=H;break}if(n.length=65535&st,st=0,lt=0,n.mode=L,e===f)break t;case L:n.mode=O;case O:if(ft=n.length){if(ft>at&&(ft=at),ft>ot&&(ft=ot),0===ft)break t;r.arraySet(et,tt,nt,ft,it),at-=ft,nt+=ft,ot-=ft,it+=ft,n.length-=ft;break}n.mode=V;break;case U:for(;lt<14;){if(0===at)break t;at--,st+=tt[nt++]<<lt,lt+=8}if(n.nlen=257+(31&st),st>>>=5,lt-=5,n.ndist=1+(31&st),st>>>=5,lt-=5,n.ncode=4+(15&st),st>>>=4,lt-=4,n.nlen>286||n.ndist>30){t.msg="too many length or distance symbols",n.mode=H;break}n.have=0,n.mode=F;case F:for(;n.have<n.ncode;){for(;lt<3;){if(0===at)break t;at--,st+=tt[nt++]<<lt,lt+=8}n.lens[Et[n.have++]]=7&st,st>>>=3,lt-=3}for(;n.have<19;)n.lens[Et[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,kt={bits:n.lenbits},At=s(l,n.lens,0,19,n.lencode,0,n.work,kt),n.lenbits=kt.bits,At){t.msg="invalid code lengths set",n.mode=H;break}n.have=0,n.mode=C;case C:for(;n.have<n.nlen+n.ndist;){for(;Tt=n.lencode[st&(1<<n.lenbits)-1],gt=Tt>>>16&255,yt=65535&Tt,!((_t=Tt>>>24)<=lt);){if(0===at)break t;at--,st+=tt[nt++]<<lt,lt+=8}if(yt<16)st>>>=_t,lt-=_t,n.lens[n.have++]=yt;else{if(16===yt){for(xt=_t+2;lt<xt;){if(0===at)break t;at--,st+=tt[nt++]<<lt,lt+=8}if(st>>>=_t,lt-=_t,0===n.have){t.msg="invalid bit length repeat",n.mode=H;break}Mt=n.lens[n.have-1],ft=3+(3&st),st>>>=2,lt-=2}else if(17===yt){for(xt=_t+3;lt<xt;){if(0===at)break t;at--,st+=tt[nt++]<<lt,lt+=8}lt-=_t,Mt=0,ft=3+(7&(st>>>=_t)),st>>>=3,lt-=3}else{for(xt=_t+7;lt<xt;){if(0===at)break t;at--,st+=tt[nt++]<<lt,lt+=8}lt-=_t,Mt=0,ft=11+(127&(st>>>=_t)),st>>>=7,lt-=7}if(n.have+ft>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=H;break}for(;ft--;)n.lens[n.have++]=Mt}}if(n.mode===H)break;if(0===n.lens[256]){t.msg="invalid code -- missing end-of-block",n.mode=H;break}if(n.lenbits=9,kt={bits:n.lenbits},At=s(h,n.lens,0,n.nlen,n.lencode,0,n.work,kt),n.lenbits=kt.bits,At){t.msg="invalid literal/lengths set",n.mode=H;break}if(n.distbits=6,n.distcode=n.distdyn,kt={bits:n.distbits},At=s(c,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,kt),n.distbits=kt.bits,At){t.msg="invalid distances set",n.mode=H;break}if(n.mode=N,e===f)break t;case N:n.mode=X;case X:if(at>=6&&ot>=258){t.next_out=it,t.avail_out=ot,t.next_in=nt,t.avail_in=at,n.hold=st,n.bits=lt,o(t,ct),it=t.next_out,et=t.output,ot=t.avail_out,nt=t.next_in,tt=t.input,at=t.avail_in,st=n.hold,lt=n.bits,n.mode===V&&(n.back=-1);break}for(n.back=0;Tt=n.lencode[st&(1<<n.lenbits)-1],gt=Tt>>>16&255,yt=65535&Tt,!((_t=Tt>>>24)<=lt);){if(0===at)break t;at--,st+=tt[nt++]<<lt,lt+=8}if(gt&&0==(240&gt)){for(wt=_t,bt=gt,vt=yt;Tt=n.lencode[vt+((st&(1<<wt+bt)-1)>>wt)],gt=Tt>>>16&255,yt=65535&Tt,!(wt+(_t=Tt>>>24)<=lt);){if(0===at)break t;at--,st+=tt[nt++]<<lt,lt+=8}st>>>=wt,lt-=wt,n.back+=wt}if(st>>>=_t,lt-=_t,n.back+=_t,n.length=yt,0===gt){n.mode=$;break}if(32&gt){n.back=-1,n.mode=V;break}if(64&gt){t.msg="invalid literal/length code",n.mode=H;break}n.extra=15&gt,n.mode=R;case R:if(n.extra){for(xt=n.extra;lt<xt;){if(0===at)break t;at--,st+=tt[nt++]<<lt,lt+=8}n.length+=st&(1<<n.extra)-1,st>>>=n.extra,lt-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=Z;case Z:for(;Tt=n.distcode[st&(1<<n.distbits)-1],gt=Tt>>>16&255,yt=65535&Tt,!((_t=Tt>>>24)<=lt);){if(0===at)break t;at--,st+=tt[nt++]<<lt,lt+=8}if(0==(240&gt)){for(wt=_t,bt=gt,vt=yt;Tt=n.distcode[vt+((st&(1<<wt+bt)-1)>>wt)],gt=Tt>>>16&255,yt=65535&Tt,!(wt+(_t=Tt>>>24)<=lt);){if(0===at)break t;at--,st+=tt[nt++]<<lt,lt+=8}st>>>=wt,lt-=wt,n.back+=wt}if(st>>>=_t,lt-=_t,n.back+=_t,64&gt){t.msg="invalid distance code",n.mode=H;break}n.offset=yt,n.extra=15&gt,n.mode=K;case K:if(n.extra){for(xt=n.extra;lt<xt;){if(0===at)break t;at--,st+=tt[nt++]<<lt,lt+=8}n.offset+=st&(1<<n.extra)-1,st>>>=n.extra,lt-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=H;break}n.mode=q;case q:if(0===ot)break t;if(ft=ct-ot,n.offset>ft){if((ft=n.offset-ft)>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=H;break}ft>n.wnext?(ft-=n.wnext,mt=n.wsize-ft):mt=n.wnext-ft,ft>n.length&&(ft=n.length),pt=n.window}else pt=et,mt=it-n.offset,ft=n.length;ft>ot&&(ft=ot),ot-=ft,n.length-=ft;do{et[it++]=pt[mt++]}while(--ft);0===n.length&&(n.mode=X);break;case $:if(0===ot)break t;et[it++]=n.length,ot--,n.mode=X;break;case j:if(n.wrap){for(;lt<32;){if(0===at)break t;at--,st|=tt[nt++]<<lt,lt+=8}if(ct-=ot,t.total_out+=ct,n.total+=ct,ct&&(t.adler=n.check=n.flags?a(n.check,et,ct,it-ct):i(n.check,et,ct,it-ct)),ct=ot,(n.flags?st:rt(st))!==n.check){t.msg="incorrect data check",n.mode=H;break}st=0,lt=0}n.mode=Q;case Q:if(n.wrap&&n.flags){for(;lt<32;){if(0===at)break t;at--,st+=tt[nt++]<<lt,lt+=8}if(st!==(4294967295&n.total)){t.msg="incorrect length check",n.mode=H;break}st=0,lt=0}n.mode=Y;case Y:At=p;break t;case H:At=y;break t;case W:return w;case J:default:return g}return t.next_out=it,t.avail_out=ot,t.next_in=nt,t.avail_in=at,n.hold=st,n.bits=lt,(n.wsize||ct!==t.avail_out&&n.mode<H&&(n.mode<j||e!==d))&&ut(t,t.output,t.next_out,ct-t.avail_out),ht-=t.avail_in,ct-=t.avail_out,t.total_in+=ht,t.total_out+=ct,n.total+=ct,n.wrap&&ct&&(t.adler=n.check=n.flags?a(n.check,et,ct,t.next_out-ct):i(n.check,et,ct,t.next_out-ct)),t.data_type=n.bits+(n.last?64:0)+(n.mode===V?128:0)+(n.mode===N||n.mode===L?256:0),(0===ht&&0===ct||e===d)&&At===m&&(At=b),At},n.inflateEnd=function(t){if(!t||!t.state)return g;var e=t.state;return e.window&&(e.window=null),t.state=null,m},n.inflateGetHeader=function(t,e){var n;return t&&t.state?0==(2&(n=t.state).wrap)?g:(n.head=e,e.done=!1,m):g},n.inflateSetDictionary=function(t,e){var n,r=e.length;return t&&t.state?0!==(n=t.state).wrap&&n.mode!==S?g:n.mode===S&&i(1,e,r,0)!==n.check?y:ut(t,e,r,r)?(n.mode=W,w):(n.havedict=1,m):g},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":3,"./adler32":5,"./crc32":7,"./inffast":10,"./inftrees":12}],12:[function(t,e,n){var r=t("../utils/common"),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(t,e,n,l,h,c,d,u){var f,m,p,_,g,y,w,b,v,M=u.bits,A=0,k=0,x=0,T=0,B=0,E=0,z=0,I=0,P=0,S=0,V=null,D=0,G=new r.Buf16(16),L=new r.Buf16(16),O=null,U=0;for(A=0;A<=15;A++)G[A]=0;for(k=0;k<l;k++)G[e[n+k]]++;for(B=M,T=15;T>=1&&0===G[T];T--);if(B>T&&(B=T),0===T)return h[c++]=20971520,h[c++]=20971520,u.bits=1,0;for(x=1;x<T&&0===G[x];x++);for(B<x&&(B=x),I=1,A=1;A<=15;A++)if(I<<=1,(I-=G[A])<0)return-1;if(I>0&&(0===t||1!==T))return-1;for(L[1]=0,A=1;A<15;A++)L[A+1]=L[A]+G[A];for(k=0;k<l;k++)0!==e[n+k]&&(d[L[e[n+k]]++]=k);if(0===t?(V=O=d,y=19):1===t?(V=i,D-=257,O=a,U-=257,y=256):(V=o,O=s,y=-1),S=0,k=0,A=x,g=c,E=B,z=0,p=-1,_=(P=1<<B)-1,1===t&&P>852||2===t&&P>592)return 1;for(;;){w=A-z,d[k]<y?(b=0,v=d[k]):d[k]>y?(b=O[U+d[k]],v=V[D+d[k]]):(b=96,v=0),f=1<<A-z,x=m=1<<E;do{h[g+(S>>z)+(m-=f)]=w<<24|b<<16|v|0}while(0!==m);for(f=1<<A-1;S&f;)f>>=1;if(0!==f?(S&=f-1,S+=f):S=0,k++,0==--G[A]){if(A===T)break;A=e[n+d[k]]}if(A>B&&(S&_)!==p){for(0===z&&(z=B),g+=x,I=1<<(E=A-z);E+z<T&&!((I-=G[E+z])<=0);)E++,I<<=1;if(P+=1<<E,1===t&&P>852||2===t&&P>592)return 1;h[p=S&_]=B<<24|E<<16|g-c|0}}return 0!==S&&(h[g+S]=A-z<<24|64<<16|0),u.bits=B,0}},{"../utils/common":3}],13:[function(t,e,n){e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],14:[function(t,e,n){var r=t("../utils/common"),i=4,a=0,o=1,s=2;function l(t){for(var e=t.length;--e>=0;)t[e]=0}var h=0,c=1,d=2,u=29,f=256,m=f+1+u,p=30,_=19,g=2*m+1,y=15,w=16,b=7,v=256,M=16,A=17,k=18,x=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],T=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],B=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],E=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],z=new Array(2*(m+2));l(z);var I=new Array(2*p);l(I);var P=new Array(512);l(P);var S=new Array(256);l(S);var V=new Array(u);l(V);var D,G,L,O=new Array(p);function U(t,e,n,r,i){this.static_tree=t,this.extra_bits=e,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=t&&t.length}function F(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function C(t){return t<256?P[t]:P[256+(t>>>7)]}function N(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function X(t,e,n){t.bi_valid>w-n?(t.bi_buf|=e<<t.bi_valid&65535,N(t,t.bi_buf),t.bi_buf=e>>w-t.bi_valid,t.bi_valid+=n-w):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=n)}function R(t,e,n){X(t,n[2*e],n[2*e+1])}function Z(t,e){var n=0;do{n|=1&t,t>>>=1,n<<=1}while(--e>0);return n>>>1}function K(t,e,n){var r,i,a=new Array(y+1),o=0;for(r=1;r<=y;r++)a[r]=o=o+n[r-1]<<1;for(i=0;i<=e;i++){var s=t[2*i+1];0!==s&&(t[2*i]=Z(a[s]++,s))}}function q(t){var e;for(e=0;e<m;e++)t.dyn_ltree[2*e]=0;for(e=0;e<p;e++)t.dyn_dtree[2*e]=0;for(e=0;e<_;e++)t.bl_tree[2*e]=0;t.dyn_ltree[2*v]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function $(t){t.bi_valid>8?N(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function j(t,e,n,r){var i=2*e,a=2*n;return t[i]<t[a]||t[i]===t[a]&&r[e]<=r[n]}function Q(t,e,n){for(var r=t.heap[n],i=n<<1;i<=t.heap_len&&(i<t.heap_len&&j(e,t.heap[i+1],t.heap[i],t.depth)&&i++,!j(e,r,t.heap[i],t.depth));)t.heap[n]=t.heap[i],n=i,i<<=1;t.heap[n]=r}function Y(t,e,n){var r,i,a,o,s=0;if(0!==t.last_lit)do{r=t.pending_buf[t.d_buf+2*s]<<8|t.pending_buf[t.d_buf+2*s+1],i=t.pending_buf[t.l_buf+s],s++,0===r?R(t,i,e):(a=S[i],R(t,a+f+1,e),0!==(o=x[a])&&(i-=V[a],X(t,i,o)),a=C(--r),R(t,a,n),0!==(o=T[a])&&(r-=O[a],X(t,r,o)))}while(s<t.last_lit);R(t,v,e)}function H(t,e){var n,r,i,a=e.dyn_tree,o=e.stat_desc.static_tree,s=e.stat_desc.has_stree,l=e.stat_desc.elems,h=-1;for(t.heap_len=0,t.heap_max=g,n=0;n<l;n++)0!==a[2*n]?(t.heap[++t.heap_len]=h=n,t.depth[n]=0):a[2*n+1]=0;for(;t.heap_len<2;)i=t.heap[++t.heap_len]=h<2?++h:0,a[2*i]=1,t.depth[i]=0,t.opt_len--,s&&(t.static_len-=o[2*i+1]);for(e.max_code=h,n=t.heap_len>>1;n>=1;n--)Q(t,a,n);i=l;do{n=t.heap[1],t.heap[1]=t.heap[t.heap_len--],Q(t,a,1),r=t.heap[1],t.heap[--t.heap_max]=n,t.heap[--t.heap_max]=r,a[2*i]=a[2*n]+a[2*r],t.depth[i]=(t.depth[n]>=t.depth[r]?t.depth[n]:t.depth[r])+1,a[2*n+1]=a[2*r+1]=i,t.heap[1]=i++,Q(t,a,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],function(t,e){var n,r,i,a,o,s,l=e.dyn_tree,h=e.max_code,c=e.stat_desc.static_tree,d=e.stat_desc.has_stree,u=e.stat_desc.extra_bits,f=e.stat_desc.extra_base,m=e.stat_desc.max_length,p=0;for(a=0;a<=y;a++)t.bl_count[a]=0;for(l[2*t.heap[t.heap_max]+1]=0,n=t.heap_max+1;n<g;n++)r=t.heap[n],(a=l[2*l[2*r+1]+1]+1)>m&&(a=m,p++),l[2*r+1]=a,r>h||(t.bl_count[a]++,o=0,r>=f&&(o=u[r-f]),s=l[2*r],t.opt_len+=s*(a+o),d&&(t.static_len+=s*(c[2*r+1]+o)));if(0!==p){do{for(a=m-1;0===t.bl_count[a];)a--;t.bl_count[a]--,t.bl_count[a+1]+=2,t.bl_count[m]--,p-=2}while(p>0);for(a=m;0!==a;a--)for(r=t.bl_count[a];0!==r;)(i=t.heap[--n])>h||(l[2*i+1]!==a&&(t.opt_len+=(a-l[2*i+1])*l[2*i],l[2*i+1]=a),r--)}}(t,e),K(a,h,t.bl_count)}function W(t,e,n){var r,i,a=-1,o=e[1],s=0,l=7,h=4;for(0===o&&(l=138,h=3),e[2*(n+1)+1]=65535,r=0;r<=n;r++)i=o,o=e[2*(r+1)+1],++s<l&&i===o||(s<h?t.bl_tree[2*i]+=s:0!==i?(i!==a&&t.bl_tree[2*i]++,t.bl_tree[2*M]++):s<=10?t.bl_tree[2*A]++:t.bl_tree[2*k]++,s=0,a=i,0===o?(l=138,h=3):i===o?(l=6,h=3):(l=7,h=4))}function J(t,e,n){var r,i,a=-1,o=e[1],s=0,l=7,h=4;for(0===o&&(l=138,h=3),r=0;r<=n;r++)if(i=o,o=e[2*(r+1)+1],!(++s<l&&i===o)){if(s<h)do{R(t,i,t.bl_tree)}while(0!=--s);else 0!==i?(i!==a&&(R(t,i,t.bl_tree),s--),R(t,M,t.bl_tree),X(t,s-3,2)):s<=10?(R(t,A,t.bl_tree),X(t,s-3,3)):(R(t,k,t.bl_tree),X(t,s-11,7));s=0,a=i,0===o?(l=138,h=3):i===o?(l=6,h=3):(l=7,h=4)}}l(O);var tt=!1;function et(t,e,n,i){X(t,(h<<1)+(i?1:0),3),function(t,e,n,i){$(t),i&&(N(t,n),N(t,~n)),r.arraySet(t.pending_buf,t.window,e,n,t.pending),t.pending+=n}(t,e,n,!0)}n._tr_init=function(t){tt||(function(){var t,e,n,r,i,a=new Array(y+1);for(n=0,r=0;r<u-1;r++)for(V[r]=n,t=0;t<1<<x[r];t++)S[n++]=r;for(S[n-1]=r,i=0,r=0;r<16;r++)for(O[r]=i,t=0;t<1<<T[r];t++)P[i++]=r;for(i>>=7;r<p;r++)for(O[r]=i<<7,t=0;t<1<<T[r]-7;t++)P[256+i++]=r;for(e=0;e<=y;e++)a[e]=0;for(t=0;t<=143;)z[2*t+1]=8,t++,a[8]++;for(;t<=255;)z[2*t+1]=9,t++,a[9]++;for(;t<=279;)z[2*t+1]=7,t++,a[7]++;for(;t<=287;)z[2*t+1]=8,t++,a[8]++;for(K(z,m+1,a),t=0;t<p;t++)I[2*t+1]=5,I[2*t]=Z(t,5);D=new U(z,x,f+1,m,y),G=new U(I,T,0,p,y),L=new U(new Array(0),B,0,_,b)}(),tt=!0),t.l_desc=new F(t.dyn_ltree,D),t.d_desc=new F(t.dyn_dtree,G),t.bl_desc=new F(t.bl_tree,L),t.bi_buf=0,t.bi_valid=0,q(t)},n._tr_stored_block=et,n._tr_flush_block=function(t,e,n,r){var l,h,u=0;t.level>0?(t.strm.data_type===s&&(t.strm.data_type=function(t){var e,n=4093624447;for(e=0;e<=31;e++,n>>>=1)if(1&n&&0!==t.dyn_ltree[2*e])return a;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return o;for(e=32;e<f;e++)if(0!==t.dyn_ltree[2*e])return o;return a}(t)),H(t,t.l_desc),H(t,t.d_desc),u=function(t){var e;for(W(t,t.dyn_ltree,t.l_desc.max_code),W(t,t.dyn_dtree,t.d_desc.max_code),H(t,t.bl_desc),e=_-1;e>=3&&0===t.bl_tree[2*E[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),l=t.opt_len+3+7>>>3,(h=t.static_len+3+7>>>3)<=l&&(l=h)):l=h=n+5,n+4<=l&&-1!==e?et(t,e,n,r):t.strategy===i||h===l?(X(t,(c<<1)+(r?1:0),3),Y(t,z,I)):(X(t,(d<<1)+(r?1:0),3),function(t,e,n,r){var i;for(X(t,e-257,5),X(t,n-1,5),X(t,r-4,4),i=0;i<r;i++)X(t,t.bl_tree[2*E[i]+1],3);J(t,t.dyn_ltree,e-1),J(t,t.dyn_dtree,n-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,u+1),Y(t,t.dyn_ltree,t.dyn_dtree)),q(t),r&&$(t)},n._tr_tally=function(t,e,n){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&n,t.last_lit++,0===e?t.dyn_ltree[2*n]++:(t.matches++,e--,t.dyn_ltree[2*(S[n]+f+1)]++,t.dyn_dtree[2*C(e)]++),t.last_lit===t.lit_bufsize-1},n._tr_align=function(t){X(t,c<<1,3),R(t,v,z),function(t){16===t.bi_valid?(N(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(t)}},{"../utils/common":3}],15:[function(t,e,n){e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],"/":[function(t,e,n){var r=t("./lib/utils/common").assign,i=t("./lib/deflate"),a=t("./lib/inflate"),o=t("./lib/zlib/constants"),s={};r(s,i,a,o),e.exports=s},{"./lib/deflate":1,"./lib/inflate":2,"./lib/utils/common":3,"./lib/zlib/constants":6}]},{},[])("/")}),p=Object.freeze({__proto__:null,default:pako$1,__moduleExports:pako$1});let pako$2=p;pako$2.inflate||(pako$2=pako$2.default);const XKT_VERSION=7;function writeXKTModelToArrayBuffer(t){return createArrayBuffer(deflateData(getModelData(t)))}function getModelData(t){const e=t.geometriesList,n=t.meshesList,r=t.entitiesList,i=t.tilesList,a=e.length,o=n.length,s=r.length,l=i.length;let h=0,c=0,d=0,u=0,f=0,m=0;for(let t=0;t<a;t++){const n=e[t];n.positionsQuantized&&(h+=n.positionsQuantized.length),n.normalsOctEncoded&&(c+=n.normalsOctEncoded.length),n.colorsCompressed&&(d+=n.colorsCompressed.length),n.indices&&(u+=n.indices.length),n.edgeIndices&&(f+=n.edgeIndices.length)}for(let t=0;t<o;t++){n[t].geometry.numInstances>1&&(m+=16)}const p={positions:new Uint16Array(h),normals:new Int8Array(c),colors:new Uint8Array(d),indices:new Uint32Array(u),edgeIndices:new Uint32Array(f),matrices:new Float32Array(m),reusedGeometriesDecodeMatrix:new Float32Array(t.reusedGeometriesDecodeMatrix),eachGeometryPrimitiveType:new Uint8Array(a),eachGeometryPositionsPortion:new Uint32Array(a),eachGeometryNormalsPortion:new Uint32Array(a),eachGeometryColorsPortion:new Uint32Array(a),eachGeometryIndicesPortion:new Uint32Array(a),eachGeometryEdgeIndicesPortion:new Uint32Array(a),eachMeshGeometriesPortion:new Uint32Array(o),eachMeshMatricesPortion:new Uint32Array(o),eachMeshMaterial:new Uint8Array(6*o),eachEntityId:[],eachEntityMeshesPortion:new Uint32Array(s),eachTileAABB:new Float64Array(6*l),eachTileEntitiesPortion:new Uint32Array(l)};let _=0,g=0,y=0,w=0,b=0,v=0,M=0;for(let t=0;t<a;t++){const n=e[t],r="triangles"===n.primitiveType?n.solid?0:1:"points"===n.primitiveType?2:3;p.eachGeometryPrimitiveType[t]=r,p.eachGeometryPositionsPortion[t]=_,p.eachGeometryNormalsPortion[t]=g,p.eachGeometryColorsPortion[t]=y,p.eachGeometryIndicesPortion[t]=w,p.eachGeometryEdgeIndicesPortion[t]=b,n.positionsQuantized&&(p.positions.set(n.positionsQuantized,_),_+=n.positionsQuantized.length),n.normalsOctEncoded&&(p.normals.set(n.normalsOctEncoded,g),g+=n.normalsOctEncoded.length),n.colorsCompressed&&(p.colors.set(n.colorsCompressed,y),y+=n.colorsCompressed.length),n.indices&&(p.indices.set(n.indices,w),w+=n.indices.length),n.edgeIndices&&(p.edgeIndices.set(n.edgeIndices,b),b+=n.edgeIndices.length)}for(let t=0;t<o;t++){const e=n[t];e.geometry.numInstances>1&&(p.matrices.set(e.matrix,M),p.eachMeshMatricesPortion[t]=M,M+=16),p.eachMeshMaterial[v+0]=Math.floor(255*e.color[0]),p.eachMeshMaterial[v+1]=Math.floor(255*e.color[1]),p.eachMeshMaterial[v+2]=Math.floor(255*e.color[2]),p.eachMeshMaterial[v+3]=Math.floor(255*e.opacity),p.eachMeshMaterial[v+4]=Math.floor(255*e.metallic),p.eachMeshMaterial[v+5]=Math.floor(255*e.roughness),v+=6}let A=0,k=0;for(let t=0;t<l;t++){const e=i[t],n=e.entities,r=n.length;if(0===r)continue;p.eachTileEntitiesPortion[t]=A;const a=e.aabb;for(let t=0;t<r;t++){const e=n[t],r=e.meshes,i=r.length;if(0!==i){for(let t=0;t<i;t++){const e=r[t].geometry.geometryIndex;p.eachMeshGeometriesPortion[k+t]=e}p.eachEntityId[A]=e.entityId,p.eachEntityMeshesPortion[A]=k,A++,k+=i}}const o=6*t;p.eachTileAABB.set(a,o)}return p}function deflateData(t){return{positions:pako$2.deflate(t.positions.buffer),normals:pako$2.deflate(t.normals.buffer),colors:pako$2.deflate(t.colors.buffer),indices:pako$2.deflate(t.indices.buffer),edgeIndices:pako$2.deflate(t.edgeIndices.buffer),matrices:pako$2.deflate(t.matrices.buffer),reusedGeometriesDecodeMatrix:pako$2.deflate(t.reusedGeometriesDecodeMatrix.buffer),eachGeometryPrimitiveType:pako$2.deflate(t.eachGeometryPrimitiveType.buffer),eachGeometryPositionsPortion:pako$2.deflate(t.eachGeometryPositionsPortion.buffer),eachGeometryNormalsPortion:pako$2.deflate(t.eachGeometryNormalsPortion.buffer),eachGeometryColorsPortion:pako$2.deflate(t.eachGeometryColorsPortion.buffer),eachGeometryIndicesPortion:pako$2.deflate(t.eachGeometryIndicesPortion.buffer),eachGeometryEdgeIndicesPortion:pako$2.deflate(t.eachGeometryEdgeIndicesPortion.buffer),eachMeshGeometriesPortion:pako$2.deflate(t.eachMeshGeometriesPortion.buffer),eachMeshMatricesPortion:pako$2.deflate(t.eachMeshMatricesPortion.buffer),eachMeshMaterial:pako$2.deflate(t.eachMeshMaterial.buffer),eachEntityId:pako$2.deflate(JSON.stringify(t.eachEntityId).replace(/[\u007F-\uFFFF]/g,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).substr(-4)})),eachEntityMeshesPortion:pako$2.deflate(t.eachEntityMeshesPortion.buffer),eachTileAABB:pako$2.deflate(t.eachTileAABB.buffer),eachTileEntitiesPortion:pako$2.deflate(t.eachTileEntitiesPortion.buffer)}}function createArrayBuffer(t){return toArrayBuffer([t.positions,t.normals,t.colors,t.indices,t.edgeIndices,t.matrices,t.reusedGeometriesDecodeMatrix,t.eachGeometryPrimitiveType,t.eachGeometryPositionsPortion,t.eachGeometryNormalsPortion,t.eachGeometryColorsPortion,t.eachGeometryIndicesPortion,t.eachGeometryEdgeIndicesPortion,t.eachMeshGeometriesPortion,t.eachMeshMatricesPortion,t.eachMeshMaterial,t.eachEntityId,t.eachEntityMeshesPortion,t.eachTileAABB,t.eachTileEntitiesPortion])}function toArrayBuffer(t){const e=new Uint32Array(t.length+2);e[0]=XKT_VERSION,e[1]=t.length;let n=0;for(let r=0,i=t.length;r<i;r++){const i=t[r].length;e[r+2]=i,n+=i}const r=new Uint8Array(e.buffer),i=new Uint8Array(r.length+n);i.set(r);let a=r.length;for(let e=0,n=t.length;e<n;e++){const n=t[e];i.set(n,a),a+=n.length}return console.log("Array buffer size: "+(i.length/1024).toFixed(3)+" kB"),i.buffer}function isString(t){return"string"==typeof t||t instanceof String}const utils={isString:isString};let atob2;if("undefined"==typeof atob){const t=require("atob");atob2=t}else atob2=atob;const WEBGL_COMPONENT_TYPES={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},WEBGL_TYPE_SIZES={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};async function parseGLTFIntoXKTModel(t,e,n){const r={gltf:t,getAttachment:n||(()=>{throw new Error("You must define getAttachment() method to convert glTF with external resources")}),xktModel:e,geometryCreated:{},nextGeometryId:0,nextMeshId:0,nextDefaultEntityId:0};await parseBuffers(r),parseBufferViews(r),freeBuffers(r),parseMaterials(r),parseDefaultScene(r)}async function parseBuffers(t){const e=t.gltf.buffers;e&&await Promise.all(e.map(e=>parseBuffer(t,e)))}async function parseBuffer(t,e){const n=e.uri;if(!n)throw new Error("gltf/handleBuffer missing uri in "+JSON.stringify(e));e._buffer=await parseArrayBuffer(t,n)}async function parseArrayBuffer(t,e){const n=e.match(/^data:(.*?)(;base64)?,(.*)$/);if(n){const t=!!n[2];let e=n[3];e=decodeURIComponent(e),t&&(e=atob2(e));const r=new ArrayBuffer(e.length),i=new Uint8Array(r);for(let t=0;t<e.length;t++)i[t]=e.charCodeAt(t);return r}return await t.getAttachment(e)}function parseBufferViews(t){const e=t.gltf.bufferViews;if(e)for(let n=0,r=e.length;n<r;n++)parseBufferView(t,e[n])}function parseBufferView(t,e){const n=t.gltf.buffers[e.buffer];e._typedArray=null;const r=e.byteLength||0,i=e.byteOffset||0;e._buffer=n._buffer.slice(i,i+r)}function freeBuffers(t){const e=t.gltf.buffers;if(e)for(let t=0,n=e.length;t<n;t++)e[t]._buffer=null}function parseMaterials(t){const e=t.gltf.materials;if(e)for(let n=0,r=e.length;n<r;n++){const r=e[n],i=parseMaterial(t,r);r._materialData=i}}function parseMaterial(t,e){const n={color:new Float32Array([1,1,1]),opacity:1,metallic:0,roughness:1},r=e.extensions;if(r){const t=r.KHR_materials_pbrSpecularGlossiness;if(t){const e=t.diffuseFactor;null!==e&&void 0!==e&&(n.color[0]=e[0],n.color[1]=e[1],n.color[2]=e[2])}const e=r.KHR_materials_common;if(e){const t=e.technique,r=e.values||{},i="BLINN"===t,a="PHONG"===t,o="LAMBERT"===t,s=r.diffuse;s&&(i||a||o)&&(utils.isString(s)||(n.color[0]=s[0],n.color[1]=s[1],n.color[2]=s[2]));const l=r.transparency;null!==l&&void 0!==l&&(n.opacity=l);const h=r.transparent;null!==h&&void 0!==h&&(n.opacity=h)}}const i=e.pbrMetallicRoughness;if(i){const t=i.baseColorFactor;t&&(n.color[0]=t[0],n.color[1]=t[1],n.color[2]=t[2],n.opacity=t[3]);const e=i.metallicFactor;null!==e&&void 0!==e&&(n.metallic=e);const r=i.roughnessFactor;null!==r&&void 0!==r&&(n.roughness=r)}return n}function parseDefaultScene(t){const e=t.gltf.scene||0,n=t.gltf.scenes[e];if(!n)throw new Error("glTF has no default scene");parseScene(t,n)}function parseScene(t,e){const n=e.nodes;if(n)for(let e=0,r=n.length;e<r;e++){const r=t.gltf.nodes[n[e]];r&&parseNode(t,r,null)}}function parseNode(t,e,n){const r=t.gltf,i=t.xktModel;let a;e.matrix&&(a=e.matrix,n=n?math.mulMat4(n,a,math.mat4()):a),e.translation&&(a=math.translationMat4v(e.translation),n=n?math.mulMat4(n,a,a):a),e.rotation&&(a=math.quaternionToMat4(e.rotation),n=n?math.mulMat4(n,a,a):a),e.scale&&(a=math.scalingMat4v(e.scale),n=n?math.mulMat4(n,a,a):a);const o=e.mesh;if(void 0!==o){const a=r.meshes[o];if(a){const o=a.primitives.length;if(o>0){const s=[];for(let e=0;e<o;e++){const o=a.primitives[e],l=o.material,h=null!==l&&void 0!==l?r.materials[l]:null,c=h?h._materialData.color:new Float32Array([1,1,1,1]),d=h?h._materialData.opacity:1,u=h?h._materialData.metallic:0,f=h?h._materialData.roughness:1,m=createPrimitiveGeometryHash(o);if(!t.geometryCreated[m]){const e={};parsePrimitiveGeometry(t,o,e);const n=e.colors;let r;if(e.colors){r=[];for(let t=0,e=n.length;t<e;t+=4)r.push(Math.floor(255*n[t+0])),r.push(Math.floor(255*n[t+1])),r.push(Math.floor(255*n[t+2]))}i.createGeometry({geometryId:m,primitiveType:e.primitive,positions:e.positions,normals:e.normals,colorsCompressed:r,indices:e.indices}),t.geometryCreated[m]=!0}const p=t.nextMeshId++;i.createMesh({meshId:p,geometryId:m,matrix:n?n.slice():null,color:c,opacity:d,metallic:u,roughness:f}),s.push(p)}const l=e.name||"entity"+t.nextDefaultEntityId++;i.createEntity({entityId:l,meshIds:s})}}}if(e.children){const i=e.children;for(let e=0,a=i.length;e<a;e++){const a=i[e],o=r.nodes[a];o?parseNode(t,o,n):console.warn("Node not found: "+e)}}}function createPrimitiveGeometryHash(t){return t.attributes?[t.mode,null!==t.indices&&void 0!==t.indices?t.indices:"-",null!==t.positions&&void 0!==t.positions?t.positions:"-",null!==t.normals&&void 0!==t.normals?t.normals:"-",null!==t.colors&&void 0!==t.colors?t.colors:"-"].join(";"):"empty"}function parsePrimitiveGeometry(t,e,n){const r=e.attributes;if(!r)return;switch(e.mode){case 0:n.primitive="points";break;case 1:case 2:case 3:n.primitive="lines";break;case 4:case 5:case 6:n.primitive="triangles"}const i=t.gltf.accessors,a=e.indices;if(null!==a&&void 0!==a){const e=i[a];n.indices=parseAccessorTypedArray(t,e)}const o=r.POSITION;if(null!==o&&void 0!==o){const e=i[o];n.positions=parseAccessorTypedArray(t,e)}const s=r.NORMAL;if(null!==s&&void 0!==s){const e=i[s];n.normals=parseAccessorTypedArray(t,e)}const l=r.COLOR_0;if(null!==l&&void 0!==l){const e=i[l];n.colors=parseAccessorTypedArray(t,e)}}function parseAccessorTypedArray(t,e){const n=t.gltf.bufferViews[e.bufferView],r=WEBGL_TYPE_SIZES[e.type],i=WEBGL_COMPONENT_TYPES[e.componentType],a=i.BYTES_PER_ELEMENT*r;if(e.byteStride&&e.byteStride!==a)throw new Error("interleaved buffer!");return new i(n._buffer,e.byteOffset||0,e.count*r)}function buildBoxGeometry(t={}){let e=t.xSize||1;e<0&&(console.error("negative xSize not allowed - will invert"),e*=-1);let n=t.ySize||1;n<0&&(console.error("negative ySize not allowed - will invert"),n*=-1);let r=t.zSize||1;r<0&&(console.error("negative zSize not allowed - will invert"),r*=-1);const i=t.center,a=i?i[0]:0,o=i?i[1]:0,s=i?i[2]:0,l=-e+a,h=-n+o,c=-r+s,d=e+a,u=n+o,f=r+s;return{primitiveType:"triangles",positions:[d,u,f,l,u,f,l,h,f,d,h,f,d,u,f,d,h,f,d,h,c,d,u,c,d,u,f,d,u,c,l,u,c,l,u,f,l,u,f,l,u,c,l,h,c,l,h,f,l,h,c,d,h,c,d,h,f,l,h,f,d,h,c,l,h,c,l,u,c,d,u,c],normals:[0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1],uv:[1,0,0,0,0,1,1,1,0,0,0,1,1,1,1,0,1,1,1,0,0,0,0,1,1,0,0,0,0,1,1,1,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0],indices:[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]}}function buildBoxLinesGeometry(t={}){let e=t.xSize||1;e<0&&(console.error("negative xSize not allowed - will invert"),e*=-1);let n=t.ySize||1;n<0&&(console.error("negative ySize not allowed - will invert"),n*=-1);let r=t.zSize||1;r<0&&(console.error("negative zSize not allowed - will invert"),r*=-1);const i=t.center,a=i?i[0]:0,o=i?i[1]:0,s=i?i[2]:0,l=-e+a,h=-n+o,c=-r+s,d=e+a,u=n+o,f=r+s;return{primitiveType:"lines",positions:[l,h,c,l,h,f,l,u,c,l,u,f,d,h,c,d,h,f,d,u,c,d,u,f],indices:[0,1,1,3,3,2,2,0,4,5,5,7,7,6,6,4,0,4,1,5,2,6,3,7]}}function buildCylinderGeometry(t={}){let e=t.radiusTop||1;e<0&&(console.error("negative radiusTop not allowed - will invert"),e*=-1);let n=t.radiusBottom||1;n<0&&(console.error("negative radiusBottom not allowed - will invert"),n*=-1);let r=t.height||1;r<0&&(console.error("negative height not allowed - will invert"),r*=-1);let i=t.radialSegments||32;i<0&&(console.error("negative radialSegments not allowed - will invert"),i*=-1),i<3&&(i=3);let a=t.heightSegments||1;a<0&&(console.error("negative heightSegments not allowed - will invert"),a*=-1),a<1&&(a=1);const o=!!t.openEnded;let s=t.center;const l=s?s[0]:0,h=s?s[1]:0,c=s?s[2]:0,d=r/2,u=r/a,f=2*Math.PI/i,m=1/i,p=(e-n)/a,_=[],g=[],y=[],w=[];let b,v,M,A,k,x,T,B,E,z,I;const P=(90-180*Math.atan(r/(n-e))/Math.PI)/90;for(b=0;b<=a;b++)for(k=e-b*p,x=d-b*u,v=0;v<=i;v++)M=Math.sin(v*f),A=Math.cos(v*f),g.push(k*M),g.push(P),g.push(k*A),y.push(v*m),y.push(1*b/a),_.push(k*M+l),_.push(x+h),_.push(k*A+c);for(b=0;b<a;b++)for(v=0;v<=i;v++)B=(T=b*(i+1)+v)+i,w.push(T),w.push(B),w.push(B+1),w.push(T),w.push(B+1),w.push(T+1);if(!o&&e>0){for(E=_.length/3,g.push(0),g.push(1),g.push(0),y.push(.5),y.push(.5),_.push(0+l),_.push(d+h),_.push(0+c),v=0;v<=i;v++)M=Math.sin(v*f),A=Math.cos(v*f),z=.5*Math.sin(v*f)+.5,I=.5*Math.cos(v*f)+.5,g.push(e*M),g.push(1),g.push(e*A),y.push(z),y.push(I),_.push(e*M+l),_.push(d+h),_.push(e*A+c);for(v=0;v<i;v++)s=E,T=E+1+v,w.push(T),w.push(T+1),w.push(s)}if(!o&&n>0){for(E=_.length/3,g.push(0),g.push(-1),g.push(0),y.push(.5),y.push(.5),_.push(0+l),_.push(0-d+h),_.push(0+c),v=0;v<=i;v++)M=Math.sin(v*f),A=Math.cos(v*f),z=.5*Math.sin(v*f)+.5,I=.5*Math.cos(v*f)+.5,g.push(n*M),g.push(-1),g.push(n*A),y.push(z),y.push(I),_.push(n*M+l),_.push(0-d+h),_.push(n*A+c);for(v=0;v<i;v++)s=E,T=E+1+v,w.push(s),w.push(T+1),w.push(T)}return{primitiveType:"triangles",positions:_,normals:g,uv:y,indices:w}}function buildGridGeometry(t={}){let e=t.size||1;e<0&&(console.error("negative size not allowed - will invert"),e*=-1);let n=t.divisions||1;n<0&&(console.error("negative divisions not allowed - will invert"),n*=-1),n<1&&(n=1);const r=(e=e||10)/(n=n||10),i=e/2,a=[],o=[];let s=0;for(let t=0,e=-i;t<=n;t++,e+=r)a.push(-i),a.push(0),a.push(e),a.push(i),a.push(0),a.push(e),a.push(e),a.push(0),a.push(-i),a.push(e),a.push(0),a.push(i),o.push(s++),o.push(s++),o.push(s++),o.push(s++);return{primitiveType:"lines",positions:a,indices:o}}function buildPlaneGeometry(t={}){let e=t.xSize||1;e<0&&(console.error("negative xSize not allowed - will invert"),e*=-1);let n=t.zSize||1;n<0&&(console.error("negative zSize not allowed - will invert"),n*=-1);let r=t.xSegments||1;r<0&&(console.error("negative xSegments not allowed - will invert"),r*=-1),r<1&&(r=1);let i=t.xSegments||1;i<0&&(console.error("negative zSegments not allowed - will invert"),i*=-1),i<1&&(i=1);const a=t.center,o=a?a[0]:0,s=a?a[1]:0,l=a?a[2]:0,h=e/2,c=n/2,d=Math.floor(r)||1,u=Math.floor(i)||1,f=d+1,m=u+1,p=e/d,_=n/u,g=new Float32Array(f*m*3),y=new Float32Array(f*m*3),w=new Float32Array(f*m*2);let b,v,M,A,k,x,T,B=0,E=0;for(b=0;b<m;b++){const t=b*_-c;for(v=0;v<f;v++)M=v*p-h,g[B]=M+o,g[B+1]=s,g[B+2]=-t+l,y[B+2]=-1,w[E]=v/d,w[E+1]=(u-b)/u,B+=3,E+=2}B=0;const z=new(g.length/3>65535?Uint32Array:Uint16Array)(d*u*6);for(b=0;b<u;b++)for(v=0;v<d;v++)A=v+f*b,k=v+f*(b+1),x=v+1+f*(b+1),T=v+1+f*b,z[B]=T,z[B+1]=k,z[B+2]=A,z[B+3]=T,z[B+4]=x,z[B+5]=k,B+=6;return{primitiveType:"triangles",positions:g,normals:y,uv:w,indices:z}}function buildSphereGeometry(t={}){const e=t.lod||1,n=t.center?t.center[0]:0,r=t.center?t.center[1]:0,i=t.center?t.center[2]:0;let a=t.radius||1;a<0&&(console.error("negative radius not allowed - will invert"),a*=-1);let o=t.heightSegments||18;o<0&&(console.error("negative heightSegments not allowed - will invert"),o*=-1),(o=Math.floor(e*o))<18&&(o=18);let s=t.widthSegments||18;s<0&&(console.error("negative widthSegments not allowed - will invert"),s*=-1),(s=Math.floor(e*s))<18&&(s=18);const l=[],h=[],c=[],d=[];let u,f,m,p,_,g,y,w,b,v,M,A,k,x,T;for(u=0;u<=o;u++)for(m=u*Math.PI/o,p=Math.sin(m),_=Math.cos(m),f=0;f<=s;f++)g=2*f*Math.PI/s,y=Math.sin(g),b=(w=Math.cos(g))*p,v=_,M=y*p,A=1-f/s,k=u/o,h.push(b),h.push(v),h.push(M),c.push(A),c.push(k),l.push(n+a*b),l.push(r+a*v),l.push(i+a*M);for(u=0;u<o;u++)for(f=0;f<s;f++)T=(x=u*(s+1)+f)+s+1,d.push(x+1),d.push(T+1),d.push(T),d.push(x+1),d.push(T),d.push(x);return{primitiveType:"triangles",positions:l,normals:h,uv:c,indices:d}}function buildTorusGeometry(t={}){let e=t.radius||1;e<0&&(console.error("negative radius not allowed - will invert"),e*=-1),e*=.5;let n=t.tube||.3;n<0&&(console.error("negative tube not allowed - will invert"),n*=-1);let r=t.radialSegments||32;r<0&&(console.error("negative radialSegments not allowed - will invert"),r*=-1),r<4&&(r=4);let i=t.tubeSegments||24;i<0&&(console.error("negative tubeSegments not allowed - will invert"),i*=-1),i<4&&(i=4);let a=t.arc||2*Math.PI;a<0&&(console.warn("negative arc not allowed - will invert"),a*=-1),a>360&&(a=360);const o=t.center;let s=o?o[0]:0,l=o?o[1]:0;const h=o?o[2]:0,c=[],d=[],u=[],f=[];let m,p,_,g,y,w,b,v,M,A,k,x;for(v=0;v<=i;v++)for(b=0;b<=r;b++)m=b/r*a,p=.785398+v/i*Math.PI*2,s=e*Math.cos(m),l=e*Math.sin(m),_=(e+n*Math.cos(p))*Math.cos(m),g=(e+n*Math.cos(p))*Math.sin(m),y=n*Math.sin(p),c.push(_+s),c.push(g+l),c.push(y+h),u.push(1-b/r),u.push(v/i),w=math.normalizeVec3(math.subVec3([_,g,y],[s,l,h],[]),[]),d.push(w[0]),d.push(w[1]),d.push(w[2]);for(v=1;v<=i;v++)for(b=1;b<=r;b++)M=(r+1)*v+b-1,A=(r+1)*(v-1)+b-1,k=(r+1)*(v-1)+b,x=(r+1)*v+b,f.push(M),f.push(A),f.push(k),f.push(k),f.push(x),f.push(M);return{primitiveType:"triangles",positions:c,normals:d,uv:u,indices:f}}const letters={" ":{width:16,points:[]},"!":{width:10,points:[[5,21],[5,7],[-1,-1],[5,2],[4,1],[5,0],[6,1],[5,2]]},'"':{width:16,points:[[4,21],[4,14],[-1,-1],[12,21],[12,14]]},"#":{width:21,points:[[11,25],[4,-7],[-1,-1],[17,25],[10,-7],[-1,-1],[4,12],[18,12],[-1,-1],[3,6],[17,6]]},$:{width:20,points:[[8,25],[8,-4],[-1,-1],[12,25],[12,-4],[-1,-1],[17,18],[15,20],[12,21],[8,21],[5,20],[3,18],[3,16],[4,14],[5,13],[7,12],[13,10],[15,9],[16,8],[17,6],[17,3],[15,1],[12,0],[8,0],[5,1],[3,3]]},"%":{width:24,points:[[21,21],[3,0],[-1,-1],[8,21],[10,19],[10,17],[9,15],[7,14],[5,14],[3,16],[3,18],[4,20],[6,21],[8,21],[10,20],[13,19],[16,19],[19,20],[21,21],[-1,-1],[17,7],[15,6],[14,4],[14,2],[16,0],[18,0],[20,1],[21,3],[21,5],[19,7],[17,7]]},"&":{width:26,points:[[23,12],[23,13],[22,14],[21,14],[20,13],[19,11],[17,6],[15,3],[13,1],[11,0],[7,0],[5,1],[4,2],[3,4],[3,6],[4,8],[5,9],[12,13],[13,14],[14,16],[14,18],[13,20],[11,21],[9,20],[8,18],[8,16],[9,13],[11,10],[16,3],[18,1],[20,0],[22,0],[23,1],[23,2]]},"'":{width:10,points:[[5,19],[4,20],[5,21],[6,20],[6,18],[5,16],[4,15]]},"(":{width:14,points:[[11,25],[9,23],[7,20],[5,16],[4,11],[4,7],[5,2],[7,-2],[9,-5],[11,-7]]},")":{width:14,points:[[3,25],[5,23],[7,20],[9,16],[10,11],[10,7],[9,2],[7,-2],[5,-5],[3,-7]]},"*":{width:16,points:[[8,21],[8,9],[-1,-1],[3,18],[13,12],[-1,-1],[13,18],[3,12]]},"+":{width:26,points:[[13,18],[13,0],[-1,-1],[4,9],[22,9]]},",":{width:10,points:[[6,1],[5,0],[4,1],[5,2],[6,1],[6,-1],[5,-3],[4,-4]]},"-":{width:26,points:[[4,9],[22,9]]},".":{width:10,points:[[5,2],[4,1],[5,0],[6,1],[5,2]]},"/":{width:22,points:[[20,25],[2,-7]]},0:{width:20,points:[[9,21],[6,20],[4,17],[3,12],[3,9],[4,4],[6,1],[9,0],[11,0],[14,1],[16,4],[17,9],[17,12],[16,17],[14,20],[11,21],[9,21]]},1:{width:20,points:[[6,17],[8,18],[11,21],[11,0]]},2:{width:20,points:[[4,16],[4,17],[5,19],[6,20],[8,21],[12,21],[14,20],[15,19],[16,17],[16,15],[15,13],[13,10],[3,0],[17,0]]},3:{width:20,points:[[5,21],[16,21],[10,13],[13,13],[15,12],[16,11],[17,8],[17,6],[16,3],[14,1],[11,0],[8,0],[5,1],[4,2],[3,4]]},4:{width:20,points:[[13,21],[3,7],[18,7],[-1,-1],[13,21],[13,0]]},5:{width:20,points:[[15,21],[5,21],[4,12],[5,13],[8,14],[11,14],[14,13],[16,11],[17,8],[17,6],[16,3],[14,1],[11,0],[8,0],[5,1],[4,2],[3,4]]},6:{width:20,points:[[16,18],[15,20],[12,21],[10,21],[7,20],[5,17],[4,12],[4,7],[5,3],[7,1],[10,0],[11,0],[14,1],[16,3],[17,6],[17,7],[16,10],[14,12],[11,13],[10,13],[7,12],[5,10],[4,7]]},7:{width:20,points:[[17,21],[7,0],[-1,-1],[3,21],[17,21]]},8:{width:20,points:[[8,21],[5,20],[4,18],[4,16],[5,14],[7,13],[11,12],[14,11],[16,9],[17,7],[17,4],[16,2],[15,1],[12,0],[8,0],[5,1],[4,2],[3,4],[3,7],[4,9],[6,11],[9,12],[13,13],[15,14],[16,16],[16,18],[15,20],[12,21],[8,21]]},9:{width:20,points:[[16,14],[15,11],[13,9],[10,8],[9,8],[6,9],[4,11],[3,14],[3,15],[4,18],[6,20],[9,21],[10,21],[13,20],[15,18],[16,14],[16,9],[15,4],[13,1],[10,0],[8,0],[5,1],[4,3]]},":":{width:10,points:[[5,14],[4,13],[5,12],[6,13],[5,14],[-1,-1],[5,2],[4,1],[5,0],[6,1],[5,2]]},";":{width:10,points:[[5,14],[4,13],[5,12],[6,13],[5,14],[-1,-1],[6,1],[5,0],[4,1],[5,2],[6,1],[6,-1],[5,-3],[4,-4]]},"<":{width:24,points:[[20,18],[4,9],[20,0]]},"=":{width:26,points:[[4,12],[22,12],[-1,-1],[4,6],[22,6]]},">":{width:24,points:[[4,18],[20,9],[4,0]]},"?":{width:18,points:[[3,16],[3,17],[4,19],[5,20],[7,21],[11,21],[13,20],[14,19],[15,17],[15,15],[14,13],[13,12],[9,10],[9,7],[-1,-1],[9,2],[8,1],[9,0],[10,1],[9,2]]},"@":{width:27,points:[[18,13],[17,15],[15,16],[12,16],[10,15],[9,14],[8,11],[8,8],[9,6],[11,5],[14,5],[16,6],[17,8],[-1,-1],[12,16],[10,14],[9,11],[9,8],[10,6],[11,5],[-1,-1],[18,16],[17,8],[17,6],[19,5],[21,5],[23,7],[24,10],[24,12],[23,15],[22,17],[20,19],[18,20],[15,21],[12,21],[9,20],[7,19],[5,17],[4,15],[3,12],[3,9],[4,6],[5,4],[7,2],[9,1],[12,0],[15,0],[18,1],[20,2],[21,3],[-1,-1],[19,16],[18,8],[18,6],[19,5]]},A:{width:18,points:[[9,21],[1,0],[-1,-1],[9,21],[17,0],[-1,-1],[4,7],[14,7]]},B:{width:21,points:[[4,21],[4,0],[-1,-1],[4,21],[13,21],[16,20],[17,19],[18,17],[18,15],[17,13],[16,12],[13,11],[-1,-1],[4,11],[13,11],[16,10],[17,9],[18,7],[18,4],[17,2],[16,1],[13,0],[4,0]]},C:{width:21,points:[[18,16],[17,18],[15,20],[13,21],[9,21],[7,20],[5,18],[4,16],[3,13],[3,8],[4,5],[5,3],[7,1],[9,0],[13,0],[15,1],[17,3],[18,5]]},D:{width:21,points:[[4,21],[4,0],[-1,-1],[4,21],[11,21],[14,20],[16,18],[17,16],[18,13],[18,8],[17,5],[16,3],[14,1],[11,0],[4,0]]},E:{width:19,points:[[4,21],[4,0],[-1,-1],[4,21],[17,21],[-1,-1],[4,11],[12,11],[-1,-1],[4,0],[17,0]]},F:{width:18,points:[[4,21],[4,0],[-1,-1],[4,21],[17,21],[-1,-1],[4,11],[12,11]]},G:{width:21,points:[[18,16],[17,18],[15,20],[13,21],[9,21],[7,20],[5,18],[4,16],[3,13],[3,8],[4,5],[5,3],[7,1],[9,0],[13,0],[15,1],[17,3],[18,5],[18,8],[-1,-1],[13,8],[18,8]]},H:{width:22,points:[[4,21],[4,0],[-1,-1],[18,21],[18,0],[-1,-1],[4,11],[18,11]]},I:{width:8,points:[[4,21],[4,0]]},J:{width:16,points:[[12,21],[12,5],[11,2],[10,1],[8,0],[6,0],[4,1],[3,2],[2,5],[2,7]]},K:{width:21,points:[[4,21],[4,0],[-1,-1],[18,21],[4,7],[-1,-1],[9,12],[18,0]]},L:{width:17,points:[[4,21],[4,0],[-1,-1],[4,0],[16,0]]},M:{width:24,points:[[4,21],[4,0],[-1,-1],[4,21],[12,0],[-1,-1],[20,21],[12,0],[-1,-1],[20,21],[20,0]]},N:{width:22,points:[[4,21],[4,0],[-1,-1],[4,21],[18,0],[-1,-1],[18,21],[18,0]]},O:{width:22,points:[[9,21],[7,20],[5,18],[4,16],[3,13],[3,8],[4,5],[5,3],[7,1],[9,0],[13,0],[15,1],[17,3],[18,5],[19,8],[19,13],[18,16],[17,18],[15,20],[13,21],[9,21]]},P:{width:21,points:[[4,21],[4,0],[-1,-1],[4,21],[13,21],[16,20],[17,19],[18,17],[18,14],[17,12],[16,11],[13,10],[4,10]]},Q:{width:22,points:[[9,21],[7,20],[5,18],[4,16],[3,13],[3,8],[4,5],[5,3],[7,1],[9,0],[13,0],[15,1],[17,3],[18,5],[19,8],[19,13],[18,16],[17,18],[15,20],[13,21],[9,21],[-1,-1],[12,4],[18,-2]]},R:{width:21,points:[[4,21],[4,0],[-1,-1],[4,21],[13,21],[16,20],[17,19],[18,17],[18,15],[17,13],[16,12],[13,11],[4,11],[-1,-1],[11,11],[18,0]]},S:{width:20,points:[[17,18],[15,20],[12,21],[8,21],[5,20],[3,18],[3,16],[4,14],[5,13],[7,12],[13,10],[15,9],[16,8],[17,6],[17,3],[15,1],[12,0],[8,0],[5,1],[3,3]]},T:{width:16,points:[[8,21],[8,0],[-1,-1],[1,21],[15,21]]},U:{width:22,points:[[4,21],[4,6],[5,3],[7,1],[10,0],[12,0],[15,1],[17,3],[18,6],[18,21]]},V:{width:18,points:[[1,21],[9,0],[-1,-1],[17,21],[9,0]]},W:{width:24,points:[[2,21],[7,0],[-1,-1],[12,21],[7,0],[-1,-1],[12,21],[17,0],[-1,-1],[22,21],[17,0]]},X:{width:20,points:[[3,21],[17,0],[-1,-1],[17,21],[3,0]]},Y:{width:18,points:[[1,21],[9,11],[9,0],[-1,-1],[17,21],[9,11]]},Z:{width:20,points:[[17,21],[3,0],[-1,-1],[3,21],[17,21],[-1,-1],[3,0],[17,0]]},"[":{width:14,points:[[4,25],[4,-7],[-1,-1],[5,25],[5,-7],[-1,-1],[4,25],[11,25],[-1,-1],[4,-7],[11,-7]]},"\\":{width:14,points:[[0,21],[14,-3]]},"]":{width:14,points:[[9,25],[9,-7],[-1,-1],[10,25],[10,-7],[-1,-1],[3,25],[10,25],[-1,-1],[3,-7],[10,-7]]},"^":{width:16,points:[[6,15],[8,18],[10,15],[-1,-1],[3,12],[8,17],[13,12],[-1,-1],[8,17],[8,0]]},_:{width:16,points:[[0,-2],[16,-2]]},"`":{width:10,points:[[6,21],[5,20],[4,18],[4,16],[5,15],[6,16],[5,17]]},a:{width:19,points:[[15,14],[15,0],[-1,-1],[15,11],[13,13],[11,14],[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3]]},b:{width:19,points:[[4,21],[4,0],[-1,-1],[4,11],[6,13],[8,14],[11,14],[13,13],[15,11],[16,8],[16,6],[15,3],[13,1],[11,0],[8,0],[6,1],[4,3]]},c:{width:18,points:[[15,11],[13,13],[11,14],[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3]]},d:{width:19,points:[[15,21],[15,0],[-1,-1],[15,11],[13,13],[11,14],[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3]]},e:{width:18,points:[[3,8],[15,8],[15,10],[14,12],[13,13],[11,14],[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3]]},f:{width:12,points:[[10,21],[8,21],[6,20],[5,17],[5,0],[-1,-1],[2,14],[9,14]]},g:{width:19,points:[[15,14],[15,-2],[14,-5],[13,-6],[11,-7],[8,-7],[6,-6],[-1,-1],[15,11],[13,13],[11,14],[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3]]},h:{width:19,points:[[4,21],[4,0],[-1,-1],[4,10],[7,13],[9,14],[12,14],[14,13],[15,10],[15,0]]},i:{width:8,points:[[3,21],[4,20],[5,21],[4,22],[3,21],[-1,-1],[4,14],[4,0]]},j:{width:10,points:[[5,21],[6,20],[7,21],[6,22],[5,21],[-1,-1],[6,14],[6,-3],[5,-6],[3,-7],[1,-7]]},k:{width:17,points:[[4,21],[4,0],[-1,-1],[14,14],[4,4],[-1,-1],[8,8],[15,0]]},l:{width:8,points:[[4,21],[4,0]]},m:{width:30,points:[[4,14],[4,0],[-1,-1],[4,10],[7,13],[9,14],[12,14],[14,13],[15,10],[15,0],[-1,-1],[15,10],[18,13],[20,14],[23,14],[25,13],[26,10],[26,0]]},n:{width:19,points:[[4,14],[4,0],[-1,-1],[4,10],[7,13],[9,14],[12,14],[14,13],[15,10],[15,0]]},o:{width:19,points:[[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3],[16,6],[16,8],[15,11],[13,13],[11,14],[8,14]]},p:{width:19,points:[[4,14],[4,-7],[-1,-1],[4,11],[6,13],[8,14],[11,14],[13,13],[15,11],[16,8],[16,6],[15,3],[13,1],[11,0],[8,0],[6,1],[4,3]]},q:{width:19,points:[[15,14],[15,-7],[-1,-1],[15,11],[13,13],[11,14],[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3]]},r:{width:13,points:[[4,14],[4,0],[-1,-1],[4,8],[5,11],[7,13],[9,14],[12,14]]},s:{width:17,points:[[14,11],[13,13],[10,14],[7,14],[4,13],[3,11],[4,9],[6,8],[11,7],[13,6],[14,4],[14,3],[13,1],[10,0],[7,0],[4,1],[3,3]]},t:{width:12,points:[[5,21],[5,4],[6,1],[8,0],[10,0],[-1,-1],[2,14],[9,14]]},u:{width:19,points:[[4,14],[4,4],[5,1],[7,0],[10,0],[12,1],[15,4],[-1,-1],[15,14],[15,0]]},v:{width:16,points:[[2,14],[8,0],[-1,-1],[14,14],[8,0]]},w:{width:22,points:[[3,14],[7,0],[-1,-1],[11,14],[7,0],[-1,-1],[11,14],[15,0],[-1,-1],[19,14],[15,0]]},x:{width:17,points:[[3,14],[14,0],[-1,-1],[14,14],[3,0]]},y:{width:16,points:[[2,14],[8,0],[-1,-1],[14,14],[8,0],[6,-4],[4,-6],[2,-7],[1,-7]]},z:{width:17,points:[[14,14],[3,0],[-1,-1],[3,14],[14,14],[-1,-1],[3,0],[14,0]]},"{":{width:14,points:[[9,25],[7,24],[6,23],[5,21],[5,19],[6,17],[7,16],[8,14],[8,12],[6,10],[-1,-1],[7,24],[6,22],[6,20],[7,18],[8,17],[9,15],[9,13],[8,11],[4,9],[8,7],[9,5],[9,3],[8,1],[7,0],[6,-2],[6,-4],[7,-6],[-1,-1],[6,8],[8,6],[8,4],[7,2],[6,1],[5,-1],[5,-3],[6,-5],[7,-6],[9,-7]]},"|":{width:8,points:[[4,25],[4,-7]]},"}":{width:14,points:[[5,25],[7,24],[8,23],[9,21],[9,19],[8,17],[7,16],[6,14],[6,12],[8,10],[-1,-1],[7,24],[8,22],[8,20],[7,18],[6,17],[5,15],[5,13],[6,11],[10,9],[6,7],[5,5],[5,3],[6,1],[7,0],[8,-2],[8,-4],[7,-6],[-1,-1],[8,8],[6,6],[6,4],[7,2],[8,1],[9,-1],[9,-3],[8,-5],[7,-6],[5,-7]]},"~":{width:24,points:[[3,6],[3,8],[4,11],[6,12],[8,12],[10,11],[14,8],[16,7],[18,7],[20,8],[21,10],[-1,-1],[3,8],[4,10],[6,11],[8,11],[10,10],[14,7],[16,6],[18,6],[20,7],[21,10],[21,12]]}};function buildVectorTextGeometry(t={}){for(var e,n,r,i,a,o,s,l,h,c=t.origin||[0,0,0],d=c[0],u=c[1],f=c[2],m=t.size||1,p=[],_=[],g=((""+t.text).trim()||"").split("\n"),y=0,w=0,b=0;b<g.length;b++){e=0,r=(n=g[b]).length;for(var v=0;v<r;v++)if(i=letters[n.charAt(v)]){a=1,o=-1,s=-1,l=i.points.length;for(var M=0;M<l;M++)-1!==(h=i.points[M])[0]||-1!==h[1]?(p.push(e+h[0]*m*.04+d),p.push(w+h[1]*m*.04+u),p.push(0+f),-1===o?o=y:-1===s?s=y:(o=s,s=y),y++,a?a=!1:(_.push(o),_.push(s))):a=1;e+=.04*i.width*m}w-=35*.04*m}return{primitiveType:"lines",positions:p,indices:_}}export{XKTModel,buildBoxGeometry,buildBoxLinesGeometry,buildCylinderGeometry,buildGridGeometry,buildPlaneGeometry,buildSphereGeometry,buildTorusGeometry,buildVectorTextGeometry,parseGLTFIntoXKTModel,validateXKTArrayBuffer,writeXKTModelToArrayBuffer};
